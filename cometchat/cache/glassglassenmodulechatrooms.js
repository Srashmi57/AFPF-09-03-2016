
if(typeof(jqcc)==='undefined'){jqcc=jQuery;}
jqcc.cookie=function(a,b,c){if(typeof b!='undefined'){c=c||{};if(b===null){b='';c.expires=-1}var d='';if(c.expires&&(typeof c.expires=='number'||c.expires.toUTCString)){var e;if(typeof c.expires=='number'){e=new Date();e.setTime(e.getTime()+(c.expires*24*60*60*1000))}else{e=c.expires}d='; expires='+e.toUTCString()}var f=c.path?'; path='+(c.path):'';var g=c.domain?'; domain='+(c.domain):'';var h=c.secure?'; secure':'';document.cookie=[a,'=',encodeURIComponent(b),d,f,g,h].join('')}else{var j=null;if(document.cookie&&document.cookie!=''){var k=document.cookie.split(';');for(var i=0;i<k.length;i++){var l=jqcc.trim(k[i]);if(l.substring(0,a.length+1)==(a+'=')){j=decodeURIComponent(l.substring(a.length+1));break}}}return j}};if(typeof deconcept=="undefined"){var deconcept=new Object();}if(typeof deconcept.util=="undefined"){deconcept.util=new Object();}if(typeof deconcept.SWFObjectCCUtil=="undefined"){deconcept.SWFObjectCCUtil=new Object();}deconcept.SWFObjectCC=function(_1,id,w,h,_5,c,_7,_8,_9,_a){if(!document.getElementById){return;}this.DETECT_KEY=_a?_a:"detectflash";this.skipDetect=deconcept.util.getRequestParameter(this.DETECT_KEY);this.params=new Object();this.variables=new Object();this.attributes=new Array();if(_1){this.setAttribute("swf",_1);}if(id){this.setAttribute("id",id);}if(w){this.setAttribute("width",w);}if(h){this.setAttribute("height",h);}if(_5){this.setAttribute("version",new deconcept.PlayerVersion(_5.toString().split(".")));}this.installedVer=deconcept.SWFObjectCCUtil.getPlayerVersion();if(!window.opera&&document.all&&this.installedVer.major>7){deconcept.SWFObjectCC.doPrepUnload=true;}if(c){this.addParam("bgcolor",c);}var q=_7?_7:"high";this.addParam("quality",q);this.setAttribute("useExpressInstall",false);this.setAttribute("doExpressInstall",false);var _c=(_8)?_8:window.location;this.setAttribute("xiRedirectUrl",_c);this.setAttribute("redirectUrl","");if(_9){this.setAttribute("redirectUrl",_9);}};deconcept.SWFObjectCC.prototype={useExpressInstall:function(_d){this.xiSWFPath=!_d?"expressinstall.swf":_d;this.setAttribute("useExpressInstall",true);},setAttribute:function(_e,_f){this.attributes[_e]=_f;},getAttribute:function(_10){return this.attributes[_10];},addParam:function(_11,_12){this.params[_11]=_12;},getParams:function(){return this.params;},addVariable:function(_13,_14){this.variables[_13]=_14;},getVariable:function(_15){return this.variables[_15];},getVariables:function(){return this.variables;},getVariablePairs:function(){var _16=new Array();var key;var _18=this.getVariables();for(key in _18){_16[_16.length]=key+"="+_18[key];}return _16;},getSWFHTML:function(){var _19="";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","PlugIn");this.setAttribute("swf",this.xiSWFPath);}_19="<embed type=\"application/x-shockwave-flash\" src=\""+this.getAttribute("swf")+"\" width=\""+this.getAttribute("width")+"\" height=\""+this.getAttribute("height")+"\" style=\""+this.getAttribute("style")+"\"";_19+=" id=\""+this.getAttribute("id")+"\" name=\""+this.getAttribute("id")+"\" ";var _1a=this.getParams();for(var key in _1a){_19+=[key]+"=\""+_1a[key]+"\" ";}var _1c=this.getVariablePairs().join("&");if(_1c.length>0){_19+="flashvars=\""+_1c+"\"";}_19+="/>";}else{if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","ActiveX");this.setAttribute("swf",this.xiSWFPath);}_19="<object id=\""+this.getAttribute("id")+"\" classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" width=\""+this.getAttribute("width")+"\" height=\""+this.getAttribute("height")+"\" style=\""+this.getAttribute("style")+"\">";_19+="<param name=\"movie\" value=\""+this.getAttribute("swf")+"\" />";var _1d=this.getParams();for(var key in _1d){_19+="<param name=\""+key+"\" value=\""+_1d[key]+"\" />";}var _1f=this.getVariablePairs().join("&");if(_1f.length>0){_19+="<param name=\"flashvars\" value=\""+_1f+"\" />";}_19+="</object>";}return _19;},write:function(_20){if(this.getAttribute("useExpressInstall")){var _21=new deconcept.PlayerVersion([6,0,65]);if(this.installedVer.versionIsValid(_21)&&!this.installedVer.versionIsValid(this.getAttribute("version"))){this.setAttribute("doExpressInstall",true);this.addVariable("MMredirectURL",escape(this.getAttribute("xiRedirectUrl")));document.title=document.title.slice(0,47)+" - Flash Player Installation";this.addVariable("MMdoctitle",document.title);}}if(this.skipDetect||this.getAttribute("doExpressInstall")||this.installedVer.versionIsValid(this.getAttribute("version"))){var n=(typeof _20=="string")?document.getElementById(_20):_20;n.innerHTML=this.getSWFHTML();return true;}else{if(this.getAttribute("redirectUrl")!=""){document.location.replace(this.getAttribute("redirectUrl"));}}return false;}};deconcept.SWFObjectCCUtil.getPlayerVersion=function(){var _23=new deconcept.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var x=navigator.plugins["Shockwave Flash"];if(x&&x.description){_23=new deconcept.PlayerVersion(x.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."));}}else{if(navigator.userAgent&&navigator.userAgent.indexOf("Windows CE")>=0){var axo=1;var _26=3;while(axo){try{_26++;axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+_26);_23=new deconcept.PlayerVersion([_26,0,0]);}catch(e){axo=null;}}}else{try{var axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");}catch(e){try{var axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");_23=new deconcept.PlayerVersion([6,0,21]);axo.AllowScriptAccess="always";}catch(e){if(_23.major==6){return _23;}}try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");}catch(e){}}if(axo!=null){_23=new deconcept.PlayerVersion(axo.GetVariable("$version").split(" ")[1].split(","));}}}return _23;};deconcept.PlayerVersion=function(_29){this.major=_29[0]!=null?parseInt(_29[0]):0;this.minor=_29[1]!=null?parseInt(_29[1]):0;this.rev=_29[2]!=null?parseInt(_29[2]):0;};deconcept.PlayerVersion.prototype.versionIsValid=function(fv){if(this.major<fv.major){return false;}if(this.major>fv.major){return true;}if(this.minor<fv.minor){return false;}if(this.minor>fv.minor){return true;}if(this.rev<fv.rev){return false;}return true;};deconcept.util={getRequestParameter:function(_2b){var q=document.location.search||document.location.hash;if(_2b==null){return q;}if(q){var _2d=q.substring(1).split("&");for(var i=0;i<_2d.length;i++){if(_2d[i].substring(0,_2d[i].indexOf("="))==_2b){return _2d[i].substring((_2d[i].indexOf("=")+1));}}}return"";}};deconcept.SWFObjectCCUtil.cleanupSWFs=function(){var _2f=document.getElementsByTagName("OBJECT");for(var i=_2f.length-1;i>=0;i--){_2f[i].style.display="none";for(var x in _2f[i]){if(typeof _2f[i][x]=="function"){_2f[i][x]=function(){};}}}};if(deconcept.SWFObjectCC.doPrepUnload){if(!deconcept.unloadSet){deconcept.SWFObjectCCUtil.prepUnload=function(){__flash_unloadHandler=function(){};__flash_savedUnloadHandler=function(){};window.attachEvent("onunload",deconcept.SWFObjectCCUtil.cleanupSWFs);};window.attachEvent("onbeforeunload",deconcept.SWFObjectCCUtil.prepUnload);deconcept.unloadSet=true;}}if(!document.getElementById&&document.all){document.getElementById=function(id){return document.all[id];};}var getQueryParamValue=deconcept.util.getRequestParameter;var FlashObject=deconcept.SWFObjectCC;var SWFObjectCC=deconcept.SWFObjectCC;(function($){var h=$.scrollToCC=function(a,b,c){$(window).scrollToCC(a,b,c)};h.defaults={axis:'xy',duration:parseFloat($.fn.jqcc)>=1.3?0:1};h.window=function(a){return $(window)._scrollable()};$.fn._scrollable=function(){return this.map(function(){var a=this,isWin=!a.nodeName||$.inArray(a.nodeName.toLowerCase(),['iframe','#document','html','body'])!=-1;if(!isWin)return a;var b=(a.contentWindow||a).document||a.ownerDocument||a;return $.browser.safari||b.compatMode=='BackCompat'?b.body:b.documentElement})};$.fn.scrollToCC=function(e,f,g){if(typeof f=='object'){g=f;f=0}if(typeof g=='function')g={onAfter:g};if(e=='max')e=9e9;g=$.extend({},h.defaults,g);f=f||g.speed||g.duration;g.queue=g.queue&&g.axis.length>1;if(g.queue)f/=2;g.offset=both(g.offset);g.over=both(g.over);return this._scrollable().each(function(){var d=this,$elem=$(d),targ=e,toff,attr={},win=$elem.is('html,body');switch(typeof targ){case'number':case'string':if((/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(targ))||(targ.charAt(0)=='-'&&targ.charAt(1)!='=')){targ=both(targ);break}targ=$(targ,this);case'object':if(targ.is||targ.style)toff=(targ=$(targ)).offset()}$.each(g.axis.split(''),function(i,a){var b=a=='x'?'Left':'Top',pos=b.toLowerCase(),key='scroll'+b,old=d[key],max=h.max(d,a);if(toff){attr[key]=toff[pos]+(win?0:old-$elem.offset()[pos]);if(g.margin){attr[key]-=parseInt(targ.css('margin'+b))||0;attr[key]-=parseInt(targ.css('border'+b+'Width'))||0}attr[key]+=g.offset[pos]||0;if(g.over[pos])attr[key]+=targ[a=='x'?'width':'height']()*g.over[pos]}else{var c=targ[pos];attr[key]=c.slice&&c.slice(-1)=='%'?parseFloat(c)/100*max:c}if(/^\d+$/.test(attr[key]))attr[key]=attr[key]<=0?0:Math.min(attr[key],max);if(!i&&g.queue){if(old!=attr[key])animate(g.onAfterFirst);delete attr[key]}});animate(g.onAfter);function animate(a){$elem.animate(attr,f,g.easing,a&&function(){a.call(this,e,g)})}}).end()};h.max=function(a,b){var c=b=='x'?'Width':'Height',scroll='scroll'+c;if(!$(a).is('html,body'))return a[scroll]-$(a)[c.toLowerCase()]();var d='client'+c,html=a.ownerDocument.documentElement,body=a.ownerDocument.body;return Math.max(html[scroll],body[scroll])-Math.min(html[d],body[d])};function both(a){return typeof a=='object'?a:{top:a,left:a}}})(jqcc);function d(b){var c,a;if(!this.length)return this;c=this[0];c.ownerDocument?a=c.ownerDocument:(a=c,c=a.documentElement);if(null==b){if(!a.cancelFullScreen&&!a.webkitCancelFullScreen&&!a.mozCancelFullScreen)return null;b=!!a.fullScreen||!!a.webkitIsFullScreen||!!a.mozFullScreen;return!b?b:a.fullScreenElement||a.webkitCurrentFullScreenElement||a.mozFullScreenElement||b}b?(b=c.requestFullScreen||c.webkitRequestFullScreen||c.mozRequestFullScreen)&&(Element.ALLOW_KEYBOARD_INPUT?b.call(c,Element.ALLOW_KEYBOARD_INPUT):b.call(c)):(b=a.cancelFullScreen||a.webkitCancelFullScreen||a.mozCancelFullScreen)&&b.call(a);return this}jqcc.fn.fullScreen=d;jqcc.fn.toggleFullScreen=function(){return d.call(this,!d.call(this))};var e,f,g;e=document;e.webkitCancelFullScreen?(f="webkitfullscreenchange",g="webkitfullscreenerror"):e.mozCancelFullScreen?(f="mozfullscreenchange",g="mozfullscreenerror"):(f="fullscreenchange",g="fullscreenerror");jqcc(document).bind(f,function(){jqcc(document).trigger(new jqcc.Event("fullscreenchange"))});jqcc(document).bind(g,function(){jqcc(document).trigger(new jqcc.Event("fullscreenerror"))});jqcc.expr[':'].icontains=function(a,i,m){return(a.textContent||a.innerText||"").toLowerCase().indexOf(m[3].toLowerCase())>=0;};var cc_zindex=0;if(typeof closeCCPopup==="undefined"){var type="module";var name="chatrooms";var eventMethod=window.addEventListener?"addEventListener":"attachEvent";var eventer=window[eventMethod];var messageEvent=eventMethod=="attachEvent"?"onmessage":"message";switch(type){case"extension":eventer(messageEvent,function(e){if(typeof(e.data)!='undefined'&&typeof(e.data)=='string'){if(e.data.indexOf('CC^CONTROL_')!==-1){var controlparameters=e.data.slice(11);controlparameters=JSON.parse(controlparameters);if(controlparameters.type=='extensions'&&controlparameters.method=='checkResponse'){var controlparameters={"type":"extensions","name":"mobilewebapp","method":"clearTimeout","params":{"timeOut":controlparameters.params.timeOut}};controlparameters=JSON.stringify(controlparameters);e.source.postMessage('CC^CONTROL_'+controlparameters,'*');}}else if(e.data.indexOf('ccmobilewebapp_reinitializeauth')!==-1){jqcc.mobilewebapp.reinitialize();}}},false);break;case"module":switch(name){case"chatrooms":eventer(messageEvent,function(e){if(typeof(e.data)!='undefined'&&typeof(e.data)=='string'){if(e.data.indexOf('CC^CONTROL_')!==-1){var controlparameters=e.data.split('CC^CONTROL_')[1];controlparameters=JSON.parse(controlparameters);if(controlparameters.name=='cometchat'&&controlparameters.method=='processcontrolmessage'){var message=jqcc[controlparameters.name][controlparameters.method](controlparameters.item);var returnparameters={"message":message,"item":controlparameters.item,"processcontrolmessageResponse":1};e.source.postMessage(returnparameters,'*');}else if(controlparameters.name=="cometchat"&&controlparameters.method=="setInternalVariable"){var controlparameters={"type":"plugins","name":"cometchat","method":"setInternalVariable","params":{"type":controlparameters.params.type,"grp":controlparameters.params.grp,"value":controlparameters.params.value}};controlparameters=JSON.stringify(controlparameters);if(typeof(parent)!='undefined'){parent.postMessage('CC^CONTROL_'+controlparameters,'*');}else{window.opener.postMessage('CC^CONTROL_'+controlparameters,'*');}}else if(controlparameters.name=="cometchat"&&controlparameters.method=="chatWith"){var controlparameters={"type":"modules","name":"cometchat","method":"chatWith","params":{"uid":controlparameters.params.uid,"chatroommode":"0"}};controlparameters=JSON.stringify(controlparameters);window.opener.postMessage('CC^CONTROL_'+controlparameters,'*');}else if(controlparameters.name=="cometchat"&&(controlparameters.method=="kickChatroomUser"||controlparameters.method=="banChatroomUser")){jqcc[controlparameters.name][controlparameters.method](controlparameters.params.uid,0);}else if(controlparameters.method=="checkChatroomPass"){jqcc[controlparameters.name][controlparameters.method](controlparameters.params.id,controlparameters.params.name,controlparameters.params.silent,controlparameters.params.password);}else if(controlparameters.method=="closeCCPopup"){closeCCPopup(controlparameters.params.name);}else if(controlparameters.method=="checkCometChat"){jqcc.cometchat.setChatroomVars('checkBarEnabled',controlparameters.params.enabled);}else if(controlparameters.type=="module"&&controlparameters.name=="chatrooms"&&controlparameters.method=="resizeCCPopup"){window[controlparameters.method](controlparameters.params.id,controlparameters.params.height,controlparameters.params.width);}else if(controlparameters.type=="themes"&&controlparameters.method=="loggedout"){jqcc.cometchat.chatroomHeartbeat();}else if(controlparameters.name=="core"){loadCCPopup(controlparameters.params.url,controlparameters.params.name,controlparameters.params.properties,controlparameters.params.width,controlparameters.params.height,controlparameters.params.title,controlparameters.params.force,controlparameters.params.allowmaximize,controlparameters.params.allowresize,controlparameters.params.allowpopout,controlparameters.params.windowMode);}else{jqcc[controlparameters.name][controlparameters.method](controlparameters.params);}}}},false);break;}
break;case"plugin":switch(name){case"chathistory":eventer(messageEvent,function(e){if(typeof(e.data)!='undefined'&&e.data.processcontrolmessageResponse==1){jqcc("#"+e.data.item.id).find('.chatmessage.chatmessage_short').html(e.data.message);jqcc("#"+e.data.item.id).find('.chatmessage.chatnowrap').html(e.data.message);}},false);break;}
break;default:eventer(messageEvent,function(e){if(typeof(e.data)!='undefined'&&typeof(e.data)=='string'){if(e.data.indexOf('ccmobile_reinitializeauth')!==-1){jqcc.ccmobiletab.reinitialize();}else if(e.data.indexOf('cc_reinitializeauth')!==-1){if(typeof(jqcc.cometchat.ping)!='undefined'){jqcc.cometchat.reinitialize();jqcc('#cometchat_userstab').click();jqcc('#cometchat_auth_popup').removeClass('cometchat_tabopen');jqcc('#cometchat_optionsbutton').removeClass('cometchat_tabclick');if(jqcc('#cometchat_trayicon_chatrooms_iframe').length>0){jqcc('#cometchat_trayicon_chatrooms_iframe').attr('src',jqcc('#cometchat_trayicon_chatrooms_iframe').attr('src'));}}
if(jqcc('#cometchat_chatrooms_iframe').length>0){jqcc('#cometchat_chatrooms_iframe').attr('src',jqcc('#cometchat_chatrooms_iframe').attr('src'));}}else if(e.data.indexOf('alert')!==-1&&e.data.indexOf('CC^CONTROL_')===-1){if(typeof(e.data.split('^')[1])!='undefined'){alert(e.data.split('^')[1]);}}else if(e.data.indexOf('webrtcNoti')!==-1){if(typeof(e.data.split('^')[1])!='undefined'&&e.data.split('^')[1]=='add'){jqcc(document).find('body').prepend('<div id="webrtcArrow" onclick="this.remove();" style="position:fixed;width:100%;height: 100%;margin: 0px;top: 0;left: 0;background: rgba(0,0,0,0.6);z-index: 90000000;text-align: center;"></div>');}
if(typeof(e.data.split('^')[1])!='undefined'&&e.data.split('^')[1]=='remove'){jqcc(document).find("#webrtcArrow").remove();}}else if(e.data.indexOf('CC^CONTROL_')!==-1){var controlparameters=e.data.slice(11);controlparameters=JSON.parse(controlparameters);if(controlparameters.type=="extensions"&&controlparameters.name=="jabber"&&controlparameters.method=="login_gtalk"){if(jqcc('#cometchat_synergy_iframe').length>0){jqcc('#cometchat_synergy_iframe').attr('src',jqcc('#cometchat_synergy_iframe').attr('src'));}}else if(controlparameters.type=="extensions"&&controlparameters.name=="desktop"&&controlparameters.method=="login"){if(typeof(localStorage)!="undefined"){localStorage.dm_id=controlparameters.params.dm_id;}}else if(controlparameters.type=="extensions"&&controlparameters.name=="desktop"&&controlparameters.method=="guest_login"){if(typeof(localStorage)!="undefined"){localStorage.guest_id=controlparameters.params.guest_id;}}
else if(controlparameters.type=="extensions"&&controlparameters.name=="desktop"&&controlparameters.method=="forgot_pass"){gui.Shell.openExternal(controlparameters.params.forgot_url);}
else if(controlparameters.type=="extensions"&&controlparameters.name=="desktop"&&controlparameters.method=="signup"){gui.Shell.openExternal(controlparameters.params.signup_url);}else if(controlparameters.type=="extensions"&&controlparameters.name=="desktop"&&controlparameters.method=="notification"){window.LOCAL_NW.desktopNotifications.notify(controlparameters.params.icon,controlparameters.params.uname,controlparameters.params.message,function(){jqcc('#status').text('Clicked on '+title);jqcc('#status').fadeIn('fast',function(){setTimeout(function(){jqcc('#status').fadeOut('fast');},1800);});});}else if(controlparameters.type=="extensions"&&controlparameters.name=="desktop"&&controlparameters.method=="logout"){localStorage.dm_id=0;localStorage.guest_id=0;}else if(controlparameters.type=="extensions"&&controlparameters.name=="mobilewebapp"&&controlparameters.method=="clearTimeout"){clearTimeout(controlparameters.params.timeOut);mobiletabwindow.focus();}else if(controlparameters.type=="module"&&controlparameters.name=="chatrooms"&&controlparameters.method=="resizeCCPopup"){window[controlparameters.method](controlparameters.params.id,controlparameters.params.height,controlparameters.params.width);}else if(controlparameters.method=="closeCCPopup"){closeCCPopup(controlparameters.params.name);}else if(controlparameters.type=="plugins"&&controlparameters.name=="cometchat"&&controlparameters.method=="processcontrolmessage"){var message=jqcc[controlparameters.name][controlparameters.method](controlparameters.item);var returnparameters={"message":message,"item":controlparameters.item,"processcontrolmessageResponse":1};e.source.postMessage(returnparameters,'*');}else if(controlparameters.type=="plugins"&&controlparameters.name=="cometchat"&&controlparameters.method=="setInternalVariable"){if(typeof(jqcc.cometchat)!='undefined')
jqcc[controlparameters.name][controlparameters.method](controlparameters.params.type+'_'+controlparameters.params.grp,controlparameters.params.value);}else if(controlparameters.type=="modules"&&controlparameters.name=="cometchat"&&controlparameters.method=="addMessage"){if(controlparameters.params.caller==""||typeof(controlparameters.params.caller)=="undefined"){jqcc[controlparameters.name][controlparameters.method](controlparameters.params.from,controlparameters.params.message,controlparameters.params.messageId,controlparameters.params.nopopup);}else{var returnparameters={"type":"modules","name":"cometchat","method":"addMessage","params":{"from":parseInt(controlparameters.params.from),"message":controlparameters.params.message,"messageId":controlparameters.params.messageId,"nopopup":controlparameters.params.nopopup}};returnparameters=JSON.stringify(returnparameters);jqcc("#"+controlparameters.params.caller)[0].contentWindow.postMessage('CC^CONTROL_'+returnparameters,'*');}}else if(controlparameters.type=="modules"&&controlparameters.name=="share"){if(controlparameters.method=="setTitle"){var parenttitle=document.title;var parenturl=document.location.href;var addthis_share={url:parenturl,title:parenttitle,templates:{twitter:'{{title}}: {{url}}'}}}else if(controlparameters.method=="getParentURL"){var theUrl=window.location.href;var title=document.title;var returnparameters={"theUrl":theUrl,"title":title};returnparameters=JSON.stringify(returnparameters);e.source.postMessage('CC^CONTROL_'+returnparameters,'*');}}else if(controlparameters.type=="modules"&&controlparameters.method=="closeModule"){if(controlparameters.name=="themechanger"){location.reload();}else if(controlparameters.name=="translate2"){jqcc('#MSTTExitLink').click();}
jqcc.cometchat.closeModule(controlparameters.name);}else if(controlparameters.type=="modules"&&controlparameters.name=="translatepage"){if(typeof(controlparameters.params.lang)=='undefined'){window[controlparameters.method]();}else{window[controlparameters.method](controlparameters.params.lang);}}else if(controlparameters.method=="checkChatroomPass"){if(typeof(jqcc[controlparameters.name][controlparameters.method])=='undefined'){var returnparameters={"type":controlparameters.type,"name":controlparameters.name,"method":controlparameters.method,"params":controlparameters.params};returnparameters=JSON.stringify(returnparameters);jqcc('#cometchat_trayicon_chatrooms_iframe,.cometchat_embed_chatrooms,.cometchat_synergy_iframe')[0].contentWindow.postMessage('CC^CONTROL_'+returnparameters,'*');}else{jqcc[controlparameters.name][controlparameters.method](controlparameters.params.id,controlparameters.params.name,controlparameters.params.silent,controlparameters.params.password,controlparameters.params.clicked);}}else if(controlparameters.name=="core"){loadCCPopup(controlparameters.params.url,controlparameters.params.name,controlparameters.params.properties,controlparameters.params.width,controlparameters.params.height,controlparameters.params.title,controlparameters.params.force,controlparameters.params.allowmaximize,controlparameters.params.allowresize,controlparameters.params.allowpopout,controlparameters.params.windowMode);}else if(controlparameters.type=="modules"&&controlparameters.name=="cometchat"&&controlparameters.method=="lightbox"){if(typeof(controlparameters.params.caller)=="undefined"){jqcc[controlparameters.name][controlparameters.method](controlparameters.params.moduleName);}else{jqcc[controlparameters.name][controlparameters.method](controlparameters.params.moduleName,controlparameters.params.caller);}}else if(controlparameters.type=="modules"&&controlparameters.name=="cometchat"&&typeof(controlparameters.params.allowed)=='undefined'){if(controlparameters.method=="sendMessage"){jqcc[controlparameters.name][controlparameters.method](controlparameters.params.uid,controlparameters.params.message);}else if(controlparameters.method=="launchModule"||controlparameters.method=="minimizeAll"){jqcc[controlparameters.name][controlparameters.method](controlparameters.params.uid);}else if(controlparameters.method=="startGuestChat"){jqcc[controlparameters.name][controlparameters.method](controlparameters.params.name);}else if(controlparameters.method=="chatWith"){if(typeof(jqcc.cometchat)=='undefined'){var returnparameters={"type":"modules","name":"cometchat","method":"checkCometChat","params":{"enabled":"0"}};returnparameters=JSON.stringify(returnparameters);e.source.postMessage('CC^CONTROL_'+returnparameters,'*');}else if(typeof(controlparameters.params.caller)!="undefined"&&controlparameters.params.caller!=''){var returnparameters={"type":"modules","name":"cometchat","method":"chatWith","params":{"uid":controlparameters.params.uid,"chatroommode":"0","caller":""}};returnparameters=JSON.stringify(returnparameters);jqcc('#cometchat_synergy_iframe')[0].contentWindow.postMessage('CC^CONTROL_'+returnparameters,'*');}else{if(typeof(controlparameters.params.synergy)=='undefined'&&typeof(controlparameters.params.caller)=='undefined'){var returnparameters={"type":"modules","name":"cometchat","method":"checkCometChat","params":{"enabled":"1"}};returnparameters=JSON.stringify(returnparameters);e.source.postMessage('CC^CONTROL_'+returnparameters,'*');}
if(typeof(jqcc[controlparameters.name][controlparameters.method])!="undefined")
jqcc[controlparameters.name][controlparameters.method](controlparameters.params.uid);}}else{if(typeof(jqcc.cometchat)=='undefined'||typeof(controlparameters.params.windowMode)!="undefined"){if(typeof(controlparameters.params.synergy)!="undefined"){var returnparameters={"type":"modules","name":"cometchat","method":"unbanChatroomUser","params":{"url":controlparameters.params.url,"action":controlparameters.params.action,"lang":controlparameters.params.lang,"windowMode":1}};returnparameters=JSON.stringify(returnparameters);jqcc('#cometchat_synergy_iframe, #cometchat_chatrooms_iframe')[0].contentWindow.postMessage('CC^CONTROL_'+returnparameters,'*');}else{loadCCPopup(controlparameters.params.url,controlparameters.params.action,"status=0,toolbar=0,menubar=0,directories=0,resizable=0,location=0,status=0,scrollbars=1, width=400,height=200",400,200,controlparameters.params.lang,null,null,null,null,1);}}else{loadCCPopup(controlparameters.params.url,controlparameters.params.action,"status=0,toolbar=0,menubar=0,directories=0,resizable=0,location=0,status=0,scrollbars=1, width=400,height=200",400,200,controlparameters.params.lang);}}}else if(controlparameters.type=="functions"&&controlparameters.name=="socialauth"){if(jqcc('#cometchat_optionsbutton').length==1){jqcc('#cometchat_optionsbutton').click();}else if(jqcc('.cometchat_optionsimages_ccauth').length==1){jqcc('.cometchat_optionsimages_ccauth').click();}else{loadCCPopup(controlparameters.params.url,controlparameters.name,"status=0,toolbar=0,menubar=0,directories=0,resizable=0,location=0,status=0,scrollbars=0, width=420,height=250",300,200,'Login Options',null,null,null,null,1);}}else if(controlparameters.name=="cometchat"&&(controlparameters.method=="kickChatroomUser"||controlparameters.method=="banChatroomUser")){if(typeof(jqcc[controlparameters.name][controlparameters.method])=="undefined"){var returnparameters={"type":controlparameters.type,"name":controlparameters.name,"method":controlparameters.method,"params":controlparameters.params};returnparameters=JSON.stringify(returnparameters);jqcc('#cometchat_chatrooms_iframe, #cometchat_trayicon_chatrooms_iframe, #cometchat_synergy_iframe')[0].contentWindow.postMessage('CC^CONTROL_'+returnparameters,'*');}else{jqcc[controlparameters.name][controlparameters.method](controlparameters.params.uid,1);}}else if(controlparameters.type=="themes"&&controlparameters.method=="loggedout"){if(typeof(jqcc.cometchat)!='undefined'){jqcc[jqcc.cometchat.getSettings().theme].loggedOut();jqcc.cometchat.setThemeVariable('loggedout',1);clearTimeout(jqcc.cometchat.getCcvariable().heartbeatTimer);}else{var returnparameters={"type":controlparameters.type,"name":controlparameters.name,"method":controlparameters.method,"params":controlparameters.params};returnparameters=JSON.stringify(returnparameters);e.source.postMessage('CC^CONTROL_'+returnparameters,'*');}}else{if(controlparameters.params.chatroommode==1&&controlparameters.method!="init"&&typeof(jqcc.cometchat)!='undefined'&&jqcc.cometchat.getSettings().theme!='synergy'){if(controlparameters.method=="addtext"&&typeof(controlparameters.params.caller)!="undefined"&&controlparameters.params.caller!=""){var returnparameters={"type":controlparameters.type,"name":controlparameters.name,"method":controlparameters.method,"params":controlparameters.params};var caller=returnparameters.params.caller;delete returnparameters.params.caller;returnparameters=JSON.stringify(returnparameters);jqcc('#'+caller+', #cometchat_chatrooms_iframe')[0].contentWindow.postMessage('CC^CONTROL_'+returnparameters,'*');}else if(typeof(jqcc('#cometchat_trayicon_chatrooms_iframe, #cometchat_chatrooms_iframe, #cometchat_synergy_iframe')[0].contentWindow)!='undefined'){jqcc('#cometchat_trayicon_chatrooms_iframe, #cometchat_chatrooms_iframe, #cometchat_synergy_iframe')[0].contentWindow.postMessage(e.data,'*');}}else{if(typeof(jqcc[controlparameters.name])=='undefined'){if(controlparameters.name!='mobilewebapp'){var returnparameters={"type":"plugins","name":controlparameters.name,"method":controlparameters.method,"params":controlparameters.params};returnparameters.params.windowMode="1";returnparameters=JSON.stringify(returnparameters);e.source.postMessage('CC^CONTROL_'+returnparameters,'*');}}else{if((controlparameters.method=="addtext"||controlparameters.method=="appendMessage"||controlparameters.method=="appendStickerMessage")&&typeof(controlparameters.params.caller)!="undefined"&&controlparameters.params.caller!=""){var returnparameters={"type":controlparameters.type,"name":controlparameters.name,"method":controlparameters.method,"params":controlparameters.params};var caller=returnparameters.params.caller;delete returnparameters.params.caller;returnparameters=JSON.stringify(returnparameters);if(typeof(jqcc('#'+caller)[0])=='undefined'){jqcc[controlparameters.name][controlparameters.method](controlparameters.params);}else{jqcc('#'+caller)[0].contentWindow.postMessage('CC^CONTROL_'+returnparameters,'*');}}else{if(window.top!=window.self){controlparameters.params.windowMode="1";}
jqcc[controlparameters.name][controlparameters.method](controlparameters.params);}}}}}}},false);break;}}
var cc_dragobj=new Object();function loadCCPopup(url,name,properties,width,height,title,force,allowmaximize,allowresize,allowpopout,windowmode){if(typeof(windowmode)!="undefined"&&windowmode==1){var queryStringSeparator='&';if(url.indexOf('?')<0){queryStringSeparator='?';}
if(url.indexOf('basedata')<=0){var basedata='';if(typeof(jqcc.cometchat)!='undefined'&&typeof(jqcc.cometchat.getBaseData)!='undefined'){basedata=jqcc.cometchat.getBaseData();}
url+=queryStringSeparator+'basedata='+basedata+'&popoutmode=1';}else{url+=queryStringSeparator+'&popoutmode=1';}
if(typeof(jqcc.cometchat)!="undefined"&&typeof(jqcc.cometchat.getCcvariable)!="undefined"&&jqcc.cometchat.getCcvariable().callbackfn=='desktop'){var b=properties.split(',');var i;var nw=0;var nh=0;for(i=0;i<b.length;i++){if(b[i].indexOf('height')!=-1){var h=b[i].split('=');nh=h[1];}
if(b[i].indexOf('width')!=-1){var w=b[i].split('=');nw=w[1];}}
nh=parseInt(nh)+30;nw=parseInt(nw)+15;var w=window.open(url,name,properties);w.document.title=name;w.resizeTo(nw,nh);w.focus();}else{var w=window.open(url,name,properties);w.focus();}}else{if(url.split("?")[1].split("&").indexOf('caller=cometchat_synergy_iframe')<0){theme='glass';}else{theme='synergy';}
url+='&cc_theme='+theme;if(jqcc('#cometchat_container_'+name).length>0){alert('This popup is already open. Please close the existing popup and try again.');setTimeout(function(){cc_zindex+=1;jqcc('#cometchat_container_'+name).css('z-index',300001+cc_zindex);},100);return;}
var top=((jqcc(window).height()-height)/2);var left=((jqcc(window).width()-width)/2)+jqcc(window).scrollLeft();if(top<0){top=0;}
if(left<0){left=0;}
var queryStringSeparator='&';if(url.indexOf('?')<0){queryStringSeparator='?';}
url+=queryStringSeparator+'basedata='+jqcc.cometchat.getBaseData()+'&embed=web&popoutmode=null';if(jqcc(document).fullScreen()!==null&&allowmaximize==1){displaymaxicon='style="display:inline-block;"';}else{displaymaxicon='style="display:none;"';}
if(allowpopout==1){displaypopicon='style="display:inline-block;"';}else{displaypopicon='style="display:none;"';}
widthMinBorder=width-2;jqcc("body").append('<div id="cometchat_container_'+name+'" class="cometchat_container" style="left:'+left+'px;top:'+top+'px;width:'+width+'px;"><div class="cometchat_container_title"  onmousedown="dragStart(event, \'cometchat_container_'+name+'\')"><span>'+title+'</span><div class="cometchat_closebox cometchat_tooltip" title="Close Popup" id="cometchat_closebox_'+name+'" style="font-weight: normal;">Ã—</div><div '+displaymaxicon+' class="cometchat_maxwindow cometchat_tooltip" title="Maximize Popup" id="cometchat_maxwindow_'+name+'"></div><div '+displaypopicon+' class="cometchat_popwindow cometchat_tooltip" title="Popout" id="cometchat_popwindow_'+name+'"></div><div style="clear:both"></div></div><div class="cometchat_container_body" style="height:'+(height)+'px;width:'+(widthMinBorder)+'px;"><div class="cometchat_loading"></div><iframe class="cometchat_iframe" id="cometchat_trayicon_'+name+'_iframe" width="'+(widthMinBorder)+'" height="'+(height)+'"  allowtransparency="true" frameborder="0"  scrolling="no" src="'+url+'" allowfullscreen="true" webkitallowfullscreen="true" mozallowfullscreen="true"></iframe><div class="cometchat_overlay" style="width:'+(widthMinBorder)+'px;height:'+(height)+'px;"></div><div style="clear:both"></div></div></div>');setTimeout(function(){cc_zindex+=1;jqcc('#cometchat_container_'+name).css('z-index',300001+cc_zindex);},100);if(force==true){if(navigator.appVersion.indexOf("MSIE")==-1){window.onbeforeunload=function(){return'Navigating away from this page will close your chat popups.'};}}
var cometchat_container=jqcc('#cometchat_container_'+name);cometchat_container.find('.cometchat_closebox').click(function(){cometchat_container.remove();jqcc("#cometchat_tooltip").css('display','none');window.onbeforeunload=null;});if(jqcc(document).fullScreen()!==null&&allowmaximize==1){cometchat_container.find('.cometchat_iframe').addClass('cometchat_iframe_'+name);cometchat_container.find('.cometchat_maxwindow').click(function(){jqcc('.cometchat_iframe_'+name).toggleFullScreen(true);if(name=='whiteboard'){jqcc('#cometchat_container_whiteboard').find('.cometchat_iframe').contents().find('#whiteboard').width(screen.width);jqcc('#cometchat_container_whiteboard').find('.cometchat_iframe').contents().find('#whiteboard').height(screen.height);}
jqcc("#cometchat_tooltip").css('display','none');});}
if(allowpopout==1){cometchat_container.find('.cometchat_popwindow').click(function(){window.open(url+"&popoutmode=1",'_blank','width='+width+',height='+height+' scrollbars=yes, resizable=yes');jqcc.cometchat.setInternalVariable('avchatpopoutcalled','1');cometchat_container.remove();jqcc("#cometchat_tooltip").css('display','none');});}
cometchat_container.click(function(){cc_zindex+=1;jqcc(this).css('z-index',300001+cc_zindex);});}}
var closeCCPopup=closeCCPopup||function(id){jqcc('#cometchat_container_'+id).remove();}
function resizeCCPopup(id,width,height){jqcc('#cometchat_container_'+id).css('width',width+2+'px').find('.cometchat_container_body').css({'height':height,'width':width});jqcc('#cometchat_container_'+id).find('.cometchat_iframe').attr({'height':height,'width':width});}
function getID(id){return document.getElementById(id);}
function dragStart(a,b){cc_zindex+=1;jqcc('#'+b).css('z-index',300001+cc_zindex);jqcc('#'+b).find('.cometchat_overlay').css('display','block');var x,y;cc_dragobj.elNode=getID(b);try{x=window.event.clientX+document.documentElement.scrollLeft+document.body.scrollLeft;y=window.event.clientY+document.documentElement.scrollTop+document.body.scrollTop}catch(e){x=a.clientX+window.scrollX;y=a.clientY+window.scrollY}cc_dragobj.cursorStartX=x;cc_dragobj.cursorStartY=y;cc_dragobj.elStartLeft=parseInt(cc_dragobj.elNode.style.left,10);cc_dragobj.elStartTop=parseInt(cc_dragobj.elNode.style.top,10);if(isNaN(cc_dragobj.elStartLeft))cc_dragobj.elStartLeft=0;if(isNaN(cc_dragobj.elStartTop))cc_dragobj.elStartTop=0;try{document.attachEvent("onmousemove",dragGo);document.attachEvent("onmouseup",dragStop);window.event.cancelBubble=true;window.event.returnValue=false}catch(e){document.addEventListener("mousemove",dragGo,true);document.addEventListener("mouseup",dragStop,true);a.preventDefault()}}
function dragGo(a){var x,y;try{x=window.event.clientX+document.documentElement.scrollLeft+document.body.scrollLeft;y=window.event.clientY+document.documentElement.scrollTop+document.body.scrollTop}catch(e){x=a.clientX+window.scrollX;y=a.clientY+window.scrollY}var b=(cc_dragobj.elStartLeft+x-cc_dragobj.cursorStartX);var c=(cc_dragobj.elStartTop+y-cc_dragobj.cursorStartY);if(b>0){cc_dragobj.elNode.style.left=b+"px"}else{cc_dragobj.elNode.style.left="1px"}if(c>0){cc_dragobj.elNode.style.top=c+"px"}else{cc_dragobj.elNode.style.top="1px"}try{window.event.cancelBubble=true;window.event.returnValue=false}catch(e){a.preventDefault()}}
function dragStop(event){jqcc('.cometchat_overlay').css('display','none');try{document.detachEvent("onmousemove",dragGo);document.detachEvent("onmouseup",dragStop)}catch(e){document.removeEventListener("mousemove",dragGo,true);document.removeEventListener("mouseup",dragStop,true)}}
function getTimeDisplay(ts){if((ts+"").length==10){ts=ts*1000;}
var time=new Date(ts);var ap="";var hour=time.getHours();var minute=time.getMinutes();var date=time.getDate();var month=time.getMonth();var year=time.getFullYear();var armyTime=0;if(typeof(jqcc.cometchat.getSettings)=='undefined'){armyTime=jqcc.cometchat.getChatroomVars('armyTime');}else{armyTime=jqcc.cometchat.getSettings()['armyTime'];}
if(armyTime!=1){ap=hour>11?"PM":"AM";hour=hour==0?12:hour>12?hour-12:hour;}else{hour=hour<10?"0"+hour:hour;}
minute=minute<10?"0"+minute:minute;var months=['Jan','Feb','Mar','Apr','May','Jun','Jul','Aug','Sep','Oct','Nov','Dec'];var type='th';if(date==1||date==21||date==31){type='st';}else if(date==2||date==22){type='nd';}else if(date==3||date==23){type='rd';}
return{ap:ap,hour:hour,minute:minute,date:date,month:months[month],year:year,type:type};}
function attachPlaceholder(element){jqcc(element).find('[placeholder]').focus(function(){var input=jqcc(this);if(input.val()==input.attr('placeholder')){input.val('');input.removeClass('placeholder');}}).blur(function(){var input=jqcc(this);if(input.val()==''){input.addClass('placeholder');input.val(input.attr('placeholder'));}}).blur();jqcc(element).find('[placeholder]').parents('form').submit(function(){jqcc(this).find('[placeholder]').each(function(){var input=jqcc(this);if(input.val()==input.attr('placeholder')){input.val('');}});});}
function b2a(a){var c,d,e,f,g,h,i,j,o,b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",k=0,l=0,m="",n=[];if(!a)return a;do c=a.charCodeAt(k++),d=a.charCodeAt(k++),e=a.charCodeAt(k++),j=c<<16|d<<8|e,f=63&j>>18,g=63&j>>12,h=63&j>>6,i=63&j,n[l++]=b.charAt(f)+b.charAt(g)+b.charAt(h)+b.charAt(i);while(k<a.length);return m=n.join(""),o=a.length%3,(o?m.slice(0,o-3):m)+"===".slice(o||3);}
function a2b(a){var b,c,d,e={},f=0,g=0,h="",i=String.fromCharCode,j=a.length;for(b=0;64>b;b++)e["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(b)]=b;for(c=0;j>c;c++)for(b=e[a.charAt(c)],f=(f<<6)+b,g+=6;g>=8;)((d=255&f>>>(g-=8))||j-2>c)&&(h+=i(d));return h;}
function IsJsonString(str){try{return JSON.parse(str);}catch(e){return false;}}
if(typeof(jqcc)==='undefined'){jqcc=jQuery;}
jqcc.ajaxSetup({scriptCharset:"utf-8",cache:"false"});if(typeof(jqcc.cometchat)==='undefined'){var mode=1;jqcc.cometchat=function(){};}
jqcc.extend(jqcc.cometchat,{crvariables:{themename:'glass',timestamp:'0',currentroom:'0',currentp:'',currentroomcode:'',myid:'0',owner:'0',isModerator:0,cu_uids:[],heartbeatTimer:0,baseUrl:'/afpf/cometchat/',minHeartbeat:'3000',maxHeartbeat:'12000',hideEnterExit:'0',messageBeep:'1',heartbeatTime:'3000',heartbeatCount:1,todaysDate:new Date(),todays12am:(new Date()).getTime()-((new Date()).getTime()%(24*60*60*1000)),clh:'',ulh:'',prepend:0,users:{},usersName:{},initialize:1,initializeRoom:0,password:'',currentroomname:'',armyTime:'0',specialChars:/([^\x00-\x80]+)|([&][#])+/,apiAccess:0,lightboxWindows:'1',newMessages:0,plugins:['chattime','style','filetransfer','smilies','stickers'],cookiePrefix:'cc_',basedata:getURLParameter('basedata'),allowDelete:'1',lastmessagetime:Math.floor(new Date().getTime()),floodControl:'0',calleeAPI:'glass',moderators:[],windowCount:0,windows:[],popoutmode:getURLParameter('popoutmode'),cookiePrefix:'cc_',newMessageIndicator:'1',allowUsers:'1'},getcrAllVariables:function(){return this.crvariables;},getChatroomVars:function(key){if(typeof(this.crvariables[key])!=='undefined')
return this.crvariables[key];},setChatroomVars:function(key,value){this.crvariables[key]=value;},chatroommessageBeep:function(){return this.crvariables.messageBeep;},getBaseUrl:function(){return this.crvariables.baseUrl;},getBaseData:function(){if(jqcc.cookie(this.crvariables.cookiePrefix+'data')!==null){return jqcc.cookie(this.crvariables.cookiePrefix+'data');}
return this.crvariables.basedata;},popoutChatroom:function(){jqcc.cometchat.leaveChatroom();myRef=window.open(self.location,'popoutchat','left=20,top=20,status=0,toolbar=0,menubar=0,directories=0,location=0,status=0,scrollbars=0,resizable=1,width=800,height=600');if(typeof(parent.jqcc.cometchat.closeModule)=="function")
parent.jqcc.cometchat.closeModule('chatrooms');setTimeout('window.location.reload()',3000);},checkModerator:function(){if(typeof jqcc.cometchat.getChatroomVars!='undefined'&&jqcc.cometchat.getChatroomVars('myid')!=''){var moderators=jqcc.cometchat.getChatroomVars('moderators');var userid=jqcc.cometchat.getChatroomVars('myid');if(moderators.indexOf(userid)>-1){jqcc.cometchat.setChatroomVars('isModerator','1');return 1;}}
return 0;},chatroomBoxKeydown:function(event,chatboxtextarea,force){var condition=1;if((event.keyCode==13&&event.shiftKey==0)||force==1&&!$(chatboxtextarea).hasClass('placeholder')){var message=jqcc(chatboxtextarea).val();message=message.replace(/^\s+|\s+$/g,"");if(this.crvariables.floodControl!=0){condition=((Math.floor(new Date().getTime()))-this.crvariables.lastmessagetime>2000);}
if(condition){var messageLength=message.length;this.crvariables.lastmessagetime=Math.floor(new Date().getTime());if(this.crvariables.currentroom!=0){if(typeof(jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].sendChatroomMessage)=="function")
jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].sendChatroomMessage(chatboxtextarea);if(message!=''){jqcc.cometchat.sendmessageProcess(message,this.crvariables.currentroom,this.crvariables.basedata,this.crvariables.currentroomname);}}
return false;}else{alert('Please do not spam in chatroom');}}},sendmessageProcess:function(message,currentroom,basedata,currentroomname){if(message!=''){if(message.length>1000){if(message.charAt(1000)==' '){messagecurrent=message.substring(0,1000);}else{messagecurrent=message.substring(0,1000);var spacePos=messagecurrent.length;while(messagecurrent.charAt(spacePos)!=' '){spacePos--;}
messagecurrent=message.substring(0,spacePos);}
messagenext=message.substring(messagecurrent.length);if(messagenext.length>0){messagecurrent=messagecurrent+"...";}}else{messagecurrent=message;messagenext='';}
message=messagecurrent;jqcc.post(this.crvariables.baseUrl+"modules/chatrooms/chatrooms.php?action=sendmessage",{message:message,currentroom:currentroom,basedata:basedata,currentroomname:currentroomname},function(data){if(data){if(data.hasOwnProperty('m')){message=data.m;}
if(typeof(jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].addChatroomMessage)=="function")
jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].addChatroomMessage(jqcc.cometchat.getChatroomVars('myid'),message,data.id,1,Math.floor(new Date().getTime()),'0');if(typeof(jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].chatroomScrollDown)=="function")
jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].chatroomScrollDown(1);}else if(typeof(jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].crscrollToBottom)=="function"){jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].crscrollToBottom();}
if(messagenext.length>0){jqcc.cometchat.sendmessageProcess('...'+messagenext,currentroom,basedata,currentroomname);}
jqcc.cometchat.setChatroomVars('heartbeatTime',parseInt(jqcc.cometchat.getChatroomVars('minHeartbeat')));},'json');}},confirmDelete:function(delid){var confirmed=confirm('Are you want to sure you want to delete this message?');if(confirmed==true){jqcc.cometchat.deleteMessage(delid);}},deleteMessage:function(delid){jqcc.ajax({url:this.crvariables.baseUrl+"modules/chatrooms/chatrooms.php?action=deleteChatroomMessage",type:"POST",data:{delid:delid,currentroom:this.crvariables.currentroom,basedata:this.crvariables.basedata},success:function(s){if(s==1){if(typeof(jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].deletemessage)=='function'){jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].deletemessage(delid);return;}
jqcc("#cometchat_message_"+delid).remove();}}});},leaveChatroom:function(id,banflag,callbackfn){var flag=0;var params="action=leavechatroom";if(typeof(id)!='undefined'){flag=1;}
if(typeof(banflag)!='undefined'){params=params+"&banflag=1";}
if(typeof(jqcc[this.crvariables.calleeAPI].leaveRoomClass)=="function")
jqcc[this.crvariables.calleeAPI].leaveRoomClass(this.crvariables.currentroom);jqcc.post(this.crvariables.baseUrl+"modules/chatrooms/chatrooms.php?"+params,{currentroom:this.crvariables.currentroom,flag:flag,basedata:this.crvariables.basedata},function(data){if(data){document.cookie='cc_chatroom=';$.cookie('cc_crstate',null,{path:'/'});jqcc.cometchat.setChatroomVars('currentp','');jqcc.cometchat.setChatroomVars('currentroomname','');jqcc.cometchat.setChatroomVars('currentroom',0);jqcc.cometchat.setChatroomVars('timestamp',0);if(typeof(jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].removeCurrentRoomTab)=="function")
jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].removeCurrentRoomTab();if(typeof(jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].loadLobby)=="function"&&callbackfn!='mobilewebapp')
jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].loadLobby();}});},createChatroomSubmit:function(){var room=jqcc[this.crvariables.calleeAPI].createChatroomSubmitStruct();if(room.name!=''&&typeof(room.name)!='undefined'){jqcc.post(this.crvariables.baseUrl+"modules/chatrooms/chatrooms.php?action=createchatroom",{name:room.name,type:room.type,password:room.password,basedata:this.crvariables.basedata},function(data){if(parseInt(data)!=0){data=JSON.parse(data);jqcc.cometchat.setChatroomVars('currentp',SHA1(room.password))
room.name=data.n;jqcc.cometchat.chatroom(data.id,room.name,room.type,jqcc.cometchat.getChatroomVars('currentp'),1);}else{alert('This room name is not available.');}});}
return false;},deleteChatroom:function(event,id){event.stopPropagation();var confirmDeletion=confirm('Are you sure you want to delete this chatroom?');if(confirmDeletion==true){if(typeof(jqcc.cookie('cc_chatroom'))=='undefined'){var currentroomid=base64_decode(jqcc.cookie('cc_chatroom')).split(":")[0];if(currentroomid==id){jqcc.cometchat.leaveChatroom();}}
jqcc.post(this.crvariables.baseUrl+"modules/chatrooms/chatrooms.php?action=deletechatroom",{id:id,basedata:this.crvariables.basedata},function(data){if(data!=''&&parseInt(data)!=0){alert('The room has been deleted successfully');jqcc.cometchat.chatroomHeartbeat(1);}else{alert('You do not have permissions to delete the chatroom');}});}},inviteChatroomUser:function(windowmode){loadCCPopup(this.crvariables.baseUrl+'modules/chatrooms/chatrooms.php?action=invite&roomid='+this.crvariables.currentroom+'&inviteid='+this.crvariables.currentp+'&basedata='+this.crvariables.basedata+'&roomname='+urlencode(this.crvariables.currentroomname),'invite',"status=0,toolbar=0,menubar=0,directories=0,resizable=0,location=0,status=0,scrollbars=1, width=400,height=200",400,200,'Please select users',null,null,null,null,windowmode);},unbanChatroomUser:function(windowmode){loadCCPopup(this.crvariables.baseUrl+'modules/chatrooms/chatrooms.php?action=unban&roomid='+this.crvariables.currentroom+'&inviteid='+this.crvariables.currentp+'&basedata='+this.crvariables.basedata+'&roomname='+urlencode(this.crvariables.currentroomname)+'&time='+Math.random(),'invite',"status=0,toolbar=0,menubar=0,directories=0,resizable=0,location=0,status=0,scrollbars=1, width=400,height=200",400,200,'Please select users',null,null,null,null,windowmode);},loadChatroomPro:function(uid,owner,longname,popoutmode){if(popoutmode==1){showPrivateChat=0;}else{showPrivateChat=this.crvariables.checkBarEnabled;}
loadCCPopup(this.crvariables.baseUrl+'modules/chatrooms/chatrooms.php?action=loadChatroomPro&apiAccess='+showPrivateChat+'&owner='+owner+'&roomid='+this.crvariables.currentroom+'&basedata='+this.crvariables.basedata+'&inviteid='+uid+'&roomname='+urlencode(this.crvariables.currentroomname),'loadChatroomPro',"status=0,toolbar=0,menubar=0,directories=0,resizable=0,location=0,status=0,scrollbars=1, width=365,height=100",365,75,longname);},silentroom:function(roomid,inviteid,roomname){jqcc.cometchat.chatroom(roomid,roomname,1,inviteid,1);},checkChatroomPass:function(id,name,silent,password,clicked){if(silent!=1){password=SHA1(password);}
jqcc.post(this.crvariables.baseUrl+"modules/chatrooms/chatrooms.php?action=checkpassword",{password:password,id:id,basedata:this.crvariables.basedata},function(data){if(data){if(data['s']!='INVALID_PASSWORD'&&data['s']!='BANNED'&&data['s']!='INVALID_CHATROOM'){jqcc.cometchat.setChatroomVars('owner',parseInt(data['owner']));jqcc.cometchat.setChatroomVars('myid',parseInt(data['userid']));jqcc.cometchat.setChatroomVars('isModerator',parseInt(data['ismoderator']));jqcc.cometchat.setChatroomVars('currentp',password);jqcc.cometchat.setChatroomVars('initializeRoom',1);if(typeof(jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].hidetabs)=="function")
jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].hidetabs();if(typeof(jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].selectChatroom)=="function")
jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].selectChatroom(jqcc.cometchat.getChatroomVars('currentroom'),id);jqcc.cometchat.setChatroomVars('currentroom',id);jqcc.cometchat.setChatroomVars('ulh','');jqcc.cometchat.setChatroomVars('currentroomname',name);if(typeof(jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].checkOwnership)=="function")
jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].checkOwnership(jqcc.cometchat.getChatroomVars('owner'),jqcc.cometchat.getChatroomVars('isModerator'),name);if(typeof(jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].setRoomName)=="function")
jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].setRoomName(name);if(typeof(jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].loadRoom)=="function")
jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].loadRoom(clicked);clearTimeout(jqcc.cometchat.getChatroomVars('heartbeatTimer'));if(typeof(jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].loadMobileChatroom)=="function")
jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].loadMobileChatroom();jqcc.cometchat.setChatroomVars('cu_uids','');jqcc.cometchat.chatroomHeartbeat(1);}else{if(data['s']=='BANNED'){if(silent!=1){alert('Sorry, you are banned from this chatroom.');if(typeof(jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].loadMobileLobbyReverse)=="function")
jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].loadMobileLobbyReverse();}}else if(data['s']=='INVALID_CHATROOM'){jqcc.cometchat.leaveChatroom();alert('The room has been deleted.');}else{alert('Incorrect password. Please try again.');}}}});},chatroom:function(id,name,type,invite,silent,clicked){$('#cometchat_chatroomlist_'+id).find('.cometchat_msgcounttext_cr').text('0');$('#cometchat_chatroomlist_'+id).find('.cometchat_msgcount_cr').hide();name=urldecode(name);if(this.crvariables.currentroom!=id){this.crvariables.password='';if(invite!=''){this.crvariables.password=invite;}
if(type==1||type==2){if(silent!=1){if(typeof(jqcc[this.crvariables.calleeAPI].silentRoom)=="function")
jqcc[this.crvariables.calleeAPI].silentRoom(id,name,silent);}else{jqcc.cometchat.checkChatroomPass(id,name,silent,this.crvariables.password,clicked);}}else{jqcc.cometchat.checkChatroomPass(id,name,silent,this.crvariables.password,clicked);}}else{if(typeof(jqcc[this.crvariables.calleeAPI].loadRoom)=="function")
jqcc[this.crvariables.calleeAPI].loadRoom(clicked);clearTimeout(this.crvariables.heartbeatTimer);jqcc.cometchat.chatroomHeartbeat(1);}},chatroomHeartbeat:function(forceUpdate){jqcc.ajax({url:this.crvariables.baseUrl+"modules/chatrooms/chatrooms.php?action=heartbeat",data:{timestamp:this.crvariables.timestamp,currentroom:this.crvariables.currentroom,clh:this.crvariables.clh,ulh:this.crvariables.ulh,currentp:this.crvariables.currentp,popout:this.crvariables.apiAccess,force:forceUpdate,basedata:this.crvariables.basedata,initialize:this.crvariables.initialize},type:'post',cache:false,timeout:10000,error:function(){clearTimeout(jqcc.cometchat.getChatroomVars('heartbeatTimer'));jqcc.cometchat.setChatroomVars('heartbeatTime',jqcc.cometchat.getChatroomVars('minHeartbeat'));jqcc.cometchat.setChatroomVars('heartbeatTimer',setTimeout(function(){jqcc.cometchat.chatroomHeartbeat();},jqcc.cometchat.getChatroomVars('heartbeatTime')));},success:function(data){if(data){var fetchedUsers=0;jqcc.each(data,function(type,item){if(type=='logout'){if(typeof(jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].chatroomLogout)=="function")
jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].chatroomLogout();}
if(type=='userid'){jqcc.cometchat.setChatroomVars('myid',item);jqcc.cometchat.setChatroomVars('initialize',0);}
if(type=='chatrooms'){if(typeof(jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].loadChatroomList)=="function")
jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].loadChatroomList(item);}
if(type=='clh'){jqcc.cometchat.setChatroomVars('clh',item);}
if(type=='prepend'){jqcc.cometchat.setChatroomVars('prepend',item);}
if(type=='ulh'){jqcc.cometchat.setChatroomVars('ulh',item);}
if(type=='messages'){if(typeof(jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].displayChatroomMessage)=="function")
jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].displayChatroomMessage(item,fetchedUsers);}
if(type=='users'){if(typeof(jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].updateChatroomUsers)=="function")
jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].updateChatroomUsers(item,fetchedUsers);}
if(type=='error'){if(item=='ROOM_DOES_NOT_EXISTS'){alert('The room has been deleted.');}
jqcc.cometchat.leaveChatroom();}});}
jqcc.cometchat.setChatroomVars('heartbeatCount',parseInt(jqcc.cometchat.getChatroomVars('heartbeatCount')+1));if(jqcc.cometchat.getChatroomVars('heartbeatCount')>4){jqcc.cometchat.setChatroomVars('heartbeatTime',parseInt(jqcc.cometchat.getChatroomVars('heartbeatTime'))*2);jqcc.cometchat.setChatroomVars('heartbeatCount',1);}
if(parseInt(jqcc.cometchat.getChatroomVars('heartbeatTime'))>parseInt(jqcc.cometchat.getChatroomVars('maxHeartbeat'))){jqcc.cometchat.setChatroomVars('heartbeatTime',parseInt(jqcc.cometchat.getChatroomVars('maxHeartbeat')));}
jqcc.cometchat.setChatroomVars('heartbeatTimer',0);jqcc.cometchat.setChatroomVars('heartbeatTimer',setTimeout(function(){jqcc.cometchat.chatroomHeartbeat();},parseInt(jqcc.cometchat.getChatroomVars('heartbeatTime'))));}});},kickChatroomUser:function(kickid,kick){jqcc.ajax({url:this.crvariables.baseUrl+"modules/chatrooms/chatrooms.php?action=kickUser",type:"POST",data:{kickid:kickid,currentroom:this.crvariables.currentroom,kick:kick,basedata:this.crvariables.basedata},success:function(s){if(s==1){if(typeof(jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].kickid)=="function")
jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].kickid(kickid);jqcc.cometchat.setChatroomVars('ulh','');}}});},banChatroomUser:function(banid,ban){jqcc.ajax({url:this.crvariables.baseUrl+"modules/chatrooms/chatrooms.php?action=banUser",type:"POST",data:{banid:banid,currentroom:this.crvariables.currentroom,ban:ban,basedata:this.crvariables.basedata,popoutmode:this.crvariables.popoutmode},success:function(s){if(s==1){if(typeof(jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].banid)=="function")
jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].banid(banid);}}});},processcontrolmessage:function(incoming){if((incoming.message).indexOf('CC^CONTROL_')!=-1){var message=(incoming.message).replace('CC^CONTROL_','');var data=incoming.message.split('_');if(IsJsonString(message)){message=JSON.parse(message);return jqcc['cc'+message.name.toLowerCase()].processControlMessage(message.params);}else if(data[1]=='PLUGIN'){switch(data[2]){case'AVCHAT':switch(data[3]){case'ENDCALL':var controlparameters={"type":"plugins","name":"avchat","method":"endcall","params":{"grp":data[4],"chatroommode":1}};break;case'REJECTCALL':var controlparameters={"type":"plugins","name":"avchat","method":"rejectcall","params":{"grp":data[4],"chatroommode":1}};break;case'NOANSWER':var controlparameters={"type":"plugins","name":"avchat","method":"noanswer","params":{"grp":data[4],"chatroommode":1}};break;case'CANCELCALL':var controlparameters={"type":"plugins","name":"avchat","method":"canceloutgoingcall","params":{"grp":data[4],"chatroommode":1}};break;case'BUSYCALL':var controlparameters={"type":"plugins","name":"avchat","method":"busycall","params":{"grp":data[4],"chatroommode":1}};break;default:message='';break;}
return jqcc['cc'+controlparameters.name].processControlMessage(controlparameters);break;case'AUDIOCHAT':switch(data[3]){case'ENDCALL':var controlparameters={"type":"plugins","name":"audiochat","method":"endcall","params":{"grp":data[4],"chatroommode":1}};break;case'REJECTCALL':var controlparameters={"type":"plugins","name":"audiochat","method":"rejectcall","params":{"grp":data[4],"chatroommode":1}};break;case'NOANSWER':var controlparameters={"type":"plugins","name":"audiochat","method":"noanswer","params":{"grp":data[4],"chatroommode":1}};break;case'CANCELCALL':var controlparameters={"type":"plugins","name":"audiochat","method":"canceloutgoingcall","params":{"grp":data[4],"chatroommode":1}};break;case'BUSYCALL':var controlparameters={"type":"plugins","name":"audiochat","method":"busycall","params":{"grp":data[4],"chatroommode":1}};break;default:message='';break;}
return jqcc['cc'+controlparameters.name].processControlMessage(controlparameters);break;case'BROADCAST':switch(data[3]){case'ENDCALL':var controlparameters={"type":"plugins","name":"broadcast","method":"endcall","params":{"grp":data[4],"chatroommode":1}};break;default:message='';break;}
return jqcc['cc'+controlparameters.name].processControlMessage(controlparameters);break;default:break;}}else{switch(data[1]){case'kicked':if(jqcc.cometchat.getChatroomVars('myid')==data[2]){jqcc.cometchat.kickChatroomUser(data[1],incoming.id);alert('You have been kicked from this chatroom.');jqcc.cometchat.leaveChatroom();}
return'';break;case'banned':if(jqcc.cometchat.getChatroomVars('myid')==data[2]){jqcc.cometchat.banChatroomUser(data[1],incoming.id);alert('Sorry, you are banned from this chatroom.');jqcc.cometchat.leaveChatroom(data[2],1);}
return'';break;case'deletemessage':$("#cometchat_message_"+data[2]).remove();return'';break;default:break;}}}else{return incoming.message;}},chatroomready:function(){jqcc(function(){if(jqcc.cometchat.getChatroomVars('calleeAPI')!='mobilewebapp'){attachPlaceholder();if((jqcc.cometchat.chatroommessageBeep())==1){jqcc('<audio id="messageBeep" style="display:none;"><source src="'+jqcc.cometchat.getChatroomVars('baseUrl')+'mp3/beep.mp3" type="audio/mpeg"><source src="'+jqcc.cometchat.getChatroomVars('baseUrl')+'mp3/beep.ogg" type="audio/ogg"><source src="'+jqcc.cometchat.getChatroomVars('baseUrl')+'mp3/beep.wav" type="audio/wav"></audio>').appendTo(jqcc("body"));}
try{if(parent.jqcc.cometchat.ping()==1){jqcc.cometchat.setChatroomVars('apiAccess',1);}
if(jqcc().slimScroll){jqcc("#currentroom_convo").slimScroll({height:jqcc("#currentroom_convo").css('height')});jqcc("#currentroom_users").slimScroll({height:jqcc("#currentroom_users").css('height')});}}catch(e){}
if(jqcc.cometchat.getChatroomVars('calleeAPI')!=='mobilewebapp'){jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].chatroomWindowResize();}
window.onresize=function(event){if(jqcc.cometchat.getChatroomVars('calleeAPI')!=='mobilewebapp'){jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].chatroomWindowResize();}}
jqcc('#currentroom').mouseover(function(){jqcc.cometchat.setChatroomVars('newMessages',0);});jqcc.cometchat.chatroomHeartbeat(1);jqcc("textarea.cometchat_textarea").keydown(function(event){return jqcc.cometchat.chatroomBoxKeydown(event,this);});jqcc("div.cometchat_tabcontentsubmit").click(function(event){return jqcc.cometchat.chatroomBoxKeydown(event,jqcc("textarea.cometchat_textarea"),1);});jqcc("textarea.cometchat_textarea").keyup(function(event){return jqcc[jqcc.cometchat.getChatroomVars('calleeAPI')].chatroomBoxKeyup(event,this);});}});}});jqcc.cometchat.chatroomready();function SHA1(e){function rotate_left(n,s){var a=(n<<s)|(n>>>(32-s));return a};function lsb_hex(a){var b="";var i;var c;var d;for(i=0;i<=6;i+=2){c=(a>>>(i*4+4))&0x0f;d=(a>>>(i*4))&0x0f;b+=c.toString(16)+d.toString(16)}return b};function cvt_hex(a){var b="";var i;var v;for(i=7;i>=0;i--){v=(a>>>(i*4))&0x0f;b+=v.toString(16)}return b};function Utf8Encode(a){a=a.replace(/\r\n/g,"\n");var b="";for(var n=0;n<a.length;n++){var c=a.charCodeAt(n);if(c<128){b+=String.fromCharCode(c)}else if((c>127)&&(c<2048)){b+=String.fromCharCode((c>>6)|192);b+=String.fromCharCode((c&63)|128)}else{b+=String.fromCharCode((c>>12)|224);b+=String.fromCharCode(((c>>6)&63)|128);b+=String.fromCharCode((c&63)|128)}}return b};var f;var i,j;var W=new Array(80);var g=0x67452301;var h=0xEFCDAB89;var k=0x98BADCFE;var l=0x10325476;var m=0xC3D2E1F0;var A,B,C,D,E;var o;e=Utf8Encode(e);var p=e.length;var q=new Array();for(i=0;i<p-3;i+=4){j=e.charCodeAt(i)<<24|e.charCodeAt(i+1)<<16|e.charCodeAt(i+2)<<8|e.charCodeAt(i+3);q.push(j)}switch(p%4){case 0:i=0x080000000;break;case 1:i=e.charCodeAt(p-1)<<24|0x0800000;break;case 2:i=e.charCodeAt(p-2)<<24|e.charCodeAt(p-1)<<16|0x08000;break;case 3:i=e.charCodeAt(p-3)<<24|e.charCodeAt(p-2)<<16|e.charCodeAt(p-1)<<8|0x80;break}q.push(i);while((q.length%16)!=14)q.push(0);q.push(p>>>29);q.push((p<<3)&0x0ffffffff);for(f=0;f<q.length;f+=16){for(i=0;i<16;i++)W[i]=q[f+i];for(i=16;i<=79;i++)W[i]=rotate_left(W[i-3]^W[i-8]^W[i-14]^W[i-16],1);A=g;B=h;C=k;D=l;E=m;for(i=0;i<=19;i++){o=(rotate_left(A,5)+((B&C)|(~B&D))+E+W[i]+0x5A827999)&0x0ffffffff;E=D;D=C;C=rotate_left(B,30);B=A;A=o}for(i=20;i<=39;i++){o=(rotate_left(A,5)+(B^C^D)+E+W[i]+0x6ED9EBA1)&0x0ffffffff;E=D;D=C;C=rotate_left(B,30);B=A;A=o}for(i=40;i<=59;i++){o=(rotate_left(A,5)+((B&C)|(B&D)|(C&D))+E+W[i]+0x8F1BBCDC)&0x0ffffffff;E=D;D=C;C=rotate_left(B,30);B=A;A=o}for(i=60;i<=79;i++){o=(rotate_left(A,5)+(B^C^D)+E+W[i]+0xCA62C1D6)&0x0ffffffff;E=D;D=C;C=rotate_left(B,30);B=A;A=o}g=(g+A)&0x0ffffffff;h=(h+B)&0x0ffffffff;k=(k+C)&0x0ffffffff;l=(l+D)&0x0ffffffff;m=(m+E)&0x0ffffffff}var o=cvt_hex(g)+cvt_hex(h)+cvt_hex(k)+cvt_hex(l)+cvt_hex(m);return o.toLowerCase()}
function MD5(j){function RotateLeft(a,b){return(a<<b)|(a>>>(32-b))}function AddUnsigned(a,b){var c,lY4,lX8,lY8,lResult;lX8=(a&0x80000000);lY8=(b&0x80000000);c=(a&0x40000000);lY4=(b&0x40000000);lResult=(a&0x3FFFFFFF)+(b&0x3FFFFFFF);if(c&lY4){return(lResult^0x80000000^lX8^lY8)}if(c|lY4){if(lResult&0x40000000){return(lResult^0xC0000000^lX8^lY8)}else{return(lResult^0x40000000^lX8^lY8)}}else{return(lResult^lX8^lY8)}}function F(x,y,z){return(x&y)|((~x)&z)}function G(x,y,z){return(x&z)|(y&(~z))}function H(x,y,z){return(x^y^z)}function I(x,y,z){return(y^(x|(~z)))}function FF(a,b,c,d,x,s,e){a=AddUnsigned(a,AddUnsigned(AddUnsigned(F(b,c,d),x),e));return AddUnsigned(RotateLeft(a,s),b)};function GG(a,b,c,d,x,s,e){a=AddUnsigned(a,AddUnsigned(AddUnsigned(G(b,c,d),x),e));return AddUnsigned(RotateLeft(a,s),b)};function HH(a,b,c,d,x,s,e){a=AddUnsigned(a,AddUnsigned(AddUnsigned(H(b,c,d),x),e));return AddUnsigned(RotateLeft(a,s),b)};function II(a,b,c,d,x,s,e){a=AddUnsigned(a,AddUnsigned(AddUnsigned(I(b,c,d),x),e));return AddUnsigned(RotateLeft(a,s),b)};function ConvertToWordArray(a){var b;var c=a.length;var d=c+8;var e=(d-(d%64))/64;var f=(e+1)*16;var g=Array(f-1);var h=0;var i=0;while(i<c){b=(i-(i%4))/4;h=(i%4)*8;g[b]=(g[b]|(a.charCodeAt(i)<<h));i++}b=(i-(i%4))/4;h=(i%4)*8;g[b]=g[b]|(0x80<<h);g[f-2]=c<<3;g[f-1]=c>>>29;return g};function WordToHex(a){var b="",WordToHexValue_temp="",lByte,lCount;for(lCount=0;lCount<=3;lCount++){lByte=(a>>>(lCount*8))&255;WordToHexValue_temp="0"+lByte.toString(16);b=b+WordToHexValue_temp.substr(WordToHexValue_temp.length-2,2)}return b};function Utf8Encode(a){a=a.replace(/\r\n/g,"\n");var b="";for(var n=0;n<a.length;n++){var c=a.charCodeAt(n);if(c<128){b+=String.fromCharCode(c)}else if((c>127)&&(c<2048)){b+=String.fromCharCode((c>>6)|192);b+=String.fromCharCode((c&63)|128)}else{b+=String.fromCharCode((c>>12)|224);b+=String.fromCharCode(((c>>6)&63)|128);b+=String.fromCharCode((c&63)|128)}}return b};var x=Array();var k,AA,BB,CC,DD,a,b,c,d;var l=7,S12=12,S13=17,S14=22;var m=5,S22=9,S23=14,S24=20;var o=4,S32=11,S33=16,S34=23;var p=6,S42=10,S43=15,S44=21;j=Utf8Encode(j);x=ConvertToWordArray(j);a=0x67452301;b=0xEFCDAB89;c=0x98BADCFE;d=0x10325476;for(k=0;k<x.length;k+=16){AA=a;BB=b;CC=c;DD=d;a=FF(a,b,c,d,x[k+0],l,0xD76AA478);d=FF(d,a,b,c,x[k+1],S12,0xE8C7B756);c=FF(c,d,a,b,x[k+2],S13,0x242070DB);b=FF(b,c,d,a,x[k+3],S14,0xC1BDCEEE);a=FF(a,b,c,d,x[k+4],l,0xF57C0FAF);d=FF(d,a,b,c,x[k+5],S12,0x4787C62A);c=FF(c,d,a,b,x[k+6],S13,0xA8304613);b=FF(b,c,d,a,x[k+7],S14,0xFD469501);a=FF(a,b,c,d,x[k+8],l,0x698098D8);d=FF(d,a,b,c,x[k+9],S12,0x8B44F7AF);c=FF(c,d,a,b,x[k+10],S13,0xFFFF5BB1);b=FF(b,c,d,a,x[k+11],S14,0x895CD7BE);a=FF(a,b,c,d,x[k+12],l,0x6B901122);d=FF(d,a,b,c,x[k+13],S12,0xFD987193);c=FF(c,d,a,b,x[k+14],S13,0xA679438E);b=FF(b,c,d,a,x[k+15],S14,0x49B40821);a=GG(a,b,c,d,x[k+1],m,0xF61E2562);d=GG(d,a,b,c,x[k+6],S22,0xC040B340);c=GG(c,d,a,b,x[k+11],S23,0x265E5A51);b=GG(b,c,d,a,x[k+0],S24,0xE9B6C7AA);a=GG(a,b,c,d,x[k+5],m,0xD62F105D);d=GG(d,a,b,c,x[k+10],S22,0x2441453);c=GG(c,d,a,b,x[k+15],S23,0xD8A1E681);b=GG(b,c,d,a,x[k+4],S24,0xE7D3FBC8);a=GG(a,b,c,d,x[k+9],m,0x21E1CDE6);d=GG(d,a,b,c,x[k+14],S22,0xC33707D6);c=GG(c,d,a,b,x[k+3],S23,0xF4D50D87);b=GG(b,c,d,a,x[k+8],S24,0x455A14ED);a=GG(a,b,c,d,x[k+13],m,0xA9E3E905);d=GG(d,a,b,c,x[k+2],S22,0xFCEFA3F8);c=GG(c,d,a,b,x[k+7],S23,0x676F02D9);b=GG(b,c,d,a,x[k+12],S24,0x8D2A4C8A);a=HH(a,b,c,d,x[k+5],o,0xFFFA3942);d=HH(d,a,b,c,x[k+8],S32,0x8771F681);c=HH(c,d,a,b,x[k+11],S33,0x6D9D6122);b=HH(b,c,d,a,x[k+14],S34,0xFDE5380C);a=HH(a,b,c,d,x[k+1],o,0xA4BEEA44);d=HH(d,a,b,c,x[k+4],S32,0x4BDECFA9);c=HH(c,d,a,b,x[k+7],S33,0xF6BB4B60);b=HH(b,c,d,a,x[k+10],S34,0xBEBFBC70);a=HH(a,b,c,d,x[k+13],o,0x289B7EC6);d=HH(d,a,b,c,x[k+0],S32,0xEAA127FA);c=HH(c,d,a,b,x[k+3],S33,0xD4EF3085);b=HH(b,c,d,a,x[k+6],S34,0x4881D05);a=HH(a,b,c,d,x[k+9],o,0xD9D4D039);d=HH(d,a,b,c,x[k+12],S32,0xE6DB99E5);c=HH(c,d,a,b,x[k+15],S33,0x1FA27CF8);b=HH(b,c,d,a,x[k+2],S34,0xC4AC5665);a=II(a,b,c,d,x[k+0],p,0xF4292244);d=II(d,a,b,c,x[k+7],S42,0x432AFF97);c=II(c,d,a,b,x[k+14],S43,0xAB9423A7);b=II(b,c,d,a,x[k+5],S44,0xFC93A039);a=II(a,b,c,d,x[k+12],p,0x655B59C3);d=II(d,a,b,c,x[k+3],S42,0x8F0CCC92);c=II(c,d,a,b,x[k+10],S43,0xFFEFF47D);b=II(b,c,d,a,x[k+1],S44,0x85845DD1);a=II(a,b,c,d,x[k+8],p,0x6FA87E4F);d=II(d,a,b,c,x[k+15],S42,0xFE2CE6E0);c=II(c,d,a,b,x[k+6],S43,0xA3014314);b=II(b,c,d,a,x[k+13],S44,0x4E0811A1);a=II(a,b,c,d,x[k+4],p,0xF7537E82);d=II(d,a,b,c,x[k+11],S42,0xBD3AF235);c=II(c,d,a,b,x[k+2],S43,0x2AD7D2BB);b=II(b,c,d,a,x[k+9],S44,0xEB86D391);a=AddUnsigned(a,AA);b=AddUnsigned(b,BB);c=AddUnsigned(c,CC);d=AddUnsigned(d,DD)}var q=WordToHex(a)+WordToHex(b)+WordToHex(c)+WordToHex(d);return q.toLowerCase()}
function base64_encode(a){var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var c,o2,o3,h1,h2,h3,h4,bits,i=0,ac=0,enc="",tmp_arr=[];if(!a){return a}a=this.utf8_encode(a+'');do{c=a.charCodeAt(i++);o2=a.charCodeAt(i++);o3=a.charCodeAt(i++);bits=c<<16|o2<<8|o3;h1=bits>>18&0x3f;h2=bits>>12&0x3f;h3=bits>>6&0x3f;h4=bits&0x3f;tmp_arr[ac++]=b.charAt(h1)+b.charAt(h2)+b.charAt(h3)+b.charAt(h4)}while(i<a.length);enc=tmp_arr.join('');switch(a.length%3){case 1:enc=enc.slice(0,-2)+'==';break;case 2:enc=enc.slice(0,-1)+'=';break}return enc}
function base64_decode(a){var b="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";var c,o2,o3,h1,h2,h3,h4,bits,i=0,ac=0,dec="",tmp_arr=[];if(!a){return a}a+='';do{h1=b.indexOf(a.charAt(i++));h2=b.indexOf(a.charAt(i++));h3=b.indexOf(a.charAt(i++));h4=b.indexOf(a.charAt(i++));bits=h1<<18|h2<<12|h3<<6|h4;c=bits>>16&0xff;o2=bits>>8&0xff;o3=bits&0xff;if(h3==64){tmp_arr[ac++]=String.fromCharCode(c)}else if(h4==64){tmp_arr[ac++]=String.fromCharCode(c,o2)}else{tmp_arr[ac++]=String.fromCharCode(c,o2,o3)}}while(i<a.length);dec=tmp_arr.join('');dec=this.utf8_decode(dec);return dec}
function utf8_decode(a){var b=[],i=0,ac=0,c1=0,c2=0,c3=0;a+='';while(i<a.length){c1=a.charCodeAt(i);if(c1<128){b[ac++]=String.fromCharCode(c1);i++}else if((c1>191)&&(c1<224)){c2=a.charCodeAt(i+1);b[ac++]=String.fromCharCode(((c1&31)<<6)|(c2&63));i+=2}else{c2=a.charCodeAt(i+1);c3=a.charCodeAt(i+2);b[ac++]=String.fromCharCode(((c1&15)<<12)|((c2&63)<<6)|(c3&63));i+=3}}return b.join('')}
function utf8_encode(a){var b=(a+'');var c="";var d,end;var e=0;d=end=0;e=b.length;for(var n=0;n<e;n++){var f=b.charCodeAt(n);var g=null;if(f<128){end++}else if(f>127&&f<2048){g=String.fromCharCode((f>>6)|192)+String.fromCharCode((f&63)|128)}else{g=String.fromCharCode((f>>12)|224)+String.fromCharCode(((f>>6)&63)|128)+String.fromCharCode((f&63)|128)}if(g!==null){if(end>d){c+=b.substring(d,end)}c+=g;d=end=n+1}}if(end>d){c+=b.substring(d,b.length)}return c}
function urlencode(string){return base64_encode(string);}
function urldecode(string){return base64_decode(string);}
function getURLParameter(name){return decodeURI((RegExp(name+'='+'(.+?)(&|$)').exec(location.search)||[,null])[1]);}
jqcc.cookie=function(a,b,c){if(typeof b!='undefined'){c=c||{};if(b===null){b='';c.expires=-1}var d='';if(c.expires&&(typeof c.expires=='number'||c.expires.toUTCString)){var e;if(typeof c.expires=='number'){e=new Date();e.setTime(e.getTime()+(c.expires*24*60*60*1000))}else{e=c.expires}d='; expires='+e.toUTCString()}var f=c.path?'; path='+(c.path):'';var g=c.domain?'; domain='+(c.domain):'';var h=c.secure?'; secure':'';document.cookie=[a,'=',encodeURIComponent(b),d,f,g,h].join('')}else{var j=null;if(document.cookie&&document.cookie!=''){var k=document.cookie.split(';');for(var i=0;i<k.length;i++){var l=jqcc.trim(k[i]);if(l.substring(0,a.length+1)==(a+'=')){j=decodeURIComponent(l.substring(a.length+1));break}}}return j}};if(typeof deconcept=="undefined"){var deconcept=new Object();}if(typeof deconcept.util=="undefined"){deconcept.util=new Object();}if(typeof deconcept.SWFObjectCCUtil=="undefined"){deconcept.SWFObjectCCUtil=new Object();}deconcept.SWFObjectCC=function(_1,id,w,h,_5,c,_7,_8,_9,_a){if(!document.getElementById){return;}this.DETECT_KEY=_a?_a:"detectflash";this.skipDetect=deconcept.util.getRequestParameter(this.DETECT_KEY);this.params=new Object();this.variables=new Object();this.attributes=new Array();if(_1){this.setAttribute("swf",_1);}if(id){this.setAttribute("id",id);}if(w){this.setAttribute("width",w);}if(h){this.setAttribute("height",h);}if(_5){this.setAttribute("version",new deconcept.PlayerVersion(_5.toString().split(".")));}this.installedVer=deconcept.SWFObjectCCUtil.getPlayerVersion();if(!window.opera&&document.all&&this.installedVer.major>7){deconcept.SWFObjectCC.doPrepUnload=true;}if(c){this.addParam("bgcolor",c);}var q=_7?_7:"high";this.addParam("quality",q);this.setAttribute("useExpressInstall",false);this.setAttribute("doExpressInstall",false);var _c=(_8)?_8:window.location;this.setAttribute("xiRedirectUrl",_c);this.setAttribute("redirectUrl","");if(_9){this.setAttribute("redirectUrl",_9);}};deconcept.SWFObjectCC.prototype={useExpressInstall:function(_d){this.xiSWFPath=!_d?"expressinstall.swf":_d;this.setAttribute("useExpressInstall",true);},setAttribute:function(_e,_f){this.attributes[_e]=_f;},getAttribute:function(_10){return this.attributes[_10];},addParam:function(_11,_12){this.params[_11]=_12;},getParams:function(){return this.params;},addVariable:function(_13,_14){this.variables[_13]=_14;},getVariable:function(_15){return this.variables[_15];},getVariables:function(){return this.variables;},getVariablePairs:function(){var _16=new Array();var key;var _18=this.getVariables();for(key in _18){_16[_16.length]=key+"="+_18[key];}return _16;},getSWFHTML:function(){var _19="";if(navigator.plugins&&navigator.mimeTypes&&navigator.mimeTypes.length){if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","PlugIn");this.setAttribute("swf",this.xiSWFPath);}_19="<embed type=\"application/x-shockwave-flash\" src=\""+this.getAttribute("swf")+"\" width=\""+this.getAttribute("width")+"\" height=\""+this.getAttribute("height")+"\" style=\""+this.getAttribute("style")+"\"";_19+=" id=\""+this.getAttribute("id")+"\" name=\""+this.getAttribute("id")+"\" ";var _1a=this.getParams();for(var key in _1a){_19+=[key]+"=\""+_1a[key]+"\" ";}var _1c=this.getVariablePairs().join("&");if(_1c.length>0){_19+="flashvars=\""+_1c+"\"";}_19+="/>";}else{if(this.getAttribute("doExpressInstall")){this.addVariable("MMplayerType","ActiveX");this.setAttribute("swf",this.xiSWFPath);}_19="<object id=\""+this.getAttribute("id")+"\" classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\" width=\""+this.getAttribute("width")+"\" height=\""+this.getAttribute("height")+"\" style=\""+this.getAttribute("style")+"\">";_19+="<param name=\"movie\" value=\""+this.getAttribute("swf")+"\" />";var _1d=this.getParams();for(var key in _1d){_19+="<param name=\""+key+"\" value=\""+_1d[key]+"\" />";}var _1f=this.getVariablePairs().join("&");if(_1f.length>0){_19+="<param name=\"flashvars\" value=\""+_1f+"\" />";}_19+="</object>";}return _19;},write:function(_20){if(this.getAttribute("useExpressInstall")){var _21=new deconcept.PlayerVersion([6,0,65]);if(this.installedVer.versionIsValid(_21)&&!this.installedVer.versionIsValid(this.getAttribute("version"))){this.setAttribute("doExpressInstall",true);this.addVariable("MMredirectURL",escape(this.getAttribute("xiRedirectUrl")));document.title=document.title.slice(0,47)+" - Flash Player Installation";this.addVariable("MMdoctitle",document.title);}}if(this.skipDetect||this.getAttribute("doExpressInstall")||this.installedVer.versionIsValid(this.getAttribute("version"))){var n=(typeof _20=="string")?document.getElementById(_20):_20;n.innerHTML=this.getSWFHTML();return true;}else{if(this.getAttribute("redirectUrl")!=""){document.location.replace(this.getAttribute("redirectUrl"));}}return false;}};deconcept.SWFObjectCCUtil.getPlayerVersion=function(){var _23=new deconcept.PlayerVersion([0,0,0]);if(navigator.plugins&&navigator.mimeTypes.length){var x=navigator.plugins["Shockwave Flash"];if(x&&x.description){_23=new deconcept.PlayerVersion(x.description.replace(/([a-zA-Z]|\s)+/,"").replace(/(\s+r|\s+b[0-9]+)/,".").split("."));}}else{if(navigator.userAgent&&navigator.userAgent.indexOf("Windows CE")>=0){var axo=1;var _26=3;while(axo){try{_26++;axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash."+_26);_23=new deconcept.PlayerVersion([_26,0,0]);}catch(e){axo=null;}}}else{try{var axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.7");}catch(e){try{var axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash.6");_23=new deconcept.PlayerVersion([6,0,21]);axo.AllowScriptAccess="always";}catch(e){if(_23.major==6){return _23;}}try{axo=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");}catch(e){}}if(axo!=null){_23=new deconcept.PlayerVersion(axo.GetVariable("$version").split(" ")[1].split(","));}}}return _23;};deconcept.PlayerVersion=function(_29){this.major=_29[0]!=null?parseInt(_29[0]):0;this.minor=_29[1]!=null?parseInt(_29[1]):0;this.rev=_29[2]!=null?parseInt(_29[2]):0;};deconcept.PlayerVersion.prototype.versionIsValid=function(fv){if(this.major<fv.major){return false;}if(this.major>fv.major){return true;}if(this.minor<fv.minor){return false;}if(this.minor>fv.minor){return true;}if(this.rev<fv.rev){return false;}return true;};deconcept.util={getRequestParameter:function(_2b){var q=document.location.search||document.location.hash;if(_2b==null){return q;}if(q){var _2d=q.substring(1).split("&");for(var i=0;i<_2d.length;i++){if(_2d[i].substring(0,_2d[i].indexOf("="))==_2b){return _2d[i].substring((_2d[i].indexOf("=")+1));}}}return"";}};deconcept.SWFObjectCCUtil.cleanupSWFs=function(){var _2f=document.getElementsByTagName("OBJECT");for(var i=_2f.length-1;i>=0;i--){_2f[i].style.display="none";for(var x in _2f[i]){if(typeof _2f[i][x]=="function"){_2f[i][x]=function(){};}}}};if(deconcept.SWFObjectCC.doPrepUnload){if(!deconcept.unloadSet){deconcept.SWFObjectCCUtil.prepUnload=function(){__flash_unloadHandler=function(){};__flash_savedUnloadHandler=function(){};window.attachEvent("onunload",deconcept.SWFObjectCCUtil.cleanupSWFs);};window.attachEvent("onbeforeunload",deconcept.SWFObjectCCUtil.prepUnload);deconcept.unloadSet=true;}}if(!document.getElementById&&document.all){document.getElementById=function(id){return document.all[id];};}var getQueryParamValue=deconcept.util.getRequestParameter;var FlashObject=deconcept.SWFObjectCC;var SWFObjectCC=deconcept.SWFObjectCC;function attachPlaceholder(){jqcc('[placeholder]').not('#password').focus(function(){var input=jqcc(this);if(input.val()==input.attr('placeholder')){input.val('');input.removeClass('placeholder');}}).blur(function(){var input=jqcc(this);if(input.val()==''){input.addClass('placeholder');input.val(input.attr('placeholder'));}}).blur();jqcc('[placeholder]').parents('form').submit(function(){jqcc(this).find('[placeholder]').each(function(){var input=jqcc(this);if(input.val()==input.attr('placeholder')){input.val('');}});});}
(function($){$.ccreport=(function(){var title='Report Conversation';return{getTitle:function(){return title;},init:function(params){var id=params.to;var chatroommode=params.chatroommode;var mode=params.mode;if(typeof(mode)!=="undefined"&&mode!=='mobilewebapp'){chatroommode=mode;}
var caller='';if(typeof(params.caller)!="undefined"){caller=params.caller;}
if($("#cometchat_user_"+id+"_popup").find("div.cometchat_tabcontenttext").html()!=''){baseData=$.cometchat.getBaseData();baseUrl=$.cometchat.getBaseUrl();if(mode==='mobilewebapp'){window.open(baseUrl+'plugins/report/index.php?id='+id+'&basedata='+baseData+'&callback=mobilewebapp');}else{if(jqcc.cometchat.getCcvariable().callbackfn=='desktop'){loadCCPopup(baseUrl+'plugins/report/index.php?id='+id+'&basedata='+baseData,'report',"status=0,toolbar=0,menubar=0,directories=0,resizable=0,location=0,status=0,scrollbars=0, width=430,height=220",430,175,'Reason as to why you are reporting this user?',0,0,0,0,1);}else{loadCCPopup(baseUrl+'plugins/report/index.php?id='+id+'&caller='+caller+'&basedata='+baseData,'report',"status=0,toolbar=0,menubar=0,directories=0,resizable=0,location=0,status=0,scrollbars=0, width=430,height=220",430,175,'Reason as to why you are reporting this user?');}}}else{alert('Sorry, your conversation with this user is empty.');}}};})();})(jqcc);(function($){$.ccwriteboard=(function(){var title='Share a collaborative document';var lastcall=0;var height=480;var width=640;return{getTitle:function(){return title;},init:function(params){var id=params.to;var chatroommode=params.chatroommode;var windowMode=0;if(typeof(params.windowMode)=="undefined"){windowMode=0;}else{windowMode=1;}
if(chatroommode==1){var currenttime=new Date();currenttime=parseInt(currenttime.getTime()/1000);if(currenttime-lastcall>10){baseUrl=$.cometchat.getBaseUrl();basedata=$.cometchat.getBaseData();var random=currenttime;lastcall=currenttime;loadCCPopup(baseUrl+'plugins/writeboard/index.php?action=writeboard&type=1&chatroommode=1&roomid='+id+'&id='+random+'&basedata='+basedata,'writeboard',"status=0,toolbar=0,menubar=0,directories=0,resizable=1,location=0,status=0,scrollbars=0, width=640,height=480",width,height-50,'Collaborative document',1,1,1,1,windowMode);}else{alert('Please wait atleast 10 seconds before trying to share again.');}}else{var currenttime=new Date();currenttime=parseInt(currenttime.getTime()/1000);if(currenttime-lastcall>10){baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();var random=currenttime;$.getJSON(baseUrl+'plugins/writeboard/index.php?action=request&callback=?',{to:id,id:random,basedata:baseData});lastcall=currenttime;loadCCPopup(baseUrl+'plugins/writeboard/index.php?action=writeboard&type=1&id='+random+'&basedata='+baseData,'writeboard',"status=0,toolbar=0,menubar=0,directories=0,resizable=1,location=0,status=0,scrollbars=0, width="+width+",height="+height,width,height-50,'Collaborative document',0,1,1,1,windowMode);if(jqcc.cometchat.getThemeArray('buddylistIsDevice',id)==1){jqcc.ccmobilenativeapp.sendnotification('has shared a document.',id,jqcc.cometchat.getName(jqcc.cometchat.getThemeVariable('userid')));}}else{alert('Please wait atleast 10 seconds before trying to share again.');}}},accept:function(params){var id=params.to;var random=params.random;var chatroommode=params.chatroommode;windowMode=0;if(typeof(params.windowMode)=="undefined"){windowMode=0;}else{windowMode=1;}
if(chatroommode==1){baseUrl=$.cometchat.getBaseUrl();basedata=$.cometchat.getBaseData();var controlparameters={"type":"plugins","name":"core","method":"loadCCPopup","params":{"url":baseUrl+"plugins/writeboard/index.php?action=writeboard&type=0&id="+random+"&basedata="+basedata,"name":"writeboard","properties":"status=0,toolbar=0,menubar=0,directories=0,resizable=1,location=0,status=0,scrollbars=0, width=640,height=480","width":width,"height":height-50,"title":'Collaborative document',"force":"1","allowmaximize":"1","allowresize":"1","allowpopout":"1","windowMode":windowMode}};controlparameters=JSON.stringify(controlparameters);parent.postMessage('CC^CONTROL_'+controlparameters,'*');}else{baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();$.getJSON(baseUrl+'plugins/writeboard/index.php?action=accept&callback=?',{to:id,basedata:baseData});loadCCPopup(baseUrl+'plugins/writeboard/index.php?action=writeboard&type=0&id='+random+'&basedata='+baseData,'writeboard',"status=0,toolbar=0,menubar=0,directories=0,resizable=1,location=0,status=0,scrollbars=0, width="+width+",height="+height,width,height-50,'Collaborative document',0,1,1,1,windowMode);}}};})();})(jqcc);jqcc(document).ready(function(){jqcc('.accept_Write').live('click',function(){var to=jqcc(this).attr('to');var random=jqcc(this).attr('random');var chatroommode=jqcc(this).attr('chatroommode');if(typeof(parent)!='undefined'&&parent!=null&&parent!=self){var controlparameters={"type":"plugins","name":"ccwriteboard","method":"accept","params":{"to":to,"random":random,"chatroommode":chatroommode}};controlparameters=JSON.stringify(controlparameters);parent.postMessage('CC^CONTROL_'+controlparameters,'*');}else{var controlparameters={"to":to,"random":random,"chatroommode":chatroommode};jqcc.ccwriteboard.accept(controlparameters);}});});(function($){$.cctransliterate=(function(){var title='Write in your language';return{getTitle:function(){return title;},init:function(params){var id=params.to;var chatroommode=params.chatroommode;var windowMode=0;var callerUrl="";if(typeof(params.caller)!="undefined"){callerUrl="caller="+params.caller+"&";}
if(typeof(params.windowMode)=="undefined"){windowMode=0;}else{windowMode=1;}
if(chatroommode==1){baseUrl=$.cometchat.getBaseUrl();basedata=$.cometchat.getBaseData();loadCCPopup(baseUrl+'plugins/transliterate/index.php?'+callerUrl+'chatroommode=1&id='+id+'&basedata='+basedata,'transliterate',"status=0,toolbar=0,menubar=0,directories=0,resizable=0,location=0,status=0,scrollbars=0, width=430,height=220",430,175,'Write in your language',null,null,null,null,windowMode);}else{baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();loadCCPopup(baseUrl+'plugins/transliterate/index.php?'+callerUrl+'id='+id+'&basedata='+baseData,'transliterate',"status=0,toolbar=0,menubar=0,directories=0,resizable=0,location=0,status=0,scrollbars=0, width=430,height=220",430,175,'Write in your language',null,null,null,null,windowMode);}},setTitle:function(params){var lang=params.lang;if(typeof(params.formatLang)=='undefined'){$(document.getElementById("cometchat_container_transliterate")).find(".cometchat_container_title span").html(lang);}else{$(document.getElementById("cometchat_container_transliterate")).find(".cometchat_container_title span").html(lang+' : '+params.formatLang);}},appendMessage:function(params){var to=params.to;var data=params.data;var chatroommode=params.chatroommode;var e={'keyCode':13,'shiftKey':0};if(chatroommode==1){if(jqcc('#currentroom').length!=0){jqcc('#currentroom .cometchat_textarea').focus();jqcc('#currentroom .cometchat_textarea').val(data);jqcc('#currentroom .cometchat_tabcontentsubmit').click();}}else{if(jqcc('#cometchat_user_'+to+'_popup').length!=0){var theme=jqcc.cometchat.getSettings().theme;jqcc('#cometchat_user_'+to+'_popup .cometchat_textarea').focus();jqcc('#cometchat_user_'+to+'_popup .cometchat_textarea').val(data);jqcc[theme].chatboxKeydown(e,'#cometchat_user_'+to+'_popup .cometchat_textarea',to);}}}};})();})(jqcc);(function($){$.ccchathistory=(function(){var title='View chat history';return{getTitle:function(){return title;},init:function(params){var callbackfn='';if(typeof(jqcc.cometchat)!="undefined"&&typeof(jqcc.cometchat.getCcvariable)!="undefined"){if(jqcc.cometchat.getCcvariable().callbackfn=='desktop'){callbackfn='&callbackfn=desktop';}}
var id=params.to;var chatroommode=params.chatroommode;var windowMode=0;if(typeof(params.windowMode)=="undefined"){windowMode=0;}else{windowMode=1;}
if(chatroommode==1){baseUrl=$.cometchat.getBaseUrl();basedata=$.cometchat.getBaseData();loadCCPopup(baseUrl+'plugins/chathistory/index.php?embed=web&chatroommode=1&logs=1&history='+id+'&basedata='+basedata+callbackfn,'chathistory',"status=0,toolbar=0,menubar=0,directories=0,resizable=0,location=0,status=0,scrollbars=0,width=650,height=480",650,480,'Chat History',null,null,null,null,windowMode);}else{baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();loadCCPopup(baseUrl+'plugins/chathistory/index.php?embed=web&history='+id+'&logs=1&basedata='+baseData+callbackfn,'chathistory',"status=0,toolbar=0,menubar=0,directories=0,resizable=0,location=0,status=0,scrollbars=1, width=650,height=480",650,480,'Chat History',null,null,null,null,windowMode);}}};})();})(jqcc);(function($){$.ccwhiteboard=(function(){var title='Share a whiteboard';var lastcall=0;var height=480;var width=640;return{getTitle:function(){return title;},init:function(params){var id=params.to;var chatroommode=params.chatroommode;var windowMode=0;if(typeof(params.windowMode)=="undefined"){windowMode=0;}else{windowMode=1;}
if(chatroommode==1){var currenttime=new Date();currenttime=parseInt(currenttime.getTime()/1000);if(currenttime-lastcall>10){baseUrl=$.cometchat.getBaseUrl();basedata=$.cometchat.getBaseData();var random=currenttime;loadCCPopup(baseUrl+'plugins/whiteboard/index.php?action=whiteboard&chatroommode=1&subaction=request&id='+id+'&basedata='+basedata,'whiteboard',"status=0,toolbar=0,menubar=0,directories=0,resizable=1,location=0,status=0,scrollbars=0,width=640,height=480",width,height-50,'Whiteboard',1,1,1,1,windowMode);}else{alert('Please wait atleast 10 seconds before trying to share again.');}}else{var currenttime=new Date();currenttime=parseInt(currenttime.getTime()/1000);if(currenttime-lastcall>10){baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();var random=currenttime;lastcall=currenttime;loadCCPopup(baseUrl+'plugins/whiteboard/index.php?action=whiteboard&id='+id+'&random='+random+'&basedata='+baseData,'whiteboard',"status=0,toolbar=0,menubar=0,directories=0,resizable=1,location=0,status=0,scrollbars=0, width="+width+",height="+height,width,height-50,'Whiteboard',0,1,1,1,windowMode);if(jqcc.cometchat.getThemeArray('buddylistIsDevice',id)==1){jqcc.ccmobilenativeapp.sendnotification('has successfully shared his/her whiteboard.',id,jqcc.cometchat.getName(jqcc.cometchat.getThemeVariable('userid')));}}else{alert('Please wait atleast 10 seconds before trying to share again.');}}},accept:function(params){var id=params.to;var random=params.random;var chatroommode=params.chatroommode;var windowMode=0;if(typeof(params.windowMode)=="undefined"){windowMode=0;}else{windowMode=1;}
if(chatroommode==1){baseUrl=$.cometchat.getBaseUrl();basedata=$.cometchat.getBaseData();var controlparameters={"type":"plugins","name":"core","method":"loadCCPopup","params":{"url":baseUrl+'plugins/whiteboard/index.php?action=whiteboard&chatroommode=1&id='+id+'&basedata='+basedata,"name":"whiteboard","properties":"status=0,toolbar=0,menubar=0,directories=0,resizable=1,location=0,status=0,scrollbars=0, width=640,height=480","width":width,"height":height-50,"title":'Whiteboard',"force":"1","allowmaximize":"1","allowresize":"1","allowpopout":"1","windowMode":windowMode}};controlparameters=JSON.stringify(controlparameters);parent.postMessage('CC^CONTROL_'+controlparameters,'*');}else{baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();$.getJSON(baseUrl+'plugins/whiteboard/index.php?action=accept&callback=?',{to:id,basedata:baseData});loadCCPopup(baseUrl+'plugins/whiteboard/index.php?action=whiteboard&id='+id+'&basedata='+baseData,'whiteboard',"status=0,toolbar=0,menubar=0,directories=0,resizable=1,location=0,status=0,scrollbars=0, width="+width+",height="+height,width,height-50,'Whiteboard',0,1,1,1,windowMode);}}};})();})(jqcc);jqcc(document).ready(function(){jqcc('.accept_White').live('click',function(){var to=jqcc(this).attr('to');var random=jqcc(this).attr('random');var chatroommode=jqcc(this).attr('chatroommode');if(typeof(parent)!='undefined'&&parent!=null&&parent!=self){var controlparameters={"type":"plugins","name":"ccwhiteboard","method":"accept","params":{"to":to,"random":random,"chatroommode":chatroommode}};controlparameters=JSON.stringify(controlparameters);parent.postMessage('CC^CONTROL_'+controlparameters,'*');}else{var controlparameters={"to":to,"random":random,"chatroommode":chatroommode};jqcc.ccwhiteboard.accept(controlparameters);}});});(function($){$.ccfiletransfer=(function(){var title='Send a file';return{getTitle:function(){return title;},init:function(params){var id=params.to;var chatroommode=params.chatroommode;var roomname=params.roomname;var caller='';if(typeof(params.caller)!="undefined"){caller=params.caller;}
var windowMode=0;if(typeof(params.windowMode)=="undefined"){windowMode=0;}else{windowMode=1;}
if(chatroommode==1){var baseUrl=$.cometchat.getBaseUrl();var basedata=$.cometchat.getBaseData();loadCCPopup(baseUrl+'plugins/filetransfer/index.php?chatroommode=1&caller='+caller+'&id='+id+'&basedata='+basedata+'&sendername='+roomname,'filetransfer',"status=0,toolbar=0,menubar=0,directories=0,resizable=0,location=0,status=0,scrollbars=0, width=400,height=140",400,130,'Which file would you like to send?',null,null,null,null,windowMode);}else{var baseUrl=$.cometchat.getBaseUrl();var baseData=$.cometchat.getBaseData();loadCCPopup(baseUrl+'plugins/filetransfer/index.php?id='+id+'&caller='+caller+'&basedata='+baseData+'&sendername='+jqcc.cometchat.getName(jqcc.cometchat.getThemeVariable('userid')),'filetransfer',"status=0,toolbar=0,menubar=0,directories=0,resizable=0,location=0,status=0,scrollbars=0, width=400,height=140",400,130,'Which file would you like to send?',null,null,null,null,windowMode);}},viewMedia:function(params){var baseUrl=$.cometchat.getBaseUrl();var mediaContentData='';if(params.mediatype==1){mediaContentData='<img class="cometchat_filetransfer_data cometchat_filetransfer_image" md5fileName="'+params.md5file+'" fileName="'+params.file+'" src= "'+baseUrl+'plugins/filetransfer/uploads/'+params.md5file+'">';}else if(params.mediatype==2){mediaContentData='<video class="cometchat_filetransfer_data" width="360" height="260" md5fileName="'+params.md5file+'" fileName="'+params.file+'" controls autoplay><source src="'+baseUrl+'plugins/filetransfer/uploads/'+params.md5file+'" ></video>';}else if(params.mediatype==3){mediaContentData='<audio class="cometchat_filetransfer_data" md5fileName="'+params.md5file+'" fileName="'+params.file+'" controls><source src="'+baseUrl+'plugins/filetransfer/uploads/'+params.md5file+'"></audio>';}
jqcc('body').find('.cometchat_media_container').append(mediaContentData);$('.cometchat_filetransfer_modal div').css('visibility','visible');$('.cometchat_filetransfer_overlay').addClass('cometchat_filetransfer_overlay_show');}};})();})(jqcc);jqcc(document).ready(function(){var baseUrl='';var intervalCount=0;var fileTransferinterval=setInterval(function(){if(typeof(jqcc.cometchat.getBaseUrl)=='function'){baseUrl=jqcc.cometchat.getBaseUrl();var overlay='<div class="cometchat_filetransfer_overlay"><div class="cometchat_filetransfer_modal"><div><div><img class="cometchat_filetransfer_download" src="'+baseUrl+'images/download.png" title="Download"><img class="close_dialog" src="'+baseUrl+'images/close.png" title="Close"></div><div class="cometchat_filetransfer_content"><div class="cometchat_media_container"></div></div></div></div></div>';if(jqcc('#cometchat').length>=1&&jqcc('#cometchat').find('.cometchat_filetransfer_overlay').length<=0){jqcc('#cometchat').append(overlay);}else if(jqcc('#cometchat').length==0&&jqcc('body').find('.cometchat_filetransfer_overlay').length<=0){jqcc('body').append(overlay);}}
if(++intervalCount===5||typeof(jqcc.cometchat.getBaseUrl)=='function'){window.clearInterval(fileTransferinterval);}},1000);jqcc('.cometchat_filetransfer_download').live('click',function(){var file=jqcc('.cometchat_filetransfer_data').attr('fileName');var md5file=jqcc('.cometchat_filetransfer_data').attr('md5fileName');location.href=baseUrl+"plugins/filetransfer/download.php?file="+md5file+"&unencryptedfilename="+file+"";});jqcc('.close_dialog').live('click',function(){jqcc('.cometchat_filetransfer_modal div').css('visibility','hidden');jqcc('.cometchat_filetransfer_overlay').removeClass('cometchat_filetransfer_overlay_show');jqcc('body').find('.cometchat_media_container').html('');});jqcc('.mediamessage').live('click',function(e){e.preventDefault();var file=jqcc(this).attr('filename');var md5file=jqcc(this).attr('encfilename');var mediatype=jqcc(this).attr('mediatype');if((typeof(parent)!='undefined'&&parent!=null&&parent!=self)||window.top!=window.self){var controlparameters={"type":"plugins","name":"ccfiletransfer","method":"viewMedia","params":{"file":file,"md5file":md5file,"mediatype":mediatype}};controlparameters=JSON.stringify(controlparameters);parent.postMessage('CC^CONTROL_'+controlparameters,'*');}else{var controlparameters={"file":file,"md5file":md5file,"mediatype":mediatype};jqcc.ccfiletransfer.viewMedia(controlparameters);}});});(function($){$.ccclearconversation=(function(){var title='Clear conversation';var type='0';return{getTitle:function(){return title;},init:function(params){var id=params.to;var chatroommode=params.chatroommode;if(chatroommode==1){if($("#currentroom_convotext").html()!=''){baseUrl=$.cometchat.getBaseUrl();basedata=$.cometchat.getBaseData();var currentroom=params.roomid;$.getJSON(baseUrl+'plugins/clearconversation/index.php?action=clear&basedata='+basedata+'&chatroommode=1&callback=?',{clearid:currentroom});$("#currentroom_convotext").html('');}}else{var settings=jqcc.cometchat.getSettings();if($("#cometchat_user_"+id+"_popup").find("div.cometchat_tabcontenttext").html()!=''){baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();if(type==0&&settings.theme!='tapatalk'){$.getJSON(baseUrl+'plugins/clearconversation/index.php?action=clear&callback=?',{clearid:id,basedata:baseData});}else{$.ajax({url:baseUrl+'plugins/clearconversation/index.php?action=delete&callback=?',data:{deleteid:id,basedata:baseData},dataType:'jsonp',type:'get',timeout:'10000'});}
if($("#cometchat_user_"+id+"_popup").find("div.cometchat_tabcontenttext > div.cometchat_chatboxmessage").length==0){$("#cometchat_user_"+id+"_popup").find("div.cometchat_tabcontenttext > div.cometchat_message_container > div.cometchat_messagebox").remove();}else{$("#cometchat_user_"+id+"_popup").find("div.cometchat_tabcontenttext > div.cometchat_chatboxmessage").remove();$("#cometchat_user_"+id+"_popup").find("div.cometchat_tabcontenttext > table.cometchat_iphone").remove();}}}}};})();})(jqcc);(function($){$.ccsave=(function(){var title='Save Conversation to Desktop';return{getTitle:function(){return title;},init:function(params){var id=params.to;var chatroommode=params.chatroommode;var currentTime=new Date();var monthNames=["Jan","Feb","Mar","Apr","May","Jun","July","Aug","Sep","Oct","Nov","Dec"];var month=currentTime.getMonth();var day=currentTime.getDate();var year=currentTime.getFullYear();var type='th';if(day==1||day==21||day==31){type='st';}else if(day==2||day==22){type='nd';}else if(day==3||day==23){type='rd';}
var today=monthNames[month]+" "+day+type+" "+year;baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();if(chatroommode==1){var roomname=params.roomname;if($("#currentroom_convotext").html()!=''){var filename='Conversation in '+roomname+' chatroom on '+today;$("#currentroom").find("span.cometchat_chatboxmessagefrom").before('<div class="cc_newline" style="display:none;">\n<\div>');$('div.cometchat_chatboxmessage').find('img.cometchat_smiley').each(function(key,value){$(this).before('<div class="cc_newline_smile"  style="display:none">('+$(this).attr('title')+')<\div>');});var content=$("#currentroom_convotext").find(".cometchat_chatboxmessage").text();var deletemsg='delete';deletemsg="\\("+deletemsg+"\\)";content=content.replace(new RegExp(deletemsg,"g"),"");$('div.cc_newline').remove();$('div.cc_newline_smile').remove();$('#cc_saveconvochatroom').remove();setTimeout(function(){$('<form id = "ccsaveform" action="" method="post">'+'<input type="hidden" name="roomname" />'+'<input type="hidden" name="content" />'+'<input type="hidden" name="filename" />'+'</form>').appendTo('body');var form=$('#ccsaveform');form.attr('action',baseUrl+'plugins/save/index.php?id='+roomname+'&basedata='+baseData);form.find('input[name=roomname]').val(roomname);form.find('input[name=content]').val(content);form.find('input[name=filename]').val(filename);form.submit();},50);}else{alert('Sorry, your conversation log is empty.');}}else{var cometchat_user_popup=$("#cometchat_user_"+id+"_popup");if(cometchat_user_popup.find("div.cometchat_tabcontenttext").html()!=''){var username=$.cometchat.getName(id);var filename='Conversation with '+username+' on '+today;var settings=jqcc.cometchat.getSettings();if(settings.theme=='glass'){var other=cometchat_user_popup.find("div.cometchat_name").text();$('div.cometchat_chatboxmessage').find("img.cometchat_smiley").each(function(key,value){$(this).before('<div class="cc_newline_smile"  style="display:none">('+$(this).attr('title')+')</div>');});cometchat_user_popup.find("div.cometchat_chatboxmessage").not(".cometchat_self").before('<div class="cc_newline"  style="display:none">\n'+other+': </div>');cometchat_user_popup.find("div.cometchat_chatboxmessage.cometchat_self").before('<div class="cc_newline"  style="display:none">\nMe: </div>');var content=cometchat_user_popup.find(".cometchat_tabcontenttext").text().trim();var loadEarMsg='Load Earlier Messages...';content=content.replace(new RegExp(loadEarMsg,"g"),"");var newMsg='No more messages';content=content.replace(new RegExp(newMsg,"g"),"");$('div.cc_newline').remove();$('div.cc_newline_smile').remove();$('iframe.cc_saveconvoframe').remove();$('#cc_saveconvochatroom').remove();}else if(settings.theme=='hangout'){var other=cometchat_user_popup.find("div.cometchat_name").text();cometchat_user_popup.find("div.cometchat_other").before('<div class="cc_newline"  style="display:none">\n'+other+': <\div>');cometchat_user_popup.find("div.cometchat_self").before('<div class="cc_newline"  style="display:none">\nMe: <\div>');$('div.cometchat_other').find("img.cometchat_smiley").each(function(key,value){$(this).before('<div class="cc_newline_smile"  style="display:none">('+$(this).attr('title')+')</div>');});$('div.cometchat_self').find("img.cometchat_smiley").each(function(key,value){$(this).before('<div class="cc_newline_smile"  style="display:none">('+$(this).attr('title')+')</div>');});var content='';cometchat_user_popup.find('.cometchat_chatboxmessage').each(function(i,d){time=$(d).find('.cometchat_ts').text();var me=$(d).find('.cc_newline').text().split('\n')[1];var innerconent='';$(d).find('.cometchat_chatboxmessagecontent > .cometchat_other').each(function(j,data){content+='\n'+me+' '+$(data).text()+' ('+time+')';});$(d).find('.cometchat_chatboxmessagecontent > .cometchat_self').each(function(j,data){content+='\n'+me+' '+$(data).text()+' ('+time+')';});});$('.cc_newline').remove();$('.cc_newline_smile').remove();$('.cc_saveconvoframe').remove();$('#cc_saveconvochatroom').remove();}else if(settings.theme=='facebook'){var other=cometchat_user_popup.find(".cometchat_name").text();cometchat_user_popup.find(".cometchat_chatboxmessage a.cometchat_floatL").before('<div class="cc_newline"  style="display:none">\n'+other+': <\div>');cometchat_user_popup.find(".cometchat_chatboxmessage .cometchat_floatR").before('<div class="cc_newline"  style="display:none">\nMe: <\div>');$('.cometchat_chatboxmessage .cometchat_floatL').find("img.cometchat_smiley").each(function(key,value){$(this).before('<div class="cc_newline_smile"  style="display:none">('+$(this).attr('title')+')</div>');});$('.cometchat_chatboxmessage .cometchat_floatR').find("img.cometchat_smiley").each(function(key,value){$(this).before('<div class="cc_newline_smile"  style="display:none">('+$(this).attr('title')+')</div>');});var content=cometchat_user_popup.find("div.cometchat_tabcontenttext").find('div.cometchat_chatboxmessage').text().trim();$('.cc_newline').remove();$('.cc_newline_smile').remove();$('.cc_saveconvoframe').remove();$('#cc_saveconvochatroom').remove();}else if(settings.theme=='synergy'){var other=$('.cometchat_tabopen > .cometchat_tabsubtitle > .cometchat_chatboxLeftDetails > .cometchat_chatboxDisplayDetails').find(".cometchat_userdisplayname").text();cometchat_user_popup.find("div.cometchat_chatboxmessage").not(".cometchat_self").before('<div class="cc_newline"  style="display:none">\n'+other+': </div>');cometchat_user_popup.find("div.cometchat_chatboxmessage.cometchat_self").before('<div class="cc_newline"  style="display:none">\nMe: </div>');$("div.cometchat_chatboxmessage").not(".cometchat_self").find("img.cometchat_smiley").each(function(key,value){$(this).before('<div class="cc_newline_smile"  style="display:none">('+$(this).attr('title')+')</div>');});$("div.cometchat_chatboxmessage.cometchat_self").find("img.cometchat_smiley").each(function(key,value){$(this).before('<div class="cc_newline_smile"  style="display:none">('+$(this).attr('title')+')</div>');});var content='';cometchat_user_popup.find('.cometchat_messagebox').each(function(i,d){time=$(d).find('.cometchat_ts').text();var me=$(d).find('.cc_newline').text();var text=$(d).find('.cometchat_chatboxmessage').text();content+=me+' '+text+' ('+time+')';});$('.cc_newline').remove();$('.cc_newline_smile').remove();$('.cc_saveconvoframe').remove();$('#cc_saveconvochatroom').remove();if(content==''){alert('Sorry, your conversation log is empty.');return;}}else{cometchat_user_popup.find("div.cometchat_chatboxmessage").before('<div class="cc_newline">\n</div>');$('div.cometchat_chatboxmessage').find("img.cometchat_smiley").each(function(key,value){$(this).before('<div class="cc_newline_smile"  style="display:none">('+$(this).attr('title')+')</div>');});var content=cometchat_user_popup.find(".cometchat_tabcontenttext").text().trim();var loadEarMsg='Load Earlier Messages...';content=content.replace(new RegExp(loadEarMsg,"g"),"");var newMsg='No more messages';content=content.replace(new RegExp(newMsg,"g"),"");$('div.cc_newline').remove();$('div.cc_newline_smile').remove();$('iframe.cc_saveconvoframe').remove();$('#cc_saveconvochatroom').remove();}
var iframe=$('<iframe id="cc_saveconvoframe'+id+'" class="cc_saveconvoframe" frameborder="0" style="width: 1px; height: 1px; display: none;"></iframe>').appendTo('body');setTimeout(function(){var formHTML='<form action="" method="post">'+'<input type="hidden" name="username" />'+'<input type="hidden" name="content" />'+'<input type="hidden" name="filename" />'+'</form>';var body=(iframe.prop('contentDocument')!==undefined)?iframe.prop('contentDocument').body:iframe.prop('document').body;body=$(body);body.html(formHTML);var form=body.find('form');form.attr('action',baseUrl+'plugins/save/index.php?id='+id+'&basedata='+baseData);form.find('input[name=username]').val(username);form.find('input[name=content]').val(content);form.find('input[name=filename]').val(filename);form.submit();},50);}else{alert('Sorry, your conversation log is empty.');}}}};})();})(jqcc);(function($){$.ccgames=(function(){var title='Play a game';var lastcall=0;return{getTitle:function(){return title;},init:function(params){var id=params.to;var chatroommode=params.chatroommode;var windowMode=0;if(typeof(params.windowMode)=="undefined"){windowMode=0;}else{windowMode=1;}
baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();loadCCPopup(baseUrl+'plugins/games/index.php?id='+id+'&basedata='+baseData,'games_init',"status=0,toolbar=0,menubar=0,directories=0,resizable=0,location=0,status=0,scrollbars=0, width=440,height=260",430,205,'Which game would you like to play?',null,null,null,null,windowMode);},accept:function(params){id=params.to;fid=params.rFrom;tid=params.rTo;rid=params.rOrder;gameId=params.gameId;gameWidth=params.gameWidth;var windowMode=0;if(typeof(params.windowMode)=="undefined"){windowMode=0;}else{windowMode=1;}
baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();$.getJSON(baseUrl+'plugins/games/index.php?action=accept&callback=?',{to:id,fid:fid,tid:tid,rid:rid,gameId:gameId,gameWidth:gameWidth,basedata:baseData});loadCCPopup(baseUrl+'plugins/games/index.php?action=play&fid='+fid+'&tid='+tid+'&rid='+rid+'&gameId='+gameId+'&basedata='+baseData,'games'+fid+''+tid,"status=0,toolbar=0,menubar=0,directories=0,resizable=0,location=0,status=0,scrollbars=0, width="+(gameWidth-30)+",height=600",gameWidth-28,600,'Playing Game!',1,null,null,null,windowMode);},accept_fid:function(params){id=params.to;fid=params.rFrom;tid=params.rTo;rid=params.rOrder;gameId=params.gameId;gameWidth=params.gameWidth;var windowMode=0;if(typeof(params.windowMode)=="undefined"){windowMode=0;}else{windowMode=1;}
baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();loadCCPopup(baseUrl+'plugins/games/index.php?action=play&fid='+fid+'&tid='+tid+'&rid='+rid+'&gameId='+gameId+'&basedata='+baseData,'games'+fid+''+tid,"status=0,toolbar=0,menubar=0,directories=0,resizable=0,location=0,status=0,scrollbars=0, width="+(gameWidth-30)+",height=600",gameWidth-28,600,'Playing Game!',1,null,null,null,windowMode);}};})();})(jqcc);jqcc(document).ready(function(){jqcc('.gameAccept').live('click',function(){var to=jqcc(this).attr('to');var rFrom=jqcc(this).attr('rFrom');var rTo=jqcc(this).attr('rTo');var rOrder=jqcc(this).attr('rOrder');var gameId=jqcc(this).attr('gameId');var gameWidth=jqcc(this).attr('gameWidth');if(typeof(parent)!='undefined'&&parent!=null&&parent!=self){var controlparameters={"type":"plugins","name":"ccgames","method":"accept","params":{"to":to,"rFrom":rFrom,"rTo":rTo,"rOrder":rOrder,"gameId":gameId,"gameWidth":gameWidth}};controlparameters=JSON.stringify(controlparameters);if(typeof(parent)!='undefined'&&parent!=null&&parent!=self){parent.postMessage('CC^CONTROL_'+controlparameters,'*');}else{window.opener.postMessage('CC^CONTROL_'+controlparameters,'*');}}else{var controlparameters={"to":to,"rFrom":rFrom,"rTo":rTo,"rOrder":rOrder,"gameId":gameId,"gameWidth":gameWidth};jqcc.ccgames.accept(controlparameters);}});jqcc('.gameAccept_fid').live('click',function(){var to=jqcc(this).attr('to');var rFrom=jqcc(this).attr('rFrom');var rTo=jqcc(this).attr('rTo');var rOrder=jqcc(this).attr('rOrder');var gameId=jqcc(this).attr('gameId');var gameWidth=jqcc(this).attr('gameWidth');if(typeof(parent)!='undefined'&&parent!=null&&parent!=self){var controlparameters={"type":"plugins","name":"ccgames","method":"accept_fid","params":{"to":to,"rFrom":rFrom,"rTo":rTo,"rOrder":rOrder,"gameId":gameId,"gameWidth":gameWidth}};controlparameters=JSON.stringify(controlparameters);if(typeof(parent)!='undefined'&&parent!=null&&parent!=self){parent.postMessage('CC^CONTROL_'+controlparameters,'*');}else{window.opener.postMessage('CC^CONTROL_'+controlparameters,'*');}}else{var controlparameters={"to":to,"rFrom":rFrom,"rTo":rTo,"rOrder":rOrder,"gameId":gameId,"gameWidth":gameWidth};jqcc.ccgames.accept_fid(controlparameters);}});});(function($){$.ccstickers=(function(){var title='Send a sticker';var height=350;var width=420;return{getTitle:function(){return title;},init:function(params){var id=params.to;var chatroommode=params.chatroommode;var caller='';var windowMode=0;var baseUrl=$.cometchat.getBaseUrl();var baseData=$.cometchat.getBaseData();if(typeof(params.windowMode)=="undefined"){windowMode=0;}else{windowMode=1;}
if(typeof(params.caller)!="undefined"){caller=params.caller;}
if(chatroommode==1){loadCCPopup(baseUrl+'plugins/stickers/index.php?chatroommode=1&id='+id+'&basedata='+baseData+'&caller='+caller,'stickers',"status=0,toolbar=0,menubar=0,directories=0,resizable=0,location=0,status=0,scrollbars=0,width="+width+",height="+height,width,height,'Which sticker would you like?',null,null,null,null,windowMode);}else{loadCCPopup(baseUrl+'plugins/stickers/index.php?id='+id+'&basedata='+baseData+'&caller='+caller,'stickers',"status=0,toolbar=0,menubar=0,directories=0,resizable=0,location=0,status=0,scrollbars=0, width="+width+",height="+height,width,height,'Which sticker would you like?',null,null,null,null,windowMode);}},sendStickerMessage:function(params){var baseUrl=$.cometchat.getBaseUrl();var baseData=$.cometchat.getBaseData();var to=params.to;var key=params.key;var chatroommode=params.chatroommode;var category=params.category;var caller=params.caller;var calleeAPI='glass';$.ajax({url:baseUrl+'plugins/stickers/index.php?action=sendSticker&callback=?',type:'GET',data:{to:to,key:key,basedata:baseData,chatroommode:chatroommode,category:category,caller:caller},dataType:'jsonp',success:function(data){if(data!=null&&typeof(data)!='undefined'){if(chatroommode==1){if(typeof(jqcc[calleeAPI].addChatroomMessage)!=='undefined'){jqcc[calleeAPI].addChatroomMessage(jqcc.cometchat.getChatroomVars('myid'),data.m,data.id,1,Math.floor(new Date().getTime()),'0');}}else{jqcc.cometchat.chatWith(to);var controlparameters={"type":"plugins","name":"ccstickers","method":"appendStickerMessage","params":{"to":to,"data":data,"chatroommode":chatroommode,"caller":caller}};controlparameters=JSON.stringify(controlparameters);if(typeof(window.opener)=='undefined'||window.opener==null){parent.postMessage('CC^CONTROL_'+controlparameters,'*');}else{window.opener.postMessage('CC^CONTROL_'+controlparameters,'*');}}}},error:function(data){}});},appendStickerMessage:function(controlparameters){var to=controlparameters.to;var data=controlparameters.data;var chatroommode=controlparameters.chatroommode;var calleeAPI='glass';if(chatroommode==1){if(typeof(jqcc[calleeAPI].addChatroomMessage)!=='undefined'){jqcc[calleeAPI].addChatroomMessage(jqcc.cometchat.getChatroomVars('myid'),data.m,data.id,1,Math.floor(new Date().getTime()),'0');}}else{if(typeof(jqcc[calleeAPI].addMessages)!=='undefined'){jqcc[calleeAPI].addMessages([{"from":to,"message":data.m,"id":data.id,"broadcast":0}]);}}},processControlMessage:function(controlparameters){var baseUrl=$.cometchat.getBaseUrl();var category=controlparameters.category;var imageName=controlparameters.key+'.png';var message="<img class=\"cometchat_stickerImage\" type=\"image\" src=\""+baseUrl+"plugins/stickers/images/"+category+"/"+imageName+"\" />";return message;}};})();})(jqcc);(function($){$.cchandwrite=(function(){var title='Handwrite a message';return{getTitle:function(){return title;},init:function(params){var id=params.to;var chatroommode=params.chatroommode;var roomname=params.roomname;var windowMode=0;if(typeof(params.windowMode)=="undefined"){windowMode=0;}else{windowMode=1;}
if(chatroommode==1){baseUrl=$.cometchat.getBaseUrl();basedata=$.cometchat.getBaseData();loadCCPopup(baseUrl+'plugins/handwrite/index.php?chatroommode=1&id='+id+'&basedata='+basedata+'&sendername='+roomname,'handwrite',"status=0,toolbar=0,menubar=0,directories=0,resizable=1,location=0,status=0,scrollbars=0, width=330,height=250",330,250,'Handwrite a message',0,1,1,1,windowMode);}else{baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();loadCCPopup(baseUrl+'plugins/handwrite/index.php?id='+id+'&basedata='+baseData+'&sendername='+jqcc.cometchat.getName(jqcc.cometchat.getThemeVariable('userid')),'handwrite',"status=0,toolbar=0,menubar=0,directories=0,resizable=1,location=0,status=0,scrollbars=0, width=330,height=250",330,250,'Handwrite a message',0,1,1,1,windowMode);}}};})();})(jqcc);String.prototype.replaceAll=function(s1,s2){return this.split(s1).join(s2)};(function($){$.ccavchat=(function(){var title='Start an audio/video call';var type='6';var supported=true;var Browser=(function(){var ua=navigator.userAgent,tem,M=ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(M[1])){tem=/\brv[ :]+(\d+)/g.exec(ua)||[];return'IE '+(tem[1]||'');}
if(M[1]==='Chrome'){tem=ua.match(/\bOPR\/(\d+)/)
if(tem!=null)return'Opera '+tem[1];}
M=M[2]?[M[1],M[2]]:[navigator.appName,navigator.appVersion,'-?'];if((tem=ua.match(/version\/(\d+)/i))!=null)M.splice(1,1,tem[1]);return M;})();if(Browser[0]=='MSIE'&&parseInt(Browser[1])<11){supported=false;}
var lastcall=0;if(type==3){allowresize=0}else{allowresize=1}
return{getTitle:function(){return title;},init:function(params){var id=params.to;var chatroommode=params.chatroommode;var caller='';if(typeof(caller)!="undefined"){caller=params.caller;}
var windowMode=0;if(typeof(params.windowMode)=="undefined"){windowMode=0;}else{windowMode=1;}
if(supported){var currenttime=new Date();currenttime=parseInt(currenttime.getTime()/1000);if(currenttime-lastcall>10){baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();if(chatroommode==1){if(type=='5'){$.ajax({url:baseUrl+'plugins/avchat/index.php?chatroommode=1&action=request&callback=?',type:'GET',data:{to:id,basedata:baseData,caller:caller},dataType:'jsonp',success:function(data){var flag=data.split('^');if(flag[0]=='1'){alert('Please check your email for verification zoom account at '+flag[1]);}},error:function(data){}});}else{if(location.protocol==='http:'){windowMode=1;}
jqcc.ajax({url:baseUrl+'plugins/avchat/index.php?chatroommode=1&action=request',type:'GET',data:{to:id,basedata:baseData,caller:caller},dataType:'jsonp',success:function(data){if(typeof(data)!="undefined"&&data!=null&&data!=''){id=data;}
loadCCPopup(baseUrl+'plugins/avchat/index.php?action=call&caller='+caller+'&chatroommode=1&grp='+id+'&basedata='+baseData,'audiovideochat',"status=0,toolbar=0,menubar=0,directories=0,resizable=1,location=0,status=0,scrollbars=0, width=434,height=356",434,356,'Audio/Video Chat',1,1,allowresize,1,windowMode);},error:function(data){}});}}else{jqcc.ajax({url:baseUrl+'plugins/avchat/index.php?action=request',type:'GET',data:{to:id,basedata:baseData,caller:caller},dataType:'jsonp',success:function(data){},error:function(data){}});if(jqcc.cometchat.getThemeArray('buddylistIsDevice',id)==1){jqcc.ccmobilenativeapp.sendnotification('has successfully sent an audio/video chat request.',id,jqcc.cometchat.getName(jqcc.cometchat.getThemeVariable('userid')));}}
lastcall=currenttime;}else{alert('Please wait atleast 10 seconds before trying to call again.');}}else{alert('Sorry, your browser does not support this feature. Please upgrade your browser to the latest version or try a different browser.');}},accept:function(params){id=params.to;grp=params.grp;join_url=params.join_url;start_url=params.start_url;chatroommode=params.chatroommode;var caller='';if(typeof(params.caller)!="undefined"){caller=params.caller;}
if(supported){baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();windowMode=0;if(location.protocol==='http:'){windowMode=1;console.log("first"+windowMode);}
jqcc.ccavchat.delinkAvchat(grp);if(chatroommode==1){if(typeof(params.windowMode)=="undefined"){windowMode=0;}else{windowMode=1;}
if(location.protocol==='http:'){windowMode=1;}
if(type=='5'){$.ajax({url:baseUrl+'plugins/avchat/index.php?chatroommode=1&action=accept&callback=?',type:'GET',data:{to:id,basedata:baseData,caller:caller},dataType:'text',success:function(data){var flag=data.split('^');if(flag[0]=='1'){alert('Please check your email for verification zoom account at '+flag[1]);}},error:function(data){}});}else{$.getJSON(baseUrl+'plugins/avchat/index.php?chatroommode=1&action=accept&callback=?',{to:id,start_url:start_url,grp:grp,basedata:baseData,caller:caller});}}else{$.getJSON(baseUrl+'plugins/avchat/index.php?action=accept&callback=?',{to:id,start_url:start_url,grp:grp,basedata:baseData,caller:caller});}
if(type=="5"){window.open(join_url,'audiovideochat','width=440,height=330, scrollbars=yes, resizable=yes');}else{if(jqcc.cometchat.getCcvariable().callbackfn=='desktop'){loadCCPopup(baseUrl+'plugins/avchat/index.php?action=call&grp='+grp+'&basedata='+baseData+'&to='+id,'audiovideochat',"status=0,toolbar=0,menubar=0,directories=0,resizable=1,location=0,status=0,scrollbars=0, width=440,height=330",440,330,'Audio/Video Chat',0,1,allowresize,1,windowMode);}else{loadCCPopup(baseUrl+'plugins/avchat/index.php?action=call&caller='+caller+'&grp='+grp+'&basedata='+baseData+'&to='+id,'audiovideochat',"status=0,toolbar=0,menubar=0,directories=0,resizable=1,location=0,status=0,scrollbars=0, width=440,height=330",440,330,'Audio/Video Chat',0,1,allowresize,null,windowMode);}}}else{alert('Sorry, your browser does not support this feature. Please upgrade your browser to the latest version or try a different browser.');}},accept_fid:function(params){id=params.to;grp=params.grp;start_url=params.start_url;var caller='';if(typeof(params.caller)!="undefined"){caller=params.caller;}
if(location.protocol==='http:'){windowMode=1;}
jqcc.ccavchat.delinkAvchat(grp);baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();if(type=="5"){window.open(start_url,'audiovideochat','width=440,height=330,scrollbars=yes, resizable=yes');}else{if(jqcc.cometchat.getCcvariable().callbackfn=='desktop'){loadCCPopup(baseUrl+'plugins/avchat/index.php?action=call&grp='+grp+'&basedata='+baseData+'&to='+id,'audiovideochat',"status=0,toolbar=0,menubar=0,directories=0,resizable=1,location=0,status=0,scrollbars=0, width=440,height=330",440,330,'Audio/Video Chat',0,1,allowresize,1,1);}else{loadCCPopup(baseUrl+'plugins/avchat/index.php?action=call&caller='+caller+'&grp='+grp+'&basedata='+baseData+'&to='+id,'audiovideochat',"status=0,toolbar=0,menubar=0,directories=0,resizable=1,location=0,status=0,scrollbars=0, width=440,height=330",440,330,'Audio/Video Chat',0,1,allowresize,1,windowMode);}}},ignore_call:function(id,grp){basedata=$.cometchat.getBaseData();baseUrl=$.cometchat.getBaseUrl();$.ajax({url:baseUrl+'plugins/avchat/index.php?action=noanswer',type:'GET',data:{to:id,grp:grp,basedata:basedata},dataType:'jsonp',success:function(data){},error:function(data){console.log('Something went wrong');}});},cancel_call:function(id,grp){baseUrl=$.cometchat.getBaseUrl();basedata=$.cometchat.getBaseData();jqcc.ccavchat.delinkAvchat(grp);$.ajax({url:baseUrl+'plugins/avchat/index.php?action=canceloutgoingcall',type:'GET',data:{to:id,grp:grp,basedata:basedata},dataType:'jsonp',success:function(data){},error:function(data){console.log('Something went wrong');}});},reject_call:function(id,grp){baseUrl=$.cometchat.getBaseUrl();jqcc.ccavchat.delinkAvchat(grp);basedata=$.cometchat.getBaseData();jqcc.ajax({url:baseUrl+'plugins/avchat/index.php?action=rejectcall',type:'GET',data:{to:id,grp:grp,basedata:basedata},dataType:'jsonp',success:function(data){},error:function(data){console.log('Something went wrong');}});},end_call:function(params){var id=params.to;var grp=params.grp;baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();if((jqcc.cometchat.getInternalVariable('endcallOnceWindow_'+grp)!=='1'&&jqcc.cometchat.getInternalVariable('endcallOnce_'+grp)!=='1')){var popoutopencalled=jqcc.cometchat.getInternalVariable('avchatpopoutcalled');var endcallrecieved=jqcc.cometchat.getInternalVariable('endcallrecievedfrom_'+grp);if(popoutopencalled!=='1'){if(endcallrecieved!=='1'){$.ajax({url:baseUrl+'plugins/avchat/index.php?action=endcall',type:'GET',data:{to:id,basedata:baseData,grp:grp},dataType:'jsonp',success:function(data){},error:function(data){console.log('Something went wrong');}});}}
jqcc.cometchat.setInternalVariable('endcallrecievedfrom_'+grp,'0');jqcc.cometchat.setInternalVariable('avchatpopoutcalled','0');}},join:function(params){var id=params.to;if(type=='6'){id=params.grp;}
windowMode=0;var caller='';if(typeof(params.caller)!="undefined"){caller=params.caller;}
if(typeof(params.windowMode)=="undefined"){windowMode=0;}else{windowMode=1;}
if(location.protocol==='http:'){windowMode=1;}
baseUrl=$.cometchat.getBaseUrl();basedata=$.cometchat.getBaseData();loadCCPopup(baseUrl+'plugins/avchat/index.php?action=call&chatroommode=1&caller='+caller+'&type=0&join=1&grp='+id+'&basedata='+basedata,'audiovideochat',"status=0,toolbar=0,menubar=0,directories=0,resizable=1,location=0,status=0,scrollbars=0, width=440,height=330",440,330,'Audio/Video Chat',1,1,allowresize,1,windowMode);},getLangVariables:function(){return["Start an audio\/video call","Please wait atleast 10 seconds before trying to call again.","has sent you an audio\/video chat request.","Click here to accept it","or simply ignore this message.","has successfully sent an audio\/video chat request.","has accepted your audio\/video chat request.","Click here to launch the AV window","Audio\/Video Chat","Having issues connecting?","There are several reasons why the audio\/video chat may be stuck at initializing:\n<br\/><br\/>\n1. Audio\/video chat requires P2P to establish connection. In order for it to work, your firewall must be configured to allow outgoing UDP traffic. While this is the case with most consumer or small office\/home office (SOHO) firewalls, many corporate firewalls block UDP traffic altogether.\n<br\/><br\/>\n2. The user at the other end is behind a UDP blocking firewall and is unable to connect to you.\n<br\/><br\/>\n3. Our servers are facing issues and you are unable to connect.\n","Closing window shortly","Users have been successfully invited. You can safely close this window.","Users Invited Successfully!","has invited you to join a video conference.","Click here to join","Please select users","Invite Users","Invite Users","has started a video conversation.","Click here to join the conversation.","Settings","Done","Play test sound","Install plug-in","Sorry, there are no users available at the moment to invite.","Click here to open it","Please check your email for verification zoom account at","Call","Call from","Call to","Call ended, duration","rejected","No answer from","Cancelled","Would you like to call","busy","This call has been cancelled","This call has ended","The user is busy right now. Please try again later","The user is not answering the call right now. Please try again later","Sorry, we are unable to send this message.","Sorry, your device does not support this feature.","click here","To cancel outgoing call ","To reject call ","You can also simply ignore this message.","The plugin has not been configured correctly. Please contact the site owner.","Sorry, your browser does not support this feature. Please upgrade your browser to the latest version or try a different browser.","End Call","Turn On Video","Turn Off Video","Turn On Mic","Turn Off Mic","is busy right now. Please try again later","is trying to call you. You can end the current call and send him a request."];},delinkAvchat:function(grp){$('a.avchat_link_'+grp).each(function(){$(this).attr('onclick','').unbind('click');$(this).removeClass('acceptAVChat accept_AVfid');this.style.setProperty('text-decoration','line-through','important');$(this).css('cursor','text');});},processControlMessage:function(controlparameters){var avchat_language=jqcc.ccavchat.getLangVariables();var processedmessage=null;jqcc.ccavchat.delinkAvchat(controlparameters.params);switch(controlparameters.method){case'endcall':jqcc.cometchat.setInternalVariable('endcallrecievedfrom_'+controlparameters.params.grp,'1');processedmessage=avchat_language[38];break;case'rejectcall':processedmessage=avchat_language[39];break;case'noanswer':processedmessage=avchat_language[40];break;case'busycall':processedmessage=avchat_language[39];break;case'canceloutgoingcall':processedmessage=avchat_language[37];break;default:processedmessage=null;break;}
return processedmessage;}};})();})(jqcc);jqcc(document).ready(function(){jqcc('.join_Avchat').live('click',function(){var to=jqcc(this).attr('to');var grp=jqcc(this).attr('grp');var caller=jqcc(this).attr('caller');if(typeof(parent)!='undefined'&&parent!=null&&parent!=self){var controlparameters={"type":"plugins","name":"ccavchat","method":"join","params":{"to":to,"caller":caller,"grp":grp}};controlparameters=JSON.stringify(controlparameters);if(typeof(parent)!='undefined'&&parent!=null&&parent!=self){parent.postMessage('CC^CONTROL_'+controlparameters,'*');}else{window.opener.postMessage('CC^CONTROL_'+controlparameters,'*');}}else{var controlparameters={"to":to,"grp":grp};jqcc.ccavchat.join(controlparameters);}});jqcc('.acceptAVChat').live('click',function(){var to=jqcc(this).attr('to');var grp=jqcc(this).attr('grp');var join_url=jqcc(this).attr('join_url');var start_url=jqcc(this).attr('start_url');var chatroommode=jqcc(this).attr('chatroommode');var caller=jqcc(this).attr('caller');if((typeof(parent)!='undefined'&&parent!=null&&parent!=self)||window.top!=window.self){var controlparameters={"type":"plugins","name":"ccavchat","method":"accept","params":{"to":to,"grp":grp,"join_url":join_url,"start_url":start_url,"caller":caller,"chatroommode":chatroommode}};controlparameters=JSON.stringify(controlparameters);parent.postMessage('CC^CONTROL_'+controlparameters,'*');}else{var controlparameters={"to":to,"grp":grp,"join_url":join_url,"start_url":start_url,"chatroommode":chatroommode};jqcc.ccavchat.accept(controlparameters);}});jqcc('.accept_AVfid').live('click',function(){var to=jqcc(this).attr('to');var grp=jqcc(this).attr('grp');var start_url=jqcc(this).attr('start_url');var caller=jqcc(this).attr('caller');if((typeof(parent)!='undefined'&&parent!=null&&parent!=self)||window.top!=window.self){var controlparameters={"type":"plugins","name":"ccavchat","method":"accept_fid","params":{"to":to,"grp":grp,"start_url":start_url,"caller":caller}};controlparameters=JSON.stringify(controlparameters);parent.postMessage('CC^CONTROL_'+controlparameters,'*');}else{var controlparameters={"to":to,"grp":grp,"start_url":start_url};jqcc.ccavchat.accept_fid(controlparameters);}});});(function($){$.ccbroadcast=(function(){var title='Start an audio/video broadcast';var type=3;if(type==2){allowresize=0}else{allowresize=1}
var lastcall=0;var supported=true;var Browser=(function(){var ua=navigator.userAgent,tem,M=ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(M[1])){tem=/\brv[ :]+(\d+)/g.exec(ua)||[];return'IE '+(tem[1]||'');}
if(M[1]==='Chrome'){tem=ua.match(/\bOPR\/(\d+)/);if(tem!=null)return'Opera '+tem[1];}
M=M[2]?[M[1],M[2]]:[navigator.appName,navigator.appVersion,'-?'];if((tem=ua.match(/version\/(\d+)/i))!=null)M.splice(1,1,tem[1]);return M;})();if(Browser[0]=='MSIE'&&parseInt(Browser[1])<11){supported=false;}
return{getTitle:function(){return title;},init:function(params){var id=params.to;var chatroommode=params.chatroommode;var windowMode=0;if(typeof(params.windowMode)=="undefined"){windowMode=0;}else{windowMode=1;}
if(location.protocol==='http:'){windowMode=1;}
if(supported){var caller="";if(typeof(params.caller)!="undefined"){caller=params.caller;}
if(chatroommode==1){baseUrl=$.cometchat.getBaseUrl();basedata=$.cometchat.getBaseData();loadCCPopup(baseUrl+'plugins/broadcast/index.php?action=call&chatroommode=1&broadcast=0&type=1&caller='+caller+'&to='+id+'&grp='+id+'&basedata='+basedata,'broadcast',"status=0,toolbar=0,menubar=0,directories=0,resizable=1,location=0,status=0,scrollbars=0, width=450,height=335",450,335,'Audio/Video Broadcast',1,1,allowresize,1,windowMode);}else{var random='';var currenttime=new Date();currenttime=parseInt(currenttime.getTime()/1000);if(currenttime-lastcall>10){baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();if(jqcc.cometchat.getThemeArray('buddylistIsDevice',id)==1){jqcc.ccmobilenativeapp.sendnotification('has successfully sent an audio/video broadcast request.',id,jqcc.cometchat.getName(jqcc.cometchat.getThemeVariable('userid')));}
loadCCPopup(baseUrl+'plugins/broadcast/index.php?action=request&broadcast=0&type=1&caller='+caller+'&to='+id+'&basedata='+baseData,'broadcast',"status=0,toolbar=0,menubar=0,directories=0,resizable=1,location=0,status=0,scrollbars=0, width=450,height=335",450,335,'Audio/Video Broadcast',1,1,allowresize,1,windowMode);lastcall=currenttime;}else{alert('Please wait atleast 10 seconds before trying to broadcast again.');}}}else{alert('Sorry, your browser does not support this feature. Please upgrade your browser to the latest version or try a different browser.');}},accept:function(params){id=params.to;grp=params.grp;if(typeof(params.windowMode)=="undefined"){windowMode=0;}else{windowMode=1;}
if(location.protocol==='http:'){windowMode=1;}
baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();if(jqcc.cometchat.getCcvariable().callbackfn=='desktop'){loadCCPopup(baseUrl+'plugins/broadcast/index.php?action=call&broadcast=1&type=0&grp='+grp+'&basedata='+baseData,'broadcast',"status=0,toolbar=0,menubar=0,directories=0,type=0,resizable=1,location=0,status=0,scrollbars=0, width=450,height=335",450,335,'Audio/Video Broadcast',1,1,allowresize,1,1);}else{loadCCPopup(baseUrl+'plugins/broadcast/index.php?action=call&broadcast=1&type=0&grp='+grp+'&basedata='+baseData,'broadcast',"status=0,toolbar=0,menubar=0,directories=0,type=0,resizable=1,location=0,status=0,scrollbars=0, width=450,height=335",450,335,'Audio/Video Broadcast',1,1,allowresize,1,windowMode);}},join:function(params){id=params.grp;baseUrl=$.cometchat.getBaseUrl();basedata=$.cometchat.getBaseData();var windowMode=0;if(typeof(params.windowMode)=="undefined"){windowMode=0;}else{windowMode=1;}
if(location.protocol==='http:'){windowMode=1;}
loadCCPopup(baseUrl+'plugins/broadcast/index.php?action=call&broadcast=1&chatroommode=1&type=0&join=1&grp='+id+'&basedata='+basedata,'broadcast',"status=0,toolbar=0,menubar=0,directories=0,resizable=1,location=0,status=0,scrollbars=0, width=450,height=335",450,335,'Audio/Video Broadcast',1,1,allowresize,1,windowMode);},end_call:function(params){var id=params.to;var grp=params.grp;var chatroommode=params.chatroommode;baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();var popoutopencalled=0;var endcallrecieved=0;if(chatroommode==0){popoutopencalled=jqcc.cometchat.getInternalVariable('broadcastpopoutcalled');endcallrecieved=jqcc.cometchat.getInternalVariable('endcallrecievedfrom_'+grp);}
if(chatroommode==1||(jqcc.cometchat.getInternalVariable('endcallOnceWindow_'+grp)!=='1'&&jqcc.cometchat.getInternalVariable('endcallOnce_'+grp)!=='1')){if(popoutopencalled!=='1'&&endcallrecieved!=='1'){$.ajax({url:baseUrl+'plugins/broadcast/index.php?action=endcall',type:'GET',data:{to:id,basedata:baseData,grp:grp,chatroommode:chatroommode},dataType:'jsonp',success:function(data){},error:function(data){}});}}
if(chatroommode==0){jqcc.cometchat.setInternalVariable('endcallrecievedfrom_'+grp,'0');jqcc.cometchat.setInternalVariable('broadcastpopoutcalled','0');}},inviteBroadcast:function(params){var id=params.id;var caller='';if(typeof(params.caller)!="undefined"){caller=params.caller;}
baseData=$.cometchat.getBaseData();baseUrl=$.cometchat.getBaseUrl();var windowMode=0;if(typeof(params.windowMode)=="undefined"){windowMode=0;}else{windowMode=1;}
loadCCPopup(baseUrl+"plugins/broadcast/invite.php?action=invite&caller="+caller+"&grp="+id+"&basedata="+baseData,"invitebroadcast","status=0,toolbar=0,menubar=0,directories=0,resizable=0,location=0,status=0,scrollbars=1, width=400,height=190",400,190,"Please select users",0,0,0,0,windowMode);},getLangVariables:function(){return["Start an audio\/video broadcast","Please wait atleast 10 seconds before trying to broadcast again.","has sent you an audio\/video broadcast request.","Click here to accept it","or simply ignore this message.","has successfully sent an audio\/video broadcast request.","has accepted your audio\/video broadcast request.","Click here to launch the broadcasting window","Audio\/Video Broadcast","has started broadcasting.","Click here to join the broadcast.","Please select users","Invite Users","Users have been successfully invited. You can safely close this window.","has invited you to join the broadcast.","Click here to join","Click here to join the conversation.","has started a video conversation.","Sorry, there are no users available at the moment to invite.","End Call","Turn On Video","Turn Off Video","Turn On Mic","Turn Off Mic","This broadcast has ended","Sorry, your browser does not support this feature. Please upgrade your browser to the latest version or try a different browser."];},processControlMessage:function(controlparameters){var broadcast_language=jqcc.ccbroadcast.getLangVariables();var processedmessage=null;switch(controlparameters.method){case'endcall':if(controlparameters.params.chatroommode==0){jqcc.cometchat.setInternalVariable('endcallrecievedfrom_'+controlparameters.params.grp,'1');}
processedmessage=broadcast_language[24];break;default:processedmessage=null;break;}
return processedmessage;}};})();})(jqcc);jqcc(document).ready(function(){jqcc('.join_Broadcast').live('click',function(){var grp=jqcc(this).attr('grp');if(typeof(parent)!='undefined'&&parent!=null&&parent!=self){var controlparameters={"type":"plugins","name":"ccbroadcast","method":"join","params":{"grp":grp}};controlparameters=JSON.stringify(controlparameters);if(typeof(parent)!='undefined'&&parent!=null&&parent!=self){parent.postMessage('CC^CONTROL_'+controlparameters,'*');}else{window.opener.postMessage('CC^CONTROL_'+controlparameters,'*');}}else{var controlparameters={"grp":grp};jqcc.ccbroadcast.join(controlparameters);}});jqcc('.broadcastAccept').live('click',function(){var to=jqcc(this).attr('to');var grp=jqcc(this).attr('grp');if((typeof(parent)!='undefined'&&parent!=null&&parent!=self)||window.top!=window.self){var controlparameters={"type":"plugins","name":"ccbroadcast","method":"accept","params":{"to":to,"grp":grp}};controlparameters=JSON.stringify(controlparameters);parent.postMessage('CC^CONTROL_'+controlparameters,'*');}else{var controlparameters={"to":to,"grp":grp};jqcc.ccbroadcast.accept(controlparameters);}});jqcc('.broadcastInvite').live('click',function(){var to=jqcc(this).attr('to');var grp=jqcc(this).attr('grp');if((typeof(parent)!='undefined'&&parent!=null&&parent!=self)||window.top!=window.self){var controlparameters={"type":"plugins","name":"ccbroadcast","method":"accept","params":{"to":to,"grp":grp}};controlparameters=JSON.stringify(controlparameters);parent.postMessage('CC^CONTROL_'+controlparameters,'*');}else{var controlparameters={"to":to,"grp":grp};jqcc.ccbroadcast.accept(controlparameters);}});});function manageBlockList(){if((typeof(parent)!='undefined'&&parent!=null&&parent!=self)||window.top!=window.self){var controlparameters={"type":"plugins","name":"ccblock","method":"blockList","params":{}};controlparameters=JSON.stringify(controlparameters);parent.postMessage('CC^CONTROL_'+controlparameters,'*');}else{jqcc.ccblock.blockList(0);}}
(function($){$.ccblock=(function(){var title='Block User';return{getTitle:function(){return title;},init:function(params){var id=params.to;var chatroommode=params.chatroommode;baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();var result=confirm('Are you sure you want to block this user?');if(result){jqcc.ajax({url:baseUrl+'plugins/block/index.php?action=block',data:{to:id,basedata:baseData},dataType:'jsonp',type:'POST',success:function(data){if(data['result']==2){manageBlockList();}else{alert('User has been blocked successfully.');setTimeout(function(){if($('#cometchat_user_'+id).length>0){$('#cometchat_user_'+id+' .cometchat_closebox_bottom').click();}
if($('#cometchat_user_'+id+'_popup .cometchat_user_closebox').length>0){$('#cometchat_user_'+id+'_popup .cometchat_user_closebox').click();}},1000);jqcc.cometchat.chatHeartbeat();}},error:function(data){}});}},addCode:function(){$('#cometchat_optionsbutton_popup .cometchat_optionstyle').append('<a class="cometchat_manage_blocklist" href="javascript:void(0);" onclick="manageBlockList()" style="margin:5px;">Manage blocked users</a>');},blockList:function(params){var windowMode=0;if(typeof(params.windowMode)=="undefined"){windowMode=0;}else{windowMode=1;}
baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();loadCCPopup(baseUrl+'plugins/block/index.php?basedata='+baseData+'&embed=web','blocks',"status=0,toolbar=0,menubar=0,directories=0,resizable=0,location=0,status=0,scrollbars=0, width=500,height=150",500,150,'Manage blocked users',0,0,0,0,windowMode);}};})();})(jqcc);(function($){$.ccstyle=(function(){var title='Color your text';var chatroommode=0;return{getTitle:function(){return title;},init:function(params){var id=params.to;var chatroommode=params.chatroommode;baseUrl=$.cometchat.getBaseUrl();basedata=$.cometchat.getBaseData();var windowMode=0;if(typeof(params.windowMode)=="undefined"){windowMode=0;}else{windowMode=1;}
loadCCPopup(baseUrl+'plugins/style/index.php?id='+id+'&basedata='+basedata,'style',"status=0,toolbar=0,menubar=0,directories=0,resizable=0,location=0,status=0,scrollbars=0, width=260,height=130",260,80,'Which color would you like to use?',null,null,null,null,windowMode);},updatecolor:function(params){var text=params.pattern;if(text!=''&&text!=null){document.cookie='cc_chatroomcolor='+text+'; path=/';}
$('#currentroom').find("textarea.cometchat_textarea").focus();}};})();})(jqcc);String.prototype.replaceAll=function(s1,s2){return this.split(s1).join(s2);};(function($){$.ccaudiochat=(function(){var title='Start an audio call';var type='1';var supported=true;var lastcall=0;var allowresize=1;var Browser=(function(){var ua=navigator.userAgent,tem,M=ua.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];if(/trident/i.test(M[1])){tem=/\brv[ :]+(\d+)/g.exec(ua)||[];return'IE '+(tem[1]||'');}
if(M[1]==='Chrome'){tem=ua.match(/\bOPR\/(\d+)/);if(tem!=null)return'Opera '+tem[1];}
M=M[2]?[M[1],M[2]]:[navigator.appName,navigator.appVersion,'-?'];if((tem=ua.match(/version\/(\d+)/i))!=null)M.splice(1,1,tem[1]);return M;})();if(Browser[0]=='MSIE'&&parseInt(Browser[1])<11){supported=false;}
return{getTitle:function(){return title;},init:function(params){var id=params.to;var caller='';if(typeof(params.caller)!="undefined"){caller=params.caller;}
if(supported){var currenttime=new Date();currenttime=parseInt(currenttime.getTime()/1000);if(currenttime-lastcall>10){baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();jqcc.ajax({url:baseUrl+'plugins/audiochat/index.php?action=request',type:'GET',data:{to:id,basedata:baseData,caller:caller},dataType:'jsonp',success:function(data){},error:function(data){}});if(jqcc.cometchat.getThemeArray('buddylistIsDevice',id)==1){jqcc.ccmobilenativeapp.sendnotification('has successfully sent an audio chat request.',id,jqcc.cometchat.getName(jqcc.cometchat.getThemeVariable('userid')));}
lastcall=currenttime;}else{alert('Please wait atleast 10 seconds before trying to call again.');}}else{alert('Sorry, your browser does not support this feature. Please upgrade your browser to the latest version or try a different browser.');}},accept:function(params){id=params.to;grp=params.grp;if(typeof(params.windowMode)=="undefined"){windowMode=0;}else{windowMode=1;}
if(location.protocol==='http:'){windowMode=1;}
var caller='';if(typeof(params.caller)!="undefined"){caller=params.caller;}
if(supported){baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();jqcc.ccaudiochat.delinkaudiochat(grp);$.getJSON(baseUrl+'plugins/audiochat/index.php?action=accept&callback=?',{to:id,start_url:null,grp:grp,basedata:baseData,caller:caller});loadCCPopup(baseUrl+'plugins/audiochat/index.php?action=call&caller='+caller+'&grp='+grp+'&basedata='+baseData+'&to='+id,'audiochat',"status=0,toolbar=0,menubar=0,directories=0,resizable=1,location=0,status=0,scrollbars=0, width=225,height=200",225,200,'Audio Chat',0,1,allowresize,1,windowMode);}else{alert('Sorry, your browser does not support this feature. Please upgrade your browser to the latest version or try a different browser.');}},accept_fid:function(params){id=params.to;grp=params.grp;if(typeof(params.windowMode)=="undefined"){windowMode=0;}else{windowMode=1;}
if(location.protocol==='http:'){windowMode=1;}
var caller='';if(typeof(params.caller)!="undefined"){caller=params.caller;}
jqcc.ccaudiochat.delinkaudiochat(grp);baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();loadCCPopup(baseUrl+'plugins/audiochat/index.php?action=call&caller='+caller+'&grp='+grp+'&basedata='+baseData+'&to='+id,'audiochat',"status=0,toolbar=0,menubar=0,directories=0,resizable=1,location=0,status=0,scrollbars=0, width=225,height=200",225,200,'Audio Chat',0,1,allowresize,1,windowMode);},ignore_call:function(id,grp){baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();$.ajax({url:baseUrl+'plugins/audiochat/index.php?action=noanswer',type:'GET',data:{to:id,grp:grp,basedata:baseData},dataType:'jsonp',success:function(data){},error:function(data){}});},cancel_call:function(id,grp){baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();$.ajax({url:baseUrl+'plugins/audiochat/index.php?action=canceloutgoingcall',type:'GET',data:{to:id,grp:grp,basedata:baseData},dataType:'jsonp',success:function(data){},error:function(data){}});},reject_call:function(id,grp){baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();jqcc.ccaudiochat.delinkaudiochat(grp);$.ajax({url:baseUrl+'plugins/audiochat/index.php?action=rejectcall',type:'GET',data:{to:id,grp:grp,basedata:baseData},dataType:'jsonp',success:function(data){},error:function(data){}});},end_call:function(params){id=params.to;grp=params.grp;baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();var popoutopencalled=jqcc.cometchat.getInternalVariable('audiochatpopoutcalled');var endcallrecieved=jqcc.cometchat.getInternalVariable('endcallrecievedfrom_'+grp);if(popoutopencalled!=='1'){if(endcallrecieved!=='1'){$.ajax({url:baseUrl+'plugins/audiochat/index.php?action=endcall',type:'GET',data:{to:id,basedata:baseData,grp:grp},dataType:'jsonp',success:function(data){},error:function(data){}});}}
jqcc.cometchat.setInternalVariable('endcallrecievedfrom_'+grp,'0');jqcc.cometchat.setInternalVariable('audiochatpopoutcalled','0');},join:function(id){baseUrl=$.cometchat.getBaseUrl();basedata=$.cometchat.getBaseData();$[$.cometchat.getChatroomVars('calleeAPI')].loadCCPopup(baseUrl+'plugins/audiochat/index.php?action=call&chatroommode=1&type=0&join=1&grp='+id+'&basedata='+basedata,'audiochat',"status=0,toolbar=0,menubar=0,directories=0,resizable=1,location=0,status=0,scrollbars=0, width=225,height=200",225,200,'Audio Chat',1,1,allowresize,1);},getLangVariables:function(){return["Start an audio call","Please wait atleast 10 seconds before trying to call again.","has sent you an audio chat request.","Click here to accept it","or simply ignore this message.","has successfully sent an audio chat request.","has accepted your audio chat request.","Click here to launch the audio chat window","Audio Chat","Having issues connecting?","There are several reasons why the audio chat may be stuck at initializing:\n<br\/><br\/>\n1. audio chat requires P2P to establish connection. In order for it to work, your firewall must be configured to allow outgoing UDP traffic. While this is the case with most consumer or small office\/home office (SOHO) firewalls, many corporate firewalls block UDP traffic altogether.\n<br\/><br\/>\n2. The user at the other end is behind a UDP blocking firewall and is unable to connect to you.\n<br\/><br\/>\n3. Our servers are facing issues and you are unable to connect.\n","Closing window shortly","Users have been successfully invited. You can safely close this window.","Users Invited Successfully!","has invited you to join a audio conference.","Click here to join","Please select users","Invite Users","Invite Users","has started a audio conversation.","Click here to join the conversation.","Settings","Done","Play test sound","Install plug-in","Sorry, there are no users available at the moment to invite.","Click here to open it","Please check your email for verification zoom account at","Call","Call from","Call to","Call ended, duration","rejected","No answer from","Cancelled","Would you like to call","busy","This call has been cancelled","This call has ended","The user is busy right now. Please try again later","The user is not answering the call right now. Please try again later","Sorry, we are unable to send this message.","Sorry, your device does not support this feature.","click here","To cancel outgoing call ","To reject call ","You can also simply ignore this message.","Please configure this plugin using administration panel before using. <a href=\"http:\/\/www.cometchat.com\/documentation\/admin\/plugins\/audio-chat-plugin\/\" target=\"_blank\">Click Here<\/a> for more information.","Sorry, your browser does not support this feature. Please upgrade your browser to the latest version or try a different browser.","End Call","Turn On Mic","Turn Off Mic"];},delinkaudiochat:function(grp){$('a.audiochat_link_'+grp).each(function(){$(this).attr('onclick','').unbind('click');$(this).removeClass('acceptAudioChat accept_fid');this.style.setProperty('color','#95a5a6','important');$(this).css('text-decoration','none');$(this).css('cursor','text');});},processControlMessage:function(controlparameters){var audiochat_language=jqcc.ccaudiochat.getLangVariables();var processedmessage=null;jqcc.ccaudiochat.delinkaudiochat(controlparameters.params.grp);switch(controlparameters.method){case'endcall':jqcc.cometchat.setInternalVariable('endcallrecievedfrom_'+controlparameters.params.grp,'1');processedmessage=audiochat_language[38];break;case'rejectcall':processedmessage=audiochat_language[39];break;case'noanswer':processedmessage=audiochat_language[40];break;case'busycall':processedmessage=audiochat_language[39];break;case'cancelcall':processedmessage=audiochat_language[37];break;default:processedmessage=null;break;}
return processedmessage;}};})();})(jqcc);jqcc(document).ready(function(){jqcc('.acceptAudioChat').live('click',function(){var to=jqcc(this).attr('to');var grp=jqcc(this).attr('grp');var caller=jqcc(this).attr('caller');if((typeof(parent)!='undefined'&&parent!=null&&parent!=self)||window.top!=window.self){var controlparameters={"type":"plugins","name":"ccaudiochat","method":"accept","params":{"to":to,"grp":grp,"caller":caller}};controlparameters=JSON.stringify(controlparameters);parent.postMessage('CC^CONTROL_'+controlparameters,'*');}else{var controlparameters={"to":to,"grp":grp};jqcc.ccaudiochat.accept(controlparameters);}});jqcc('.accept_fid').live('click',function(){var to=jqcc(this).attr('to');var grp=jqcc(this).attr('grp');var caller=jqcc(this).attr('caller');if((typeof(parent)!='undefined'&&parent!=null&&parent!=self)||window.top!=window.self){var controlparameters={"type":"plugins","name":"ccaudiochat","method":"accept_fid","params":{"to":to,"grp":grp,"caller":caller}};controlparameters=JSON.stringify(controlparameters);parent.postMessage('CC^CONTROL_'+controlparameters,'*');}else{var controlparameters={"to":to,"grp":grp};jqcc.ccaudiochat.accept_fid(controlparameters);}});});(function($){$.ccscreenshare=(function(){var title='Share my screen';var lastcall=0;var height=480;var width=640;var type='0';return{getTitle:function(){return title;},init:function(params){var id=params.to;var chatroommode=params.chatroommode;var windowMode=0;var currenttime=new Date();if(typeof(params.windowMode)=="undefined"){windowMode=0;}else{windowMode=1;}
currenttime=parseInt(currenttime.getTime()/1000);if(currenttime-lastcall>10){var random=currenttime;if(chatroommode==1){baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();if(type=='2'){$.ajax({url:baseUrl+'plugins/screenshare/index.php?chatroommode=1&action=request&callback=?',type:'GET',data:{to:id,id:random,basedata:baseData},dataType:'text',success:function(data){var flag=data.split('^');if(flag[0]=='1'){alert('Please check your email for verification zoom account at '+flag[1]);}},error:function(data){}});}else{$.getJSON(baseUrl+'plugins/screenshare/index.php?chatroommode=1&action=request&callback=?',{to:id,id:random,basedata:baseData});}}else{baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();$.getJSON(baseUrl+'plugins/screenshare/index.php?action=request&callback=?',{to:id,id:random,basedata:baseData});if(jqcc.cometchat.getThemeArray('buddylistIsDevice',id)==1){jqcc.ccmobilenativeapp.sendnotification('has shared his/her screen with you.',id,jqcc.cometchat.getName(jqcc.cometchat.getThemeVariable('userid')));}}
lastcall=currenttime;if(type=='1'){var w=window.open(baseUrl+'plugins/screenshare/index.php?action=screenshare&type=1&id='+random+'&basedata='+baseData,'screenshare',"status=0,toolbar=0,menubar=0,directories=0,resizable=0,location=0,status=0,scrollbars=0, width=825,height=350");w.focus();}else if(type=='0'){if(chatroommode==1){loadCCPopup(baseUrl+'plugins/screenshare/index.php?action=screenshare&type=1&id='+random+'&basedata='+baseData,'screenshare',"status=0,toolbar=0,menubar=0,directories=0,resizable=0,location=0,status=0,scrollbars=0, width=430,height=100",430,100,'Screen sharing',0,0,1,1,windowMode);}else{loadCCPopup(baseUrl+'plugins/screenshare/index.php?action=screenshare&type=1&id='+random+'&basedata='+baseData,'screenshare',"status=0,toolbar=0,menubar=0,directories=0,resizable=0,location=0,status=0,scrollbars=0, width=430,height=100",430,100,'Screen sharing',0,0,1,1,windowMode);}}}else{alert('Please wait atleast 10 seconds before trying to share again.');}},accept:function(params){baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();id=params.to;random=params.grp;join_url=params.join_url;start_url=params.start_url;mode=params.chatroommode;windowMode=0;if(typeof(params.windowMode)=="undefined"){windowMode=0;}else{windowMode=1;}
if(mode==1){if(type=='2'){$.ajax({url:baseUrl+'plugins/screenshare/index.php?chatroommode=1&action=accept&callback=?',type:'GET',data:{to:id,start_url:start_url,grp:random,basedata:baseData},dataType:'text',success:function(data){var flag=data.split('^');if(flag[0]=='1'){alert('Please check your email for verification zoom account at '+flag[1]);}},error:function(data){}});}else{$.getJSON(baseUrl+'plugins/screenshare/index.php?chatroommode=1&action=accept&callback=?',{to:id,start_url:start_url,grp:random,basedata:baseData});}}else{$.getJSON(baseUrl+'plugins/screenshare/index.php?action=accept&callback=?',{to:id,start_url:start_url,grp:random,basedata:baseData});}
if(type=='2'){window.open(join_url,'screenshare','width=640,height=480,scrollbars=yes, resizable=yes');}else{if(mode==1){var controlparameters={"type":"plugins","name":"core","method":"loadCCPopup","params":{"url":baseUrl+'plugins/screenshare/index.php?action=screenshare&type=0&id='+random+'&basedata='+baseData,"name":"screenshare","properties":"status=0,toolbar=0,menubar=0,directories=0,resizable=1,location=0,status=0,scrollbars=0, width="+width+",height="+height,"width":width,"height":height,"title":'Screen sharing',"force":"0","allowmaximize":"1","allowresize":"1","allowpopout":"1","windowMode":windowMode}};controlparameters=JSON.stringify(controlparameters);parent.postMessage('CC^CONTROL_'+controlparameters,'*');}else{loadCCPopup(baseUrl+'plugins/screenshare/index.php?action=screenshare&type=0&id='+random+'&basedata='+baseData,'screenshare',"status=0,toolbar=0,menubar=0,directories=0,resizable=1,location=0,status=0,scrollbars=0, width="+width+",height="+height,width,height,'Screen sharing',0,1,1,1,windowMode);}}},accept_fid:function(params){id=params.to;start_url=params.start_url;chatroommode=params.chatroommode;windowMode=0;if(typeof(params.windowMode)=="undefined"){windowMode=0;}else{windowMode=1;}
if(type=='2'){window.open(start_url,'screenshare','width=640,height=480,scrollbars=yes, resizable=yes');}else{if(chatroommode==1){var controlparameters={"type":"plugins","name":"core","method":"loadCCPopup","params":{"url":start_url,"name":"screenshare","properties":"status=0,toolbar=0,menubar=0,directories=0,resizable=1,location=0,status=0,scrollbars=0, width=640,height=480","width":width,"height":height,"title":'Screen sharing',"force":"0","allowmaximize":"1","allowresize":"1","allowpopout":"1","windowMode":windowMode}};controlparameters=JSON.stringify(controlparameters);parent.postMessage('CC^CONTROL_'+controlparameters,'*');}else{loadCCPopup(start_url,'screenshare',"status=0,toolbar=0,menubar=0,directories=0,resizable=1,location=0,status=0,scrollbars=0, width=640,height=480",width,height,'Screen sharing',0,1,1,1,windowMode);}}}};})();})(jqcc);jqcc(document).ready(function(){jqcc('.acceptSceenshare').live('click',function(){var to=jqcc(this).attr('to');var grp=jqcc(this).attr('grp');var join_url=jqcc(this).attr('join_url');var start_url=jqcc(this).attr('start_url');var chatroommode=jqcc(this).attr('chatroommode');if(typeof(parent)!='undefined'&&parent!=null&&parent!=self){var controlparameters={"type":"plugins","name":"ccscreenshare","method":"accept","params":{"to":to,"grp":grp,"join_url":join_url,"start_url":start_url,"chatroommode":chatroommode}};controlparameters=JSON.stringify(controlparameters);if(typeof(parent)!='undefined'&&parent!=null&&parent!=self){parent.postMessage('CC^CONTROL_'+controlparameters,'*');}else{window.opener.postMessage('CC^CONTROL_'+controlparameters,'*');}}else{var controlparameters={"to":to,"grp":grp,"join_url":join_url,"start_url":start_url,"chatroommode":chatroommode};jqcc.ccscreenshare.accept(controlparameters);}});jqcc('.accept_fidSceenshare').live('click',function(){var to=jqcc(this).attr('to');var start_url=jqcc(this).attr('start_url');var chatroommode=jqcc(this).attr('chatroommode');if(typeof(parent)!='undefined'&&parent!=null&&parent!=self){var controlparameters={"type":"plugins","name":"ccscreenshare","method":"accept","params":{"to":to,"start_url":start_url,"chatroommode":chatroommode}};controlparameters=JSON.stringify(controlparameters);if(typeof(parent)!='undefined'&&parent!=null&&parent!=self){parent.postMessage('CC^CONTROL_'+controlparameters,'*');}else{window.opener.postMessage('CC^CONTROL_'+controlparameters,'*');}}else{var controlparameters={"to":to,"start_url":start_url,"chatroommode":chatroommode};jqcc.ccscreenshare.accept(controlparameters);}});});(function($){$.ccsmilies=(function(){var title='Add a smiley';var height=250;var width=420;return{getTitle:function(){return title;},init:function(params){var id=params.to;var chatroommode=params.chatroommode;var caller='';var windowMode=0;if(typeof(params.windowMode)=="undefined"){windowMode=0;}else{windowMode=1;}
if(typeof(params.caller)!="undefined"){caller=params.caller;}
if(chatroommode==1){baseUrl=$.cometchat.getBaseUrl();basedata=$.cometchat.getBaseData();loadCCPopup(baseUrl+'plugins/smilies/index.php?chatroommode=1&id='+id+'&basedata='+basedata+'&caller='+caller,'smilies',"status=0,toolbar=0,menubar=0,directories=0,resizable=0,location=0,status=0,scrollbars=0,width="+width+",height="+height,width,height,'Which smiley would you like?',null,null,null,null,windowMode);}else{baseUrl=$.cometchat.getBaseUrl();baseData=$.cometchat.getBaseData();loadCCPopup(baseUrl+'plugins/smilies/index.php?id='+id+'&basedata='+baseData+'&caller='+caller,'smilies',"status=0,toolbar=0,menubar=0,directories=0,resizable=0,location=0,status=0,scrollbars=0, width="+width+",height="+height,width,height,'Which smiley would you like?',null,null,null,null,windowMode);}},addtext:function(params){var string='';var id=params.to;var text=params.pattern+' ';var chatroommode=params.chatroommode;if(chatroommode==1){var currentroom_textarea=$('#currentroom').find('textarea.cometchat_textarea');currentroom_textarea.focus();string=currentroom_textarea.val();if(string.charAt(string.length-1)==' '){currentroom_textarea.val(currentroom_textarea.val()+text);}else{if(string.length==0){currentroom_textarea.val(text);}else{currentroom_textarea.val(currentroom_textarea.val()+' '+text);}}}else{if($('#cometchat_user_'+id+'_popup').length>0){var cometchat_user_textarea=$('#cometchat_user_'+id+'_popup').find('textarea.cometchat_textarea');cometchat_user_textarea.focus();jqcc.cometchat.chatWith(id);string=cometchat_user_textarea.val();if(string.charAt(string.length-1)==' '){cometchat_user_textarea.val(string+text);}else{if(string.length==0){cometchat_user_textarea.val(text);}else{cometchat_user_textarea.val(string+' '+text);}}}else{jqcc.cometchat.chatWith(id);var cometchat_user_textarea=$('#cometchat_user_'+id+'_popup').find('textarea.cometchat_textarea');cometchat_user_textarea.focus();string=cometchat_user_textarea.val();if(string.charAt(string.length-1)==' '){cometchat_user_textarea.val(string+text);}else{if(string.length==0){cometchat_user_textarea.val(text);}else{cometchat_user_textarea.val(string+' '+text);}}}}}};})();})(jqcc);(function($){$.ccchattime=(function(){var title='Show/hide time';var enabled=new Array();return{getTitle:function(){return title;},init:function(params){var id=params.to;var chatroommode=params.chatroommode;if(chatroommode==1){var currentroom=$("#currentroom");if(currentroom.find("span.cometchat_ts").css('display')=='none'){currentroom.find("span.cometchat_ts").css('display','inline');enabled=1;}else{currentroom.find("span.cometchat_ts_date").css('display','none');currentroom.find("span.cometchat_ts").css('display','none');enabled=0;}}else{var cometchat_user_popup=$("#cometchat_user_"+id+"_popup");if(cometchat_user_popup.find("span.cometchat_ts").css('display')=='none'){cometchat_user_popup.find("span.cometchat_ts").css('display','inline');enabled[id]=1;}else{cometchat_user_popup.find("span.cometchat_ts_date").css('display','none');cometchat_user_popup.find("span.cometchat_ts").css('display','none');enabled[id]=0;}}},getEnabled:function(id,chatroommode){if(chatroommode==1){if(typeof(enabled)=='undefined'){return 0;}
return enabled;}else{if(typeof(enabled[id])=='undefined'){return 0;}
return enabled[id];}}};})();})(jqcc);(function($){var pushNotifications='1';$.ccmobilenativeapp=(function(){return{sendnotification:function(message,channel,displayname,chatroommode){if(typeof chatroommode=='undefined'&&pushNotifications=='1'){var baseUrl=$.cometchat.getBaseUrl();$.getJSON(baseUrl+'extensions/mobileapp/sendnotification.php',{channel:channel,message:message,displayname:displayname});}else if(pushNotifications=='1'){var baseUrl=$.cometchat.getBaseUrl();$.getJSON(baseUrl+'extensions/mobileapp/sendnotification.php?chatroommode=1',{channel:channel,message:message,displayname:displayname});}}};})();})(jqcc);(function(a,b){function d(b){return!a(b).parents().andSelf().filter(function(){return a.curCSS(this,"visibility")==="hidden"||a.expr.filters.hidden(this)}).length}function c(b,c){var e=b.nodeName.toLowerCase();if("area"===e){var f=b.parentNode,g=f.name,h;if(!b.href||!g||f.nodeName.toLowerCase()!=="map")return!1;h=a("img[usemap=#"+g+"]")[0];return!!h&&d(h)}return(/input|select|textarea|button|object/.test(e)?!b.disabled:"a"==e?b.href||c:c)&&d(b)}a.ui=a.ui||{};a.ui.version||(a.extend(a.ui,{version:"1.8.18",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),a.fn.extend({propAttr:a.fn.prop||a.fn.attr,_focus:a.fn.focus,focus:function(b,c){return typeof b=="number"?this.each(function(){var d=this;setTimeout(function(){a(d).focus(),c&&c.call(d)},b)}):this._focus.apply(this,arguments)},scrollParent:function(){var b;a.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?b=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.curCSS(this,"position",1))&&/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0):b=this.parents().filter(function(){return/(auto|scroll)/.test(a.curCSS(this,"overflow",1)+a.curCSS(this,"overflow-y",1)+a.curCSS(this,"overflow-x",1))}).eq(0);return/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length){var d=a(this[0]),e,f;while(d.length&&d[0]!==document){e=d.css("position");if(e==="absolute"||e==="relative"||e==="fixed"){f=parseInt(d.css("zIndex"),10);if(!isNaN(f)&&f!==0)return f}d=d.parent()}}return 0},disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.each(["Width","Height"],function(c,d){function h(b,c,d,f){a.each(e,function(){c-=parseFloat(a.curCSS(b,"padding"+this,!0))||0,d&&(c-=parseFloat(a.curCSS(b,"border"+this+"Width",!0))||0),f&&(c-=parseFloat(a.curCSS(b,"margin"+this,!0))||0)});return c}var e=d==="Width"?["Left","Right"]:["Top","Bottom"],f=d.toLowerCase(),g={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){if(c===b)return g["inner"+d].call(this);return this.each(function(){a(this).css(f,h(this,c)+"px")})},a.fn["outer"+d]=function(b,c){if(typeof b!="number")return g["outer"+d].call(this,b);return this.each(function(){a(this).css(f,h(this,b,!0,c)+"px")})}}),a.extend(a.expr[":"],{data:function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a(function(){var b=document.body,c=b.appendChild(c=document.createElement("div"));c.offsetHeight,a.extend(c.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),a.support.minHeight=c.offsetHeight===100,a.support.selectstart="onselectstart"in c,b.removeChild(c).style.display="none"}),a.extend(a.ui,{plugin:{add:function(b,c,d){var e=a.ui[b].prototype;for(var f in d)e.plugins[f]=e.plugins[f]||[],e.plugins[f].push([c,d[f]])},call:function(a,b,c){var d=a.plugins[b];if(!!d&&!!a.element[0].parentNode)for(var e=0;e<d.length;e++)a.options[d[e][0]]&&d[e][1].apply(a.element,c)}},contains:function(a,b){return document.compareDocumentPosition?a.compareDocumentPosition(b)&16:a!==b&&a.contains(b)},hasScroll:function(b,c){if(a(b).css("overflow")==="hidden")return!1;var d=c&&c==="left"?"scrollLeft":"scrollTop",e=!1;if(b[d]>0)return!0;b[d]=1,e=b[d]>0,b[d]=0;return e},isOverAxis:function(a,b,c){return a>b&&a<b+c},isOver:function(b,c,d,e,f,g){return a.ui.isOverAxis(b,d,f)&&a.ui.isOverAxis(c,e,g)}}))})(jqcc);(function(a,b){if(a.cleanData){var c=a.cleanData;a.cleanData=function(b){for(var d=0,e;(e=b[d])!=null;d++)try{a(e).triggerHandler("remove")}catch(f){}c(b)}}else{var d=a.fn.remove;a.fn.remove=function(b,c){return this.each(function(){c||(!b||a.filter(b,[this]).length)&&a("*",this).add([this]).each(function(){try{a(this).triggerHandler("remove")}catch(b){}});return d.call(a(this),b,c)})}}a.widget=function(b,c,d){var e=b.split(".")[0],f;b=b.split(".")[1],f=e+"-"+b,d||(d=c,c=a.Widget),a.expr[":"][f]=function(c){return!!a.data(c,b)},a[e]=a[e]||{},a[e][b]=function(a,b){arguments.length&&this._createWidget(a,b)};var g=new c;g.options=a.extend(!0,{},g.options),a[e][b].prototype=a.extend(!0,g,{namespace:e,widgetName:b,widgetEventPrefix:a[e][b].prototype.widgetEventPrefix||b,widgetBaseClass:f},d),a.widget.bridge(b,a[e][b])},a.widget.bridge=function(c,d){a.fn[c]=function(e){var f=typeof e=="string",g=Array.prototype.slice.call(arguments,1),h=this;e=!f&&g.length?a.extend.apply(null,[!0,e].concat(g)):e;if(f&&e.charAt(0)==="_")return h;f?this.each(function(){var d=a.data(this,c),f=d&&a.isFunction(d[e])?d[e].apply(d,g):d;if(f!==d&&f!==b){h=f;return!1}}):this.each(function(){var b=a.data(this,c);b?b.option(e||{})._init():a.data(this,c,new d(e,this))});return h}},a.Widget=function(a,b){arguments.length&&this._createWidget(a,b)},a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:!1},_createWidget:function(b,c){a.data(c,this.widgetName,this),this.element=a(c),this.options=a.extend(!0,{},this.options,this._getCreateOptions(),b);var d=this;this.element.bind("remove."+this.widgetName,function(){d.destroy()}),this._create(),this._trigger("create"),this._init()},_getCreateOptions:function(){return a.metadata&&a.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName),this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled "+"ui-state-disabled")},widget:function(){return this.element},option:function(c,d){var e=c;if(arguments.length===0)return a.extend({},this.options);if(typeof c=="string"){if(d===b)return this.options[c];e={},e[c]=d}this._setOptions(e);return this},_setOptions:function(b){var c=this;a.each(b,function(a,b){c._setOption(a,b)});return this},_setOption:function(a,b){this.options[a]=b,a==="disabled"&&this.widget()[b?"addClass":"removeClass"](this.widgetBaseClass+"-disabled"+" "+"ui-state-disabled").attr("aria-disabled",b);return this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_trigger:function(b,c,d){var e,f,g=this.options[b];d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent;if(f)for(e in f)e in c||(c[e]=f[e]);this.element.trigger(c,d);return!(a.isFunction(g)&&g.call(this.element[0],c,d)===!1||c.isDefaultPrevented())}}})(jqcc);(function(a,b){var c=!1;a(document).mouseup(function(a){c=!1}),a.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){if(!0===a.data(c.target,b.widgetName+".preventClickEvent")){a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation();return!1}}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName)},_mouseDown:function(b){if(!c){this._mouseStarted&&this._mouseUp(b),this._mouseDownEvent=b;var d=this,e=b.which==1,f=typeof this.options.cancel=="string"&&b.target.nodeName?a(b.target).closest(this.options.cancel).length:!1;if(!e||f||!this._mouseCapture(b))return!0;this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)){this._mouseStarted=this._mouseStart(b)!==!1;if(!this._mouseStarted){b.preventDefault();return!0}}!0===a.data(b.target,this.widgetName+".preventClickEvent")&&a.removeData(b.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return d._mouseMove(a)},this._mouseUpDelegate=function(a){return d._mouseUp(a)},a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),b.preventDefault(),c=!0;return!0}},_mouseMove:function(b){if(a.browser.msie&&!(document.documentMode>=9)&&!b.button)return this._mouseUp(b);if(this._mouseStarted){this._mouseDrag(b);return b.preventDefault()}this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,b)!==!1,this._mouseStarted?this._mouseDrag(b):this._mouseUp(b));return!this._mouseStarted},_mouseUp:function(b){a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target==this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b));return!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(a){return this.mouseDelayMet},_mouseStart:function(a){},_mouseDrag:function(a){},_mouseStop:function(a){},_mouseCapture:function(a){return!0}})})(jqcc);(function(a,b){a.widget("ui.draggable",a.ui.mouse,{widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1},_create:function(){this.options.helper=="original"&&!/^(?:r|a|f)/.test(this.element.css("position"))&&(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},destroy:function(){if(!!this.element.data("draggable")){this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy();return this}},_mouseCapture:function(b){var c=this.options;if(this.helper||c.disabled||a(b.target).is(".ui-resizable-handle"))return!1;this.handle=this._getHandle(b);if(!this.handle)return!1;c.iframeFix&&a(c.iframeFix===!0?"iframe":c.iframeFix).each(function(){a('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(a(this).offset()).appendTo("body")});return!0},_mouseStart:function(b){var c=this.options;this.helper=this._createHelper(b),this._cacheHelperProportions(),a.ui.ddmanager&&(a.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,c.cursorAt&&this._adjustOffsetFromHelper(c.cursorAt),c.containment&&this._setContainment();if(this._trigger("start",b)===!1){this._clear();return!1}this._cacheHelperProportions(),a.ui.ddmanager&&!c.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this.helper.addClass("ui-draggable-dragging"),this._mouseDrag(b,!0),a.ui.ddmanager&&a.ui.ddmanager.dragStart(this,b);return!0},_mouseDrag:function(b,c){this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute");if(!c){var d=this._uiHash();if(this._trigger("drag",b,d)===!1){this._mouseUp({});return!1}this.position=d.position}if(!this.options.axis||this.options.axis!="y")this.helper[0].style.left=this.position.left+"px";if(!this.options.axis||this.options.axis!="x")this.helper[0].style.top=this.position.top+"px";a.ui.ddmanager&&a.ui.ddmanager.drag(this,b);return!1},_mouseStop:function(b){var c=!1;a.ui.ddmanager&&!this.options.dropBehaviour&&(c=a.ui.ddmanager.drop(this,b)),this.dropped&&(c=this.dropped,this.dropped=!1);if((!this.element[0]||!this.element[0].parentNode)&&this.options.helper=="original")return!1;if(this.options.revert=="invalid"&&!c||this.options.revert=="valid"&&c||this.options.revert===!0||a.isFunction(this.options.revert)&&this.options.revert.call(this.element,c)){var d=this;a(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){d._trigger("stop",b)!==!1&&d._clear()})}else this._trigger("stop",b)!==!1&&this._clear();return!1},_mouseUp:function(b){this.options.iframeFix===!0&&a("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),a.ui.ddmanager&&a.ui.ddmanager.dragStop(this,b);return a.ui.mouse.prototype._mouseUp.call(this,b)},cancel:function(){this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear();return this},_getHandle:function(b){var c=!this.options.handle||!a(this.options.handle,this.element).length?!0:!1;a(this.options.handle,this.element).find("*").andSelf().each(function(){this==b.target&&(c=!0)});return c},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b])):c.helper=="clone"?this.element.clone().removeAttr("id"):this.element;d.parents("body").length||d.appendTo(c.appendTo=="parent"?this.element[0].parentNode:c.appendTo),d[0]!=this.element[0]&&!/(fixed|absolute)/.test(d.css("position"))&&d.css("position","absolute");return d},_adjustOffsetFromHelper:function(b){typeof b=="string"&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&a.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&a.browser.msie)b={top:0,left:0};return{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var a=this.element.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b=this.options;b.containment=="parent"&&(b.containment=this.helper[0].parentNode);if(b.containment=="document"||b.containment=="window")this.containment=[b.containment=="document"?0:a(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,b.containment=="document"?0:a(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,(b.containment=="document"?0:a(window).scrollLeft())+a(b.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(b.containment=="document"?0:a(window).scrollTop())+(a(b.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top];if(!/^(document|window|parent)$/.test(b.containment)&&b.containment.constructor!=Array){var c=a(b.containment),d=c[0];if(!d)return;var e=c.offset(),f=a(d).css("overflow")!="hidden";this.containment=[(parseInt(a(d).css("borderLeftWidth"),10)||0)+(parseInt(a(d).css("paddingLeft"),10)||0),(parseInt(a(d).css("borderTopWidth"),10)||0)+(parseInt(a(d).css("paddingTop"),10)||0),(f?Math.max(d.scrollWidth,d.offsetWidth):d.offsetWidth)-(parseInt(a(d).css("borderLeftWidth"),10)||0)-(parseInt(a(d).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(f?Math.max(d.scrollHeight,d.offsetHeight):d.offsetHeight)-(parseInt(a(d).css("borderTopWidth"),10)||0)-(parseInt(a(d).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=c}else b.containment.constructor==Array&&(this.containment=b.containment)},_convertPositionTo:function(b,c){c||(c=this.position);var d=b=="absolute"?1:-1,e=this.options,f=this.cssPosition=="absolute"&&(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,g=/(html|body)/i.test(f[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():g?0:f.scrollTop())*d),left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():g?0:f.scrollLeft())*d)}},_generatePosition:function(b){var c=this.options,d=this.cssPosition=="absolute"&&(this.scrollParent[0]==document||!a.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,e=/(html|body)/i.test(d[0].tagName),f=b.pageX,g=b.pageY;if(this.originalPosition){var h;if(this.containment){if(this.relative_container){var i=this.relative_container.offset();h=[this.containment[0]+i.left,this.containment[1]+i.top,this.containment[2]+i.left,this.containment[3]+i.top]}else h=this.containment;b.pageX-this.offset.click.left<h[0]&&(f=h[0]+this.offset.click.left),b.pageY-this.offset.click.top<h[1]&&(g=h[1]+this.offset.click.top),b.pageX-this.offset.click.left>h[2]&&(f=h[2]+this.offset.click.left),b.pageY-this.offset.click.top>h[3]&&(g=h[3]+this.offset.click.top)}if(c.grid){var j=c.grid[1]?this.originalPageY+Math.round((g-this.originalPageY)/c.grid[1])*c.grid[1]:this.originalPageY;g=h?j-this.offset.click.top<h[1]||j-this.offset.click.top>h[3]?j-this.offset.click.top<h[1]?j+c.grid[1]:j-c.grid[1]:j:j;var k=c.grid[0]?this.originalPageX+Math.round((f-this.originalPageX)/c.grid[0])*c.grid[0]:this.originalPageX;f=h?k-this.offset.click.left<h[0]||k-this.offset.click.left>h[2]?k-this.offset.click.left<h[0]?k+c.grid[0]:k-c.grid[0]:k:k}}return{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():e?0:d.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(a.browser.safari&&a.browser.version<526&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():e?0:d.scrollLeft())}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]!=this.element[0]&&!this.cancelHelperRemoval&&this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(b,c,d){d=d||this._uiHash(),a.ui.plugin.call(this,b,[c,d]),b=="drag"&&(this.positionAbs=this._convertPositionTo("absolute"));return a.Widget.prototype._trigger.call(this,b,c,d)},plugins:{},_uiHash:function(a){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),a.extend(a.ui.draggable,{version:"1.8.18"}),a.ui.plugin.add("draggable","connectToSortable",{start:function(b,c){var d=a(this).data("draggable"),e=d.options,f=a.extend({},c,{item:d.element});d.sortables=[],a(e.connectToSortable).each(function(){var c=a.data(this,"sortable");c&&!c.options.disabled&&(d.sortables.push({instance:c,shouldRevert:c.options.revert}),c.refreshPositions(),c._trigger("activate",b,f))})},stop:function(b,c){var d=a(this).data("draggable"),e=a.extend({},c,{item:d.element});a.each(d.sortables,function(){this.instance.isOver?(this.instance.isOver=0,d.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=!0),this.instance._mouseStop(b),this.instance.options.helper=this.instance.options._helper,d.options.helper=="original"&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",b,e))})},drag:function(b,c){var d=a(this).data("draggable"),e=this,f=function(b){var c=this.offset.click.top,d=this.offset.click.left,e=this.positionAbs.top,f=this.positionAbs.left,g=b.height,h=b.width,i=b.top,j=b.left;return a.ui.isOver(e+c,f+d,i,j,g,h)};a.each(d.sortables,function(f){this.instance.positionAbs=d.positionAbs,this.instance.helperProportions=d.helperProportions,this.instance.offset.click=d.offset.click,this.instance._intersectsWith(this.instance.containerCache)?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=a(e).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return c.helper[0]},b.target=this.instance.currentItem[0],this.instance._mouseCapture(b,!0),this.instance._mouseStart(b,!0,!0),this.instance.offset.click.top=d.offset.click.top,this.instance.offset.click.left=d.offset.click.left,this.instance.offset.parent.left-=d.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=d.offset.parent.top-this.instance.offset.parent.top,d._trigger("toSortable",b),d.dropped=this.instance.element,d.currentItem=d.element,this.instance.fromOutside=d),this.instance.currentItem&&this.instance._mouseDrag(b)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",b,this.instance._uiHash(this.instance)),this.instance._mouseStop(b,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),d._trigger("fromSortable",b),d.dropped=!1)})}}),a.ui.plugin.add("draggable","cursor",{start:function(b,c){var d=a("body"),e=a(this).data("draggable").options;d.css("cursor")&&(e._cursor=d.css("cursor")),d.css("cursor",e.cursor)},stop:function(b,c){var d=a(this).data("draggable").options;d._cursor&&a("body").css("cursor",d._cursor)}}),a.ui.plugin.add("draggable","opacity",{start:function(b,c){var d=a(c.helper),e=a(this).data("draggable").options;d.css("opacity")&&(e._opacity=d.css("opacity")),d.css("opacity",e.opacity)},stop:function(b,c){var d=a(this).data("draggable").options;d._opacity&&a(c.helper).css("opacity",d._opacity)}}),a.ui.plugin.add("draggable","scroll",{start:function(b,c){var d=a(this).data("draggable");d.scrollParent[0]!=document&&d.scrollParent[0].tagName!="HTML"&&(d.overflowOffset=d.scrollParent.offset())},drag:function(b,c){var d=a(this).data("draggable"),e=d.options,f=!1;if(d.scrollParent[0]!=document&&d.scrollParent[0].tagName!="HTML"){if(!e.axis||e.axis!="x")d.overflowOffset.top+d.scrollParent[0].offsetHeight-b.pageY<e.scrollSensitivity?d.scrollParent[0].scrollTop=f=d.scrollParent[0].scrollTop+e.scrollSpeed:b.pageY-d.overflowOffset.top<e.scrollSensitivity&&(d.scrollParent[0].scrollTop=f=d.scrollParent[0].scrollTop-e.scrollSpeed);if(!e.axis||e.axis!="y")d.overflowOffset.left+d.scrollParent[0].offsetWidth-b.pageX<e.scrollSensitivity?d.scrollParent[0].scrollLeft=f=d.scrollParent[0].scrollLeft+e.scrollSpeed:b.pageX-d.overflowOffset.left<e.scrollSensitivity&&(d.scrollParent[0].scrollLeft=f=d.scrollParent[0].scrollLeft-e.scrollSpeed)}else{if(!e.axis||e.axis!="x")b.pageY-a(document).scrollTop()<e.scrollSensitivity?f=a(document).scrollTop(a(document).scrollTop()-e.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<e.scrollSensitivity&&(f=a(document).scrollTop(a(document).scrollTop()+e.scrollSpeed));if(!e.axis||e.axis!="y")b.pageX-a(document).scrollLeft()<e.scrollSensitivity?f=a(document).scrollLeft(a(document).scrollLeft()-e.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<e.scrollSensitivity&&(f=a(document).scrollLeft(a(document).scrollLeft()+e.scrollSpeed))}f!==!1&&a.ui.ddmanager&&!e.dropBehaviour&&a.ui.ddmanager.prepareOffsets(d,b)}}),a.ui.plugin.add("draggable","snap",{start:function(b,c){var d=a(this).data("draggable"),e=d.options;d.snapElements=[],a(e.snap.constructor!=String?e.snap.items||":data(draggable)":e.snap).each(function(){var b=a(this),c=b.offset();this!=d.element[0]&&d.snapElements.push({item:this,width:b.outerWidth(),height:b.outerHeight(),top:c.top,left:c.left})})},drag:function(b,c){var d=a(this).data("draggable"),e=d.options,f=e.snapTolerance,g=c.offset.left,h=g+d.helperProportions.width,i=c.offset.top,j=i+d.helperProportions.height;for(var k=d.snapElements.length-1;k>=0;k--){var l=d.snapElements[k].left,m=l+d.snapElements[k].width,n=d.snapElements[k].top,o=n+d.snapElements[k].height;if(!(l-f<g&&g<m+f&&n-f<i&&i<o+f||l-f<g&&g<m+f&&n-f<j&&j<o+f||l-f<h&&h<m+f&&n-f<i&&i<o+f||l-f<h&&h<m+f&&n-f<j&&j<o+f)){d.snapElements[k].snapping&&d.options.snap.release&&d.options.snap.release.call(d.element,b,a.extend(d._uiHash(),{snapItem:d.snapElements[k].item})),d.snapElements[k].snapping=!1;continue}if(e.snapMode!="inner"){var p=Math.abs(n-j)<=f,q=Math.abs(o-i)<=f,r=Math.abs(l-h)<=f,s=Math.abs(m-g)<=f;p&&(c.position.top=d._convertPositionTo("relative",{top:n-d.helperProportions.height,left:0}).top-d.margins.top),q&&(c.position.top=d._convertPositionTo("relative",{top:o,left:0}).top-d.margins.top),r&&(c.position.left=d._convertPositionTo("relative",{top:0,left:l-d.helperProportions.width}).left-d.margins.left),s&&(c.position.left=d._convertPositionTo("relative",{top:0,left:m}).left-d.margins.left)}var t=p||q||r||s;if(e.snapMode!="outer"){var p=Math.abs(n-i)<=f,q=Math.abs(o-j)<=f,r=Math.abs(l-g)<=f,s=Math.abs(m-h)<=f;p&&(c.position.top=d._convertPositionTo("relative",{top:n,left:0}).top-d.margins.top),q&&(c.position.top=d._convertPositionTo("relative",{top:o-d.helperProportions.height,left:0}).top-d.margins.top),r&&(c.position.left=d._convertPositionTo("relative",{top:0,left:l}).left-d.margins.left),s&&(c.position.left=d._convertPositionTo("relative",{top:0,left:m-d.helperProportions.width}).left-d.margins.left)}!d.snapElements[k].snapping&&(p||q||r||s||t)&&d.options.snap.snap&&d.options.snap.snap.call(d.element,b,a.extend(d._uiHash(),{snapItem:d.snapElements[k].item})),d.snapElements[k].snapping=p||q||r||s||t}}}),a.ui.plugin.add("draggable","stack",{start:function(b,c){var d=a(this).data("draggable").options,e=a.makeArray(a(d.stack)).sort(function(b,c){return(parseInt(a(b).css("zIndex"),10)||0)-(parseInt(a(c).css("zIndex"),10)||0)});if(!!e.length){var f=parseInt(e[0].style.zIndex)||0;a(e).each(function(a){this.style.zIndex=f+a}),this[0].style.zIndex=f+e.length}}}),a.ui.plugin.add("draggable","zIndex",{start:function(b,c){var d=a(c.helper),e=a(this).data("draggable").options;d.css("zIndex")&&(e._zIndex=d.css("zIndex")),d.css("zIndex",e.zIndex)},stop:function(b,c){var d=a(this).data("draggable").options;d._zIndex&&a(c.helper).css("zIndex",d._zIndex)}})})(jqcc);(function($){jqcc.fn.extend({slimScroll:function(options){var defaults={wheelStep:20,width:'auto',height:'auto',size:'7px',color:'#000',position:'right',distance:'1px',start:'top',opacity:.4,alwaysVisible:false,railVisible:false,railColor:'#333',railOpacity:'0.2',railClass:'slimScrollRail',barClass:'slimScrollBar',wrapperClass:'slimScrollDiv',allowPageScroll:false,scroll:0,resize:0,railAlwaysVisible:false,callback:function(){}};var o=ops=$.extend(defaults,options);this.each(function(){var isOverPanel,isOverBar,isDragg,queueHide,barHeight,percentScroll,divS='<div></div>',minBarHeight=30,releaseScroll=false,wheelStep=parseInt(o.wheelStep),cwidth=o.width,cheight=o.height,size=o.size,color=o.color,position=o.position,distance=o.distance,start=o.start,opacity=o.opacity,alwaysVisible=o.alwaysVisible,railVisible=o.railVisible,railColor=o.railColor,railOpacity=o.railOpacity,allowPageScroll=o.allowPageScroll,scroll=o.scroll;resize=o.resize;railAlwaysVisible=o.railAlwaysVisible;callback=o.callback;var me=$(this);if(me.parent().hasClass('slimScrollDiv')){if(scroll){bar=me.parent().find('.slimScrollBar');rail=me.parent().find('.slimScrollRail');getBarHeight();loc=me.outerHeight()-bar.outerHeight();bar.css({top:loc});scrollContent(0,true);}
if(resize){bar=me.parent().find('.slimScrollBar');rail=me.parent().find('.slimScrollRail');getBarHeight();}
return;}
var wrapper=$(divS).addClass(o.wrapperClass).css({position:'relative',overflow:'hidden',width:cwidth,height:cheight});var cw=me;while(parseInt(cw.css('width'))<=0){cw=cw.parent();}
me.css({overflow:'hidden'});var rail=$(divS).addClass(o.railClass).css({width:size,height:'100%',position:'absolute',top:0,display:((alwaysVisible&&railVisible)||railAlwaysVisible)?'block':'none','border-radius':size,background:railColor,opacity:railOpacity,zIndex:90});var bar=$(divS).addClass(o.barClass).css({background:color,width:size,position:'absolute',top:0,opacity:opacity,display:alwaysVisible?'block':'none','border-radius':size,BorderRadius:size,MozBorderRadius:size,WebkitBorderRadius:size,zIndex:99});var posCss=(position=='right')?{right:distance}:{left:distance};rail.css(posCss);bar.css(posCss);me.wrap(wrapper);me.parent().append(bar);me.parent().append(rail);bar.draggable({axis:'y',containment:'parent',start:function(){isDragg=true;},stop:function(){isDragg=false;hideBar();},drag:function(e)
{scrollContent(0,$(this).position().top,false);}});rail.hover(function(){showBar();},function(){hideBar();});bar.hover(function(){isOverBar=true;},function(){isOverBar=false;});me.hover(function(){isOverPanel=true;showBar();hideBar();},function(){isOverPanel=false;hideBar();});var _onWheel=function(e)
{if(!isOverPanel){return;}
var e=e||window.event;var delta=0;if(e.wheelDelta){delta=-e.wheelDelta/120;}
if(e.detail){delta=e.detail/3;}
scrollContent(delta,true);if(e.preventDefault&&!releaseScroll){e.preventDefault();}
if(!releaseScroll){e.returnValue=false;}}
function scrollContent(y,isWheel,isJump)
{var delta=y;if(isWheel)
{delta=parseInt(bar.css('top'))+y*wheelStep/100*bar.outerHeight();var maxTop=me.outerHeight()-bar.outerHeight();delta=Math.min(Math.max(delta,0),maxTop);bar.css({top:delta+'px'});}
percentScroll=parseInt(bar.css('top'))/(me.outerHeight()-bar.outerHeight());delta=percentScroll*(me[0].scrollHeight-me.outerHeight());if(isJump)
{delta=y;var offsetTop=delta/me[0].scrollHeight*me.outerHeight();bar.css({top:offsetTop+'px'});}
me.scrollTop(delta);showBar();hideBar();}
var attachWheel=function()
{if(window.addEventListener)
{this.addEventListener('DOMMouseScroll',_onWheel,false);this.addEventListener('mousewheel',_onWheel,false);}
else
{document.attachEvent("onmousewheel",_onWheel)}}
attachWheel();function getBarHeight(){barHeight=0;if(me[0].scrollHeight!=0){barHeight=Math.max((me.outerHeight()/me[0].scrollHeight)*me.outerHeight(),minBarHeight);}
bar.css({height:barHeight+'px'});}
getBarHeight();function showBar()
{getBarHeight();clearTimeout(queueHide);releaseScroll=allowPageScroll&&percentScroll==~~percentScroll;if(barHeight>=me.outerHeight()){releaseScroll=true;return;}
bar.stop(true,true).fadeIn('fast');if(railVisible||railAlwaysVisible){rail.stop(true,true).fadeIn('fast');}}
function hideBar()
{if(!alwaysVisible)
{queueHide=setTimeout(function(){if(!isOverBar&&!isDragg)
{bar.fadeOut('slow');if(!railAlwaysVisible)rail.fadeOut('slow');}},1000);}}
if(start=='bottom')
{bar.css({top:me.outerHeight()-bar.outerHeight()});scrollContent(0,true);}
else if(typeof start=='object')
{scrollContent($(start).position().top,null,true);if(!alwaysVisible){bar.hide();}}});if(typeof callback=='function'){}
return this;}});jqcc.fn.extend({slimscroll:jqcc.fn.slimScroll});})(jqcc);if(typeof(jqcc)==='undefined'){jqcc=jQuery;}
(function($){var settings={};settings=jqcc.cometchat.getcrAllVariables();var calleeAPI=jqcc.cometchat.getChatroomVars('calleeAPI');$.crglass=(function(){return{playsound:function(){try{document.getElementById('messageBeep').play();}catch(error){jqcc.cometchat.setChatroomVars('messageBeep',0);}},sendChatroomMessage:function(chatboxtextarea){$(chatboxtextarea).val('');$(chatboxtextarea).css('height','18px');var height=$[calleeAPI].crgetWindowHeight();var contentDivHeight=height-parseInt($('.topbar').css('height'));$("div.content_div").css('height',contentDivHeight);var textareaHeight=parseInt($('.cometchat_tabcontentinput').outerHeight(true));$("#currentroom_convo").css('height',contentDivHeight-textareaHeight);$("#currentroom_left").find("div.slimScrollDiv").css('height',$("#currentroom_convo").css('height'));$(chatboxtextarea).css('overflow-y','hidden');$(chatboxtextarea).focus();},createChatroom:function(){$[calleeAPI].hidetabs();$('#createtab').addClass('tab_selected');$('#create').css('display','block');$('div.welcomemessage').html('Invitation only rooms will not be displayed in the lobby');},getTimeDisplay:function(ts,id){var style="style=\"display:none;\"";if(typeof(jqcc.ccchattime)!='undefined'&&jqcc.ccchattime.getEnabled(id,1)){style="style=\"display:inline-block;\"";}
var time=getTimeDisplay(ts);if(ts<jqcc.cometchat.getChatroomVars('todays12am')){return"<span class=\"cometchat_ts\" "+style+">("+time.hour+":"+time.minute+time.ap+" "+time.date+time.type+" "+time.month+")</span>";}else{return"<span class=\"cometchat_ts\" "+style+">("+time.hour+":"+time.minute+time.ap+")</span>";}},addChatroomMessage:function(fromid,incomingmessage,incomingid,selfadded,sent,fromname){if(typeof(fromname)==='undefined'||fromname==0||fromid==settings.myid){fromname='Me';}
var temp='';var lastMessageId=incomingid;var controlparameters={"id":incomingid,"from":fromname,"fromid":fromid,"message":incomingmessage,"sent":sent};settings.timestamp=incomingid;separator=':Â Â ';var message=jqcc.cometchat.processcontrolmessage(controlparameters);if(message!=''){if($("#cometchat_message_"+incomingid).length>0){$("#cometchat_message_"+incomingid).find("span.cometchat_chatboxmessagecontent").html(message);}else{sentdata='';if(sent!=null){var ts=new Date(parseInt(sent));sentdata=$[calleeAPI].getTimeDisplay(ts,incomingid);}
if(fromid!=settings.myid){temp+=('<div class="cometchat_chatboxmessage" id="cometchat_message_'+incomingid+'"><span class="cometchat_chatboxmessagefrom"><strong>');if(settings.apiAccess&&fromid!=0){temp+=('<a href="javascript:void(0)" onclick="javascript:parent.jqcc.cometchat.chatWith(\''+fromid+'\');">');}
temp+=fromname;if(settings.apiAccess&&fromid!=0){temp+=(separator+'</a>');}
temp+=('</strong></span><span class="cometchat_chatboxmessagecontent">'+message+'</span>'+sentdata+'</div>');}else{temp+=('<div class="cometchat_chatboxmessage" id="cometchat_message_'+incomingid+'"><span class="cometchat_chatboxmessagefrom"><strong>'+fromname+separator+'</strong></span><span class="cometchat_chatboxmessagecontent">'+message+'</span>'+sentdata+'</div>');}
$("#currentroom_convotext").append(temp);if($.cookie(jqcc.cometchat.getChatroomVars('cookiePrefix')+"sound")&&$.cookie(jqcc.cometchat.getChatroomVars('cookiePrefix')+"sound")=='true'){}else{$[calleeAPI].playsound();}}}
if(jqcc.cometchat.getChatroomVars('owner')||jqcc.cometchat.getChatroomVars('isModerator')||(jqcc.cometchat.getChatroomVars('allowDelete')==1&&fromid==settings.myid)){if($("#cometchat_message_"+incomingid).find("span.delete_msg").length<1){jqcc('#cometchat_message_'+incomingid).find('span.cometchat_ts').after('<span class="delete_msg" onclick="javascript:jqcc.cometchat.confirmDelete(\''+incomingid+'\');">(<span class="hoverbraces">delete</span>)</span>');}
$(".cometchat_chatboxmessage").live("mouseover",function(){$(this).find(".delete_msg").css('visibility','visible');});$(".cometchat_chatboxmessage").live("mouseout",function(){$(this).find(".delete_msg").css('visibility','hidden');});$("span.delete_msg").mouseover(function(){$(this).css('visibility','visible');});}
var forced=(fromid==settings.myid)?1:0;if((message).indexOf('<img')!=-1&&(message).indexOf('src')!=-1){$("#cometchat_message_"+incomingid+" img").load(function(){$[calleeAPI].chatroomScrollDown(forced);});}else{$[calleeAPI].chatroomScrollDown(forced);}
var popoutmode=0;var msgcount=0;if($.cookie(settings.cookiePrefix+'crstate')!=null){var crstate_val=$.cookie(settings.cookiePrefix+'crstate').split('|')[1];msgcount=parseInt($.cookie(settings.cookiePrefix+'crstate').split('|')[0]);popoutmode=$.cookie(settings.cookiePrefix+'crstate').split('|')[2];if(typeof(crstate_val)!="undefined"&&crstate_val<lastMessageId){if($.cookie(settings.cookiePrefix+'state')!=null&&$.cookie(settings.cookiePrefix+'state').split(':')[5]!='chatrooms'&&popoutmode==0){msgcount=parseInt($.cookie(settings.cookiePrefix+'crstate').split('|')[0])+1;}
var crstate_val_new=msgcount+'|'+lastMessageId+'|'+popoutmode;$.cookie(settings.cookiePrefix+'crstate',crstate_val_new,{path:"/"});}}else{$.cookie(settings.cookiePrefix+'crstate',msgcount+'|'+lastMessageId+'|'+popoutmode,{path:"/"});}
if(settings.apiAccess==1&&typeof(parent.jqcc.cometchat.setAlert)!='undefined'&&popoutmode==0){parent.jqcc.cometchat.setAlert('chatrooms',msgcount);}},chatroomBoxKeyup:function(event,chatboxtextarea){var adjustedHeight=chatboxtextarea.clientHeight;var maxHeight=94;var height=$[calleeAPI].crgetWindowHeight();if(maxHeight>adjustedHeight){adjustedHeight=Math.max(chatboxtextarea.scrollHeight,adjustedHeight);if(maxHeight)
adjustedHeight=Math.min(maxHeight,adjustedHeight);if(adjustedHeight>chatboxtextarea.clientHeight){$(chatboxtextarea).css('height',adjustedHeight+6+'px');var contentDivHeight=height-parseInt($('.topbar').css('height'));$("div.content_div").css('height',contentDivHeight);var textareaHeight=parseInt($('.cometchat_tabcontentinput').outerHeight(true));$("#currentroom_convo").css('height',contentDivHeight-textareaHeight);$("#currentroom_left").find("div.slimScrollDiv").css('height',$("#currentroom_convo").css('height'));$[calleeAPI].chatroomScrollDown(1);}}else{$(chatboxtextarea).css('overflow-y','auto');}},hidetabs:function(){$('li').removeClass('tab_selected');$('#lobby').css('display','none');$('#currentroom').css('display','none');$('#create').css('display','none');$('#plugins').css('display','none');},loadLobby:function(){$[calleeAPI].hidetabs();$('#lobbytab').addClass('tab_selected');$('#lobby').css('display','block');$('div.welcomemessage').html('Please select a public/private chatroom you would like to join');clearTimeout(jqcc.cometchat.getChatroomVars('heartbeatTimer'));jqcc.cometchat.chatroomHeartbeat(1);},crcheckDropDown:function(dropdown){var id=dropdown.value;if(id==1){$('div.password_hide').css('display','block');}else{$('div.password_hide').css('display','none');}},loadRoom:function(){var roomname=jqcc.cometchat.getChatroomVars('currentroomname');var roomno=jqcc.cometchat.getChatroomVars('currentroom');$[calleeAPI].hidetabs();$('#plugins').css('display','block');$('#currentroom').css('display','block');$('#currentroomtab').css('display','block');$('#currentroomtab').addClass('tab_selected');$('div.welcomemessage').html('<a href="javascript:void(0);" onclick="javascript:jqcc.cometchat.leaveChatroom()">Leave room</a>'+'<span> | </span>'+'<a href="javascript:void(0);" class="inviteChatroomUsers">Invite users</a>'+'<span id="unbanuser"> | <a  href="javascript:void(0);" class="unbanChatroomUser">Unban users</a></span>');document.cookie='cc_chatroom='+urlencode(roomno+':'+jqcc.cometchat.getChatroomVars('currentp')+':'+urlencode(roomname));if($('#currentroomtab').find('a').attr('show')==0){$('#unbanuser').remove();}
var pluginshtml='';var plugins=jqcc.cometchat.getChatroomVars('plugins');var topbarWidth=jqcc('.topbar_text').css('width');if(plugins.length>0){pluginshtml+='<div class="cometchat_plugins">';for(var i=0;i<plugins.length;i++){var name='cc'+plugins[i];if(typeof($[name])=='object'){pluginshtml+='<div class="cometchat_pluginsicon cometchat_'+settings.plugins[i]+'" title="'+$[name].getTitle()+'" name="'+name+'" to="'+roomno+'" chatroommode="1" ></div>';}}
pluginshtml+='</div>';}
$('#plugins').html(pluginshtml);$('.cometchat_pluginsicon').click(function(){var name=$(this).attr('name');var to=$(this).attr('to');var chatroommode=$(this).attr('chatroommode');var roomname=jqcc.cometchat.getChatroomVars('currentroomname');var roomid=jqcc.cometchat.getChatroomVars('currentroom');if(typeof(parent)!='undefined'&&parent!=null&&parent!=self&&name!='ccsave'&&name!='ccclearconversation'&&name!='ccchattime'){var controlparameters={"type":"plugins","name":name,"method":"init","params":{"to":to,"chatroommode":chatroommode,"roomname":roomname,"roomid":roomid,"caller":"cometchat_trayicon_chatrooms_iframe"}};controlparameters=JSON.stringify(controlparameters);parent.postMessage('CC^CONTROL_'+controlparameters,'*');}else{var controlparameters={"to":to,"chatroommode":chatroommode,"roomname":roomname,"roomid":roomid};jqcc[name].init(controlparameters);}});$[calleeAPI].chatroomWindowResize();},chatroomWindowResize:function(){var height=$[calleeAPI].crgetWindowHeight();var contentDivHeight=height-parseInt($('.topbar').css('height'));$("div.content_div").css('height',contentDivHeight);var textareaHeight=parseInt($('.cometchat_tabcontentinput').outerHeight(true));$("#currentroom_convo").css('height',contentDivHeight-textareaHeight);var width=$[calleeAPI].crgetWindowWidth();$('#currentroom_left').css('width',width-144-48);$[calleeAPI].chatroomScrollDown();try{if(jqcc().slimScroll){$("#currentroom_left").find("div.slimScrollDiv").css('height',$("#currentroom_convo").css('height'));$("#currentroom_right").find("div.slimScrollDiv").css('height',$("#currentroom_right").css('height'));}}catch(e){}},kickid:function(kickid){$("#chatroom_userlist_"+kickid).remove();},banid:function(banid){$("#chatroom_userlist_"+banid).remove();},chatroomScrollDown:function(forced){try{if(settings.newMessageIndicator==1&&($('#currentroom_convotext').outerHeight(false)+$('#currentroom_convotext').offset().top-$('#currentroom_convo').height()-$('#currentroom_convo').offset().top-$('.cometchat_chatboxmessage').height()-$('.cometchat_chatboxmessage').height()>0)){if(($('#currentroom_convo').height()-$('#currentroom_convotext').outerHeight(false))<0){if(forced){if(jqcc().slimScroll){$('#currentroom_convo').slimScroll({scroll:'1'});}else{setTimeout(function(){$("#currentroom_convo").scrollTop(50000);},100);}
if($('.talkindicator').length!=0){$('.talkindicator').fadeOut();}}else{if($('.talkindicator').length){$('.talkindicator').fadeIn();}else{var indicator="<a class='talkindicator' href='#'>New</a>";$('#currentroom_convo').append(indicator);$('.talkindicator').click(function(e){e.preventDefault();if(jqcc().slimScroll){$('#currentroom_convo').slimScroll({scroll:'1'});}else{setTimeout(function(){$("#currentroom_convo").scrollTop(50000);},100);}
$('.talkindicator').fadeOut();});$('#currentroom_convo').scroll(function(){if($('#currentroom_convotext').outerHeight(false)+$('#currentroom_convotext').offset().top-$('#currentroom_convo').offset().top<=$('#currentroom_convo').height()){$('.talkindicator').fadeOut();}});}}}}else{if(jqcc().slimScroll){$('#currentroom_convo').slimScroll({scroll:'1'});}else{setTimeout(function(){$("#currentroom_convo").scrollTop(50000);},100);}}}catch(e){}},createChatroomSubmitStruct:function(){var string=$('input.create_input').val();var room={};if(($.trim(string)).length==0){return false;}
var name=document.getElementById('name').value;var type=document.getElementById('type').value;var password=document.getElementById('password').value;if(name!=''&&name!=null&&name!='Enter the name for Chatroom'){name=name.replace(/^\s+|\s+$/g,"");if(type==1&&password==''){alert('Please enter a password');return false;}
if(type==2){password='i'+(Math.round(new Date().getTime()));}
if(type==0){password='';}
room['name']=name;room['password']=password;room['type']=type;}else{alert('Please enter the room name.');return false;}
document.getElementById('name').value='';document.getElementById('password').value='';return room;},crgetWindowHeight:function(){var windowHeight=0;if(typeof(window.innerHeight)=='number'){windowHeight=window.innerHeight;}else{if(document.documentElement&&document.documentElement.clientHeight){windowHeight=document.documentElement.clientHeight;}else{if(document.body&&document.body.clientHeight){windowHeight=document.body.clientHeight;}}}
return windowHeight;},crgetWindowWidth:function(){var windowWidth=0;if(typeof(window.innerWidth)=='number'){windowWidth=window.innerWidth;}else{if(document.documentElement&&document.documentElement.clientWidth){windowWidth=document.documentElement.clientWidth;}else{if(document.body&&document.body.clientWidth){windowWidth=document.body.clientWidth;}}}
return windowWidth;},selectChatroom:function(currentroom,id){jqcc("#cometchat_userlist_"+currentroom).removeClass("cometchat_chatroomselected");jqcc("#cometchat_userlist_"+id).addClass("cometchat_chatroomselected");},checkOwnership:function(owner,isModerator,name){var loadroom='javascript:jqcc["'+calleeAPI+'"].loadRoom()';if(owner||isModerator){jqcc('#currentroomtab').html('<a href="javascript:void(0);" show=1 onclick='+loadroom+'>'+name+'</a>');}else{jqcc('#currentroomtab').html('<a href="javascript:void(0);" show=0 onclick='+loadroom+'>'+name+'</a>');}
jqcc('#currentroom_convotext').html('');jqcc("#currentroom_users").html('');},leaveRoomClass:function(currentroom){jqcc("#cometchat_userlist_"+currentroom).removeClass("cometchat_chatroomselected");},removeCurrentRoomTab:function(){jqcc('#currentroomtab').css('display','none');},chatroomLogout:function(){window.location.reload();},loadChatroomList:function(item){var temp='';var onlineNumber=0;$.each(item,function(i,room){longname=room.name;shortname=room.name;if(room.status=='available'){onlineNumber++;}
var selected='';if(jqcc.cometchat.getChatroomVars('currentroom')==room.id){selected=' cometchat_chatroomselected';}
roomtype='';roomowner='';deleteroom='';if(room.type!=0){roomtype='<img src="lock_flat.png" />';}
if(room.s==1){roomowner='<img src="user_flat.png" />';}
if((room.s==1||jqcc.cometchat.checkModerator()==1)&&room.createdby!=0){deleteroom='<img src="remove_flat.png" />';}
if(room.s==2){room.s=1;}
temp+='<div id="cometchat_userlist_'+room.id+'" class="lobby_room'+selected+'" onmouseover="jQuery(this).addClass(\'cometchat_userlist_hover\');" onmouseout="jQuery(this).removeClass(\'cometchat_userlist_hover\');" onclick="javascript:jqcc.cometchat.chatroom(\''+room.id+'\',\''+urlencode(shortname)+'\',\''+room.type+'\',\''+room.i+'\',\''+room.s+'\');" ><span class="lobby_room_1">'+longname+'</span><span class="lobby_room_2">'+room.online+' online</span><span class="lobby_room_3">'+roomtype+'</span><span class="lobby_room_4" title="Delete this room" onclick="javascript:jqcc.cometchat.deleteChatroom(event,\''+room.id+'\');">'+deleteroom+'</span><span class="lobby_room_5">'+roomowner+'</span><div style="clear:both"></div></div>';});if(temp!=''){jqcc('#lobby_rooms').html(temp);}else{jqcc('#lobby_rooms').html('<div class="lobby_noroom">No rooms available currently</div>');}},displayChatroomMessage:function(item,fetchedUsers){var beepNewMessages=0;var lastMessageId=0;var newMessages=0;if($.cookie(settings.cookiePrefix+'crstate')!=null){var crstate_val=parseInt($.cookie(settings.cookiePrefix+'crstate').split('|')[1]);}
$.each(item,function(i,incoming){if(incoming.fromid==settings.myid){incoming.from='Me';}
if(incoming.id>crstate_val&&$.cookie(settings.cookiePrefix+'state')!=null&&$.cookie(settings.cookiePrefix+'state').split(':')[5]!='chatrooms'){newMessages=newMessages+1;}
jqcc.cometchat.setChatroomVars('timestamp',incoming.id);lastMessageId=incoming.id;var message=jqcc.cometchat.processcontrolmessage(incoming);if(message!=''){var temp='';var fromname=incoming.from;if($("#cometchat_message_"+incoming.id).length>0){$("#cometchat_message_"+incoming.id).find("span.cometchat_chatboxmessagecontent").html(message);}else{var ts=new Date(parseInt(incoming.sent)*1000);if(incoming.fromid!=settings.myid){var chatroomUnread=$.cookie(settings.cookiePrefix+'crstate');temp+=('<div class="cometchat_chatboxmessage" id="cometchat_message_'+incoming.id+'"><span class="cometchat_chatboxmessagefrom"><strong>');if(settings.apiAccess&&incoming.fromid!=0){temp+=('<a href="javascript:void(0)" onclick="javascript:parent.jqcc.cometchat.chatWith(\''+incoming.fromid+'\');">');}
temp+=fromname;if(settings.apiAccess&&incoming.fromid!=0){temp+=(':</a>');}
temp+=('&nbsp;&nbsp;</strong></span><span class="cometchat_chatboxmessagecontent">'+message+'</span>'+$[calleeAPI].getTimeDisplay(ts,incoming.from)+'</div>');var msgcount=0;if($.cookie(settings.cookiePrefix+'crstate')!=='undefined'&&$.cookie(settings.cookiePrefix+'crstate')!=null){msgcount=parseInt($.cookie(settings.cookiePrefix+'crstate').split('|')[0]);}
jqcc.cometchat.setChatroomVars('newMessages',msgcount);beepNewMessages++;}else{temp+=('<div class="cometchat_chatboxmessage" id="cometchat_message_'+incoming.id+'"><span class="cometchat_chatboxmessagefrom"><strong>'+fromname+':&nbsp;&nbsp;</strong></span><span class="cometchat_chatboxmessagecontent">'+message+'</span>'+$[calleeAPI].getTimeDisplay(ts,incoming.from)+'</div>');}}
$('#currentroom_convotext').append(temp);if(jqcc.cometchat.getChatroomVars('owner')||jqcc.cometchat.getChatroomVars('isModerator')||(incoming.fromid==settings.myid&&jqcc.cometchat.getChatroomVars('allowDelete')==1)){if($("#cometchat_message_"+incoming.id+" .delete_msg").length<1){jqcc('#cometchat_message_'+incoming.id+' .cometchat_ts').after('<span class="delete_msg" onclick="javascript:jqcc.cometchat.confirmDelete(\''+incoming.id+'\');">(<span class="hoverbraces">delete</span>)</span>');}
$(".cometchat_chatboxmessage").live("mouseover",function(){$(this).find(".delete_msg").css('visibility','visible');});$(".cometchat_chatboxmessage").live("mouseout",function(){$(this).find(".delete_msg").css('visibility','hidden');});$(".delete_msg").mouseover(function(){$(this).css('visibility','visible');$(this).find(".hoverbraces").css('text-decoration','underline');});$(".delete_msg").mouseout(function(){$(this).find("span.hoverbraces").css('text-decoration','none');});}
var forced=(incoming.fromid==settings.myid)?1:0;if((message).indexOf('<img')!=-1&&(message).indexOf('src')!=-1){$("#cometchat_message_"+incoming.id+" img").load(function(){$[calleeAPI].chatroomScrollDown(forced);});}else{$[calleeAPI].chatroomScrollDown(forced);}}});jqcc.cometchat.setChatroomVars('heartbeatCount',1);jqcc.cometchat.setChatroomVars('heartbeatTime',settings.minHeartbeat);var popoutmode=0;var msgcount=0;if($.cookie(settings.cookiePrefix+'crstate')!=null){msgcount=parseInt($.cookie(settings.cookiePrefix+'crstate').split('|')[0]);popoutmode=$.cookie(settings.cookiePrefix+'crstate').split('|')[2];if(crstate_val<lastMessageId){if($.cookie(settings.cookiePrefix+'state')!=null&&$.cookie(settings.cookiePrefix+'state').split(':')[5]!='chatrooms'&&popoutmode==0){msgcount=parseInt($.cookie(settings.cookiePrefix+'crstate').split('|')[0])+newMessages;}
var crstate_val_new=msgcount+'|'+lastMessageId+'|'+popoutmode;$.cookie(settings.cookiePrefix+'crstate',crstate_val_new,{path:"/"});}}else{$.cookie(settings.cookiePrefix+'crstate',msgcount+'|'+lastMessageId+'|'+popoutmode,{path:"/"});}
if($.cookie(settings.cookiePrefix+'crstate')!=null){popoutmode=$.cookie(settings.cookiePrefix+'crstate').split('|')[2];}
if(settings.apiAccess==1&&fetchedUsers==0&&typeof(parent.jqcc.cometchat.setAlert)!='undefined'&&popoutmode==0){if($.cookie(settings.cookiePrefix+'crstate')!=='undefined'&&$.cookie(settings.cookiePrefix+'crstate')!=null){parent.jqcc.cometchat.setAlert('chatrooms',msgcount);}}
if($.cookie(settings.cookiePrefix+"sound")&&$.cookie(settings.cookiePrefix+"sound")=='true'){}else{if(beepNewMessages>0&&fetchedUsers==0){$[calleeAPI].playsound();}}},silentRoom:function(id,name,silent){if(settings.lightboxWindows==1){loadCCPopup(settings.baseUrl+'modules/chatrooms/chatrooms.php?id='+id+'&basedata='+settings.basedata+'&name='+name+'&silent='+silent+'&action=passwordBox','passwordBox',"status=0,toolbar=0,menubar=0,directories=0,resizable=0,location=0,status=0,scrollbars=1, width=320,height=110",320,110,name);}else{var temp=prompt('Please enter the chatroom password :','');if(temp){jqcc.cometchat.checkChatroomPass(id,name,silent,temp);}else{return;}}},updateChatroomUsers:function(item,fetchedUsers){var temp='';var temp1='';var newUsers={};var newUsersName={};fetchedUsers=1;$.each(item,function(i,user){if(user.id!=jqcc.cometchat.getChatroomVars('kick_ban_id')){longname=user.n;if(settings.users[user.id]!=1&&settings.initializeRoom==0&&settings.hideEnterExit==0){var ts=new Date();$("#currentroom_convotext").append('<div class="cometchat_chatboxalert" id="cometchat_message_0">'+user.n+' has joined the chatroom'+$[calleeAPI].getTimeDisplay(ts,user.id)+'</div>');$[calleeAPI].chatroomScrollDown();}
if(parseInt(user.b)!=1){var avatar='';if(user.a!=''){avatar='<span class="cometchat_userscontentavatar"><img class="cometchat_userscontentavatarimage" src='+user.a+'></span>';}
newUsers[user.id]=1;newUsersName[user.id]=user.n;userhtml='<div class="cometchat_subsubtitleusers"><hr class="hrleft">Users<hr class="hrright"></div>';moderatorhtml='<div class="cometchat_subsubtitle"><hr class="hrleft">Moderators<hr class="hrright"></div>';if(jQuery.inArray(user.id,jqcc.cometchat.getChatroomVars('moderators'))!=-1){if(user.id==settings.myid){temp1+='<div id="chatroom_userlist_'+user.id+'" class="cometchat_userlist" style="cursor:default !important;">'+avatar+'<span class="cometchat_userscontentname">'+longname+'</span></div>';}else{temp1+='<div id="chatroom_userlist_'+user.id+'" class="cometchat_userlist loadChatroomPro" onmouseover="jqcc(this).addClass(\'cometchat_userlist_hover\');" onmouseout="jqcc(this).removeClass(\'cometchat_userlist_hover\');" userid='+user.id+' owner='+settings.owner+' username="'+user.n+'" >'+avatar+'<span class="cometchat_userscontentname">'+longname+'</span></div>';}}else{if(user.id==settings.myid){temp+='<div id="chatroom_userlist_'+user.id+'" class="cometchat_userlist" style="cursor:default !important;">'+avatar+'<span class="cometchat_userscontentname">'+longname+'</span></div>';}else{temp+='<div id="chatroom_userlist_'+user.id+'" class="cometchat_userlist loadChatroomPro" onmouseover="jqcc(this).addClass(\'cometchat_userlist_hover\');" onmouseout="jqcc(this).removeClass(\'cometchat_userlist_hover\');" userid='+user.id+' owner='+settings.owner+' username="'+user.n+'">'+avatar+'<span class="cometchat_userscontentname">'+longname+'</span></div>';}}}}});for(user in settings.users){if(settings.users.hasOwnProperty(user)){if(newUsers[user]!=1&&settings.initializeRoom==0&&settings.hideEnterExit==0){var ts=new Date();$("#currentroom_convotext").append('<div class="cometchat_chatboxalert" id="cometchat_message_0">'+settings.usersName[user]+' has left the chatroom'+$[calleeAPI].getTimeDisplay(ts,user.id)+'</div>');$[calleeAPI].chatroomScrollDown();}}}
if(temp1!=""&&temp!="")
jqcc('#currentroom_users').html(moderatorhtml+temp1+userhtml+temp);else if(temp=="")
jqcc('#currentroom_users').html(moderatorhtml+temp1);else
jqcc('#currentroom_users').html(userhtml+temp);jqcc.cometchat.setChatroomVars('users',newUsers);jqcc.cometchat.setChatroomVars('usersName',newUsersName);jqcc.cometchat.setChatroomVars('initializeRoom',0);},loadCCPopup:function(url,name,properties,width,height,title,force,allowmaximize,allowresize,allowpopout){if(jqcc.cometchat.getChatroomVars('lightboxWindows')==1){var controlparameters={"type":"modules","name":"chatrooms","method":"loadCCPopup","params":{"url":url,"name":name,"properties":properties,"width":width,"height":height,"title":title,"force":force,"allowmaximize":allowmaximize,"allowresize":allowresize,"allowpopout":allowpopout}};controlparameters=JSON.stringify(controlparameters);parent.postMessage('CC^CONTROL_'+controlparameters,'*');}else{var w=window.open(url,name,properties);w.focus();}}};})();})(jqcc);if(typeof(jqcc.glass)==="undefined"){jqcc.glass=function(){};}
jqcc.extend(jqcc.glass,jqcc.crglass);jqcc(document).ready(function(){var lang='Please select users';jqcc('.inviteChatroomUsers').live('click',function(){var baseurl=jqcc.cometchat.getBaseUrl();var basedata=jqcc.cometchat.getBaseData();var roomid=jqcc.cometchat.getChatroomVars('currentroom');var roompass=jqcc.cometchat.getChatroomVars('currentp');var roomname=urlencode(jqcc.cometchat.getChatroomVars('currentroomname'));var popoutmode=jqcc.cometchat.getChatroomVars('popoutmode');var url=baseurl+'modules/chatrooms/chatrooms.php?action=invite&roomid='+roomid+'&inviteid='+roompass+'&basedata='+basedata+'&roomname='+roomname;if(typeof(parent)!='undefined'&&parent!=null&&parent!=self){var controlparameters={"type":"modules","name":"cometchat","method":"inviteChatroomUser","params":{"url":url,"action":"invite","lang":lang}};controlparameters=JSON.stringify(controlparameters);if(typeof(parent)!='undefined'&&parent!=null&&parent!=self){parent.postMessage('CC^CONTROL_'+controlparameters,'*');}else{window.opener.postMessage('CC^CONTROL_'+controlparameters,'*');}}else{var controlparameters={};jqcc.cometchat.inviteChatroomUser();}});jqcc('.unbanChatroomUser').live('click',function(){var baseurl=jqcc.cometchat.getBaseUrl();var basedata=jqcc.cometchat.getBaseData();var roomid=jqcc.cometchat.getChatroomVars('currentroom');var roompass=jqcc.cometchat.getChatroomVars('currentp');var roomname=urlencode(jqcc.cometchat.getChatroomVars('currentroomname'));var popoutmode=jqcc.cometchat.getChatroomVars('popoutmode');var url=baseurl+'modules/chatrooms/chatrooms.php?action=unban&roomid='+roomid+'&inviteid='+roompass+'&basedata='+basedata+'&roomname='+roomname+'&time='+Math.random();if(typeof(parent)!='undefined'&&parent!=null&&parent!=self){var controlparameters={"type":"modules","name":"cometchat","method":"unbanChatroomUser","params":{"url":url,"action":"invite","lang":lang}};controlparameters=JSON.stringify(controlparameters);if(typeof(parent)!='undefined'&&parent!=null&&parent!=self){parent.postMessage('CC^CONTROL_'+controlparameters,'*');}else{window.opener.postMessage('CC^CONTROL_'+controlparameters,'*');}}else{var controlparameters={};jqcc.cometchat.unbanChatroomUser();}});jqcc('.loadChatroomPro').live('click',function(){var owner=jqcc(this).attr('owner');var uid=jqcc(this).attr('userid');username=jqcc(this).attr('username');var baseurl=jqcc.cometchat.getBaseUrl();var basedata=jqcc.cometchat.getBaseData();var roomid=jqcc.cometchat.getChatroomVars('currentroom');var roompass=jqcc.cometchat.getChatroomVars('currentp');var roomname=urlencode(jqcc.cometchat.getChatroomVars('currentroomname'));var popoutmode=jqcc.cometchat.getChatroomVars('popoutmode');var url=baseurl+'modules/chatrooms/chatrooms.php?action=loadChatroomPro&apiAccess='+jqcc.cometchat.getChatroomVars('checkBarEnabled')+'&owner='+owner+'&roomid='+roomid+'&basedata='+basedata+'&inviteid='+uid+'&roomname='+roomname;if(typeof(parent)!='undefined'&&parent!=null&&parent!=self){var controlparameters={"type":"modules","name":"cometchat","method":"unbanChatroomUser","params":{"url":url,"action":"loadChatroomPro","lang":username}};controlparameters=JSON.stringify(controlparameters);if(typeof(parent)!='undefined'&&parent!=null&&parent!=self){parent.postMessage('CC^CONTROL_'+controlparameters,'*');}else{window.opener.postMessage('CC^CONTROL_'+controlparameters,'*');}}else{var controlparameters={};jqcc.cometchat.loadChatroomPro(uid,owner,username,popoutmode);}});});